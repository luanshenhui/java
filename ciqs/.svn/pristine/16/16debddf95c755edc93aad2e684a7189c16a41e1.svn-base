package com.dpn.ciqqlc.service;

import java.util.ArrayList;
import java.util.List;

import org.apache.ibatis.session.SqlSession;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Repository;
import org.springframework.transaction.annotation.Transactional;

import com.dpn.ciqqlc.service.dto.WarningDto;
import com.dpn.ciqqlc.standard.model.WarningStandardEventDto;
import com.dpn.ciqqlc.standard.service.WarningEventService;

@Repository("warningEventService")
@Transactional
public class WarningEventServiceImpl implements WarningEventService{
	
	@Autowired
	@Qualifier("blankSST")
	private SqlSession sqlSession;
	
	@Override
	public String updateEvent(WarningDto dto) {
		//生成批次号,根据日期
		try {
			sqlSession.insert("insertEvents", dto.getEventDtoList());
			
			List<WarningStandardEventDto> dtos = new ArrayList<WarningStandardEventDto>();
			
			//写入规范执法记录(记录未规范执法内容)
			if (dtos != null && dtos.size() != 0) {
				insertStandardEvents(dtos);
			}
			return "success";
		} catch (Exception e) {
			e.printStackTrace();
			return "fail";
		}
	}
	
	@Override
	public String insertStandardEvents(List<WarningStandardEventDto> dtos) {
		//生成批次号,根据日期
		sqlSession.insert("insertEvents", dtos);
		
		
		return null;
	}
}

// 店铺Datatable
var dictTable;
// 正在操作的“店铺ID”
var dictionaryID;

var dictionaryName;
var dictionaryCode;
var dictionaryRemark;
var dictionaryVale;
var dictionaryTypeValue;
var dictionaryType ="";
/**
 * 页面初始化
 */
jQuery(document).ready(function(){
    dictTable = $('#dictTable').DataTable({
        "processing": true,
        "serverSide": true,
        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
        "dom": '<"bottom"rtflp>',
        "searching": false,
        "pagingType": "full_numbers",
        "deferRender": true,
        "drawCallback": function(settings) {
            var api = this.api();
            var rows = api.rows({
                page: 'current'
            }).nodes();
            var last = null;
 
            api.column(5, {
                page: 'current'
            }).data().each(function(group, i) {
                if (last !== group) {
                    $(rows).eq(i).before('<tr class="group"><td colspan="5">' + group + '</td></tr>');
 
                    last = group;
                }
            });
           
         
        },
        "ajax": {
            "url": "/dictionary/dictList.action",
            "data": function ( d ) {
                     d.quickSearch = encodeURI($('#quickSearch').val());
                }
        },
        "tableTools": {
            "sRowSelect": "bootstrap"
        },
        "columns": [{
                "data": "dictId"
            }, {
                "data": "dictName"
            }, {
                "data": "dictCode"
            }, {
                "data": "dictValue"
            }, {
                "data": "operation"
            },{
                "data": "dictType"
            }
        ],
        "columnDefs": [{
                "orderable":false,
                "targets":[0]
            },{
                "orderable":false,
                "targets":[3]
            },{
                "orderable":false,
                "targets":[4]
            },{
                "orderable":false,
                "visible": false,
                "targets":[5]
            }
        ],
        "order": [[ 1, "desc" ],[ 2, "desc" ]]
    });
    var currentOrder = dictTable.order()[0];
    if (currentOrder[0] === 5 && currentOrder[1] === 'asc') {
        dictTable.order([5, 'desc']).draw();
    } else {
        dictTable.order([5, 'asc']).draw();
    }

    // 根据组排序
    $('#dictTable tbody').on('click', 'tr.group',
    function() {
        var currentOrder = dictTable.order()[0];
        if (currentOrder[0] === 5 && currentOrder[1] === 'asc') {
            dictTable.order([5, 'desc']).draw();
        } else {
            dictTable.order([5, 'asc']).draw();
        }
    });
//    
    $.ajax({
        type:"GET",
        url:"/dictionary/getDictTypeList.action",
        contentType: "application/json;charset=utf-8",
        dataType: "json",
        async: true,//同步
        success:function(data) {
            if (data.result == "success") {
                $("#txtDictType option").remove();
                if(null == dictionaryType){
                    dictionaryType="";
                }
                $("#txtDictType").append("<option value=''>" + dictionaryType + "</option>");
                $.each(data.data, function (n, value) {
                    $("#txtDictType").append("<option value='" + value.dictType + "'>" + value.dictType + "</option>");
                });
            } else {
                window.top.window.showModalAlert(data.msg);
            }
        },
        error:function(XMLHttpRequest, textStatus) {
            if (XMLHttpRequest.status == 500) {
                var result = eval("(" + XMLHttpRequest.responseText + ")");
                alert(result.errorObject.errorText);
            }
        }
    });
});

function getType(){
    $.ajax({
        type:"GET",
        url:"/dictionary/getDictTypeList.action",
        contentType: "application/json;charset=utf-8",
        dataType: "json",
        async: false,//同步
        success:function(data) {
            if (data.result == "success") {
                $("#txtDictType option").remove();
                if(null == dictionaryType){
                    dictionaryType="";
                }
                $("#txtDictType").append("<option value=''>" + dictionaryType + "</option>");
                $.each(data.data, function (n, value) {
                    $("#txtDictType").append("<option value='" + value.dictType + "'>" + value.dictType + "</option>");
                });
            } else {
                window.top.window.showModalAlert(data.msg);
            }
        },
        error:function(XMLHttpRequest, textStatus) {
            if (XMLHttpRequest.status == 500) {
                var result = eval("(" + XMLHttpRequest.responseText + ")");
                alert(result.errorObject.errorText);
            }
        }
    });
}


// 快速搜索，点击时提交表格刷新内容
$("#btnQuickSearch").click(function () {
    dictTable.draw();
});


//添加
function addDict(){
    $("#radioType").show();
    $("#textPage").show();
    $("#htmlPage1").hide();
    $("#htmlPage2").hide();
    $("#datePage").hide();
    $("#createTitle").html("新建参数");
    getType();
    var editDialog = window.top.window.borrowCustomModalDialog($("#creatDict"));
    editDialog.modal({show:true, backdrop:'static'});
} 


$('#creatDict').on('hide.bs.modal', function () {
    // 父窗体归还本页的编辑对话框
    window.top.window.returnCustomModalDialog();
    ClearInput();
    $("#txtDictName").val("");
    $("#txtDictCode").val("");
    $("#txtDictRemark").val("");
    $("#dictId").val("");
    $("#txt_DictType").val("");
    $("#textValue").val("");
    $("#htmlValue").val("");
    $("#dateValue").val("");
    
});

function ClearInput() {  
    //清空输入域  
   var validator = $("#dictDetailForm").validate({  
        submitHandler: function (form) {  
            form.submit();  
        }  
    });  
    validator.resetForm();  
    $('#dictDetailForm .state-error').removeClass('state-error');
    $('#dictDetailForm .state-success').removeClass('state-success');
} 
$('#divExpireTime').datetimepicker();


$('#dictSave').click(function(){
    // 输入有效性验证
//    $("dictDetailForm").validate({
//        debug:true,
//        errorPlacement: function(error, element)
//        {
//            error.insertAfter(element);
//        }
//    });
    insertDict();
    dictTable.draw();
});
function insertDict() {
    
    window.top.window.returnCustomModalDialog();
    var txtDictName = $("#txtDictName").val();
    var txtDictCode = $("#txtDictCode").val();
    var txtDictRemark = $("#txtDictRemark").val();
    var txtDictType =$("#txt_DictType").val();
    var radio = document.getElementsByName("dict_value_type");
    for(var i=0; i<radio.length;i++){
        if(radio[i].checked){
            var txtDict_value_type =radio[i].value;
        }
    }
   
    
    var dictID =$("#dictId").val();
    var textValue = $("#textValue").val();
    if(!$("#dictDetailForm").valid()) {
        // 父窗体借用本页的编辑对话框
        window.top.window.borrowCustomModalDialog($("#creatDict"));
        return false;
    }
    if($("#dictId").val()!= null&&$("#dictId").val()!=''){
        
        if(dictionaryTypeValue == 0){
            var canshuValue = $("#textValue").val()
        }else if(dictionaryTypeValue == 1){
            var canshuValue = $("#dateValue").val()
        }else if(dictionaryTypeValue == 2){
            var canshuValue = $("#htmlValue").val()
        }
        
        var data = {
                "dictId": dictID,
                "dictName": txtDictName,
                "dictCode": txtDictCode,
                "remark": txtDictRemark,
                "dictValueType": dictionaryTypeValue,
                "dictValue":canshuValue,
                "dictType":txtDictType,
            };
        $.ajax({
            type:"POST",
            url:"/dictionary/updateDict.action",
            data:JSON.stringify(data),
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false, // 同步
            success:function(data) {
                if (data.result == "success") {
                 $('#creatDict').modal('hide');
                 window.top.window.showScoMessage('ok', '添加成功');
                } else{
                 window.top.window.showModalAlert(data.msg);
                }
            },
            error:function(XMLHttpRequest, textStatus) {
                if (XMLHttpRequest.status == 500) {
                    var result = eval("(" + XMLHttpRequest.responseText + ")");
                    window.top.window.showModalAlert(result.errorObject.errorText);
                }
            }
        });
    }else{
        var data = {
                "dictName": txtDictName,
                "dictCode": txtDictCode,
                "remark": txtDictRemark,
                "dictValueType": txtDict_value_type,
                "dictValue":textValue,
                "dictType":txtDictType,
            };
        $.ajax({
            type:"POST",
            url:"/dictionary/addDict.action",
            data:JSON.stringify(data),
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            async: false, // 同步
            success:function(data) {
                if (data.result == "success") {
                 $('#creatDict').modal('hide');
                 window.top.window.showScoMessage('ok', '添加成功');
                } else{
                 window.top.window.showModalAlert(data.msg);
                }
            },
            error:function(XMLHttpRequest, textStatus) {
                if (XMLHttpRequest.status == 500) {
                    var result = eval("(" + XMLHttpRequest.responseText + ")");
                    window.top.window.showModalAlert(result.errorObject.errorText);
                }
            }
        });
    }
    
    
}

$('#dict_value_type0').click(function(){
    window.top.window.returnCustomModalDialog();
    $("#textPage").show();
    $("#htmlPage1").hide();
    $("#htmlPage2").hide();
    $("#datePage").hide();
    var editDialog = window.top.window.borrowCustomModalDialog($("#creatDict"));
    editDialog.modal({show:true, backdrop:'static'});
});
$('#dict_value_type2').click(function(){
    window.top.window.returnCustomModalDialog();
    $("#textPage").hide();
    $("#htmlPage1").show();
    $("#htmlPage2").show();
    $("#datePage").hide();
    var editDialog = window.top.window.borrowCustomModalDialog($("#creatDict"));
    editDialog.modal({show:true, backdrop:'static'});
});
$('#dict_value_type1').click(function(){
    window.top.window.returnCustomModalDialog();
    $("#textPage").hide();
    $("#htmlPage1").hide();
    $("#htmlPage2").hide();
    $("#datePage").show();
    var editDialog = window.top.window.borrowCustomModalDialog($("#creatDict"));
    editDialog.modal({show:true, backdrop:'static'});
    
});


function operationEdit(btnEdit,typeValue,dictValue,name,code,miaoshu,type) {
    $("#dictDetailForm")[0].reset();
    dictionaryID = $(btnEdit).attr("dictionaryID");
    dictionaryName = name;
    dictionaryCode = code;
    dictionaryRemark = miaoshu;
    dictionaryVale = dictValue;
    dictionaryTypeValue = typeValue ;
    dictionaryType = type;
    $("#dictId").val(btnEdit);
    debugger
    $("#createTitle").html("修改参数");
    $("#radioType").hide();
    $("#txtDictName").val(dictionaryName);
    $("#txtDictCode").val(dictionaryCode);
    $("#txt_DictType").val(dictionaryType);
    $("#txtDictRemark").val(dictionaryRemark);
    if(dictionaryTypeValue == 0){
        $("#textPage").show();
        $("#htmlPage1").hide();
        $("#htmlPage2").hide();
        $("#datePage").hide();
        
        $("#textValue").val(dictionaryVale);
        
    }else if(dictionaryTypeValue == 1){
        $("#datePage").show();
        $("#htmlPage1").hide();
        $("#htmlPage2").hide();
        $("#textPage").hide();
        
        $("#dateValue").val(dictionaryVale);
        
    }else if(dictionaryTypeValue == 2){
       
        $("#htmlPage1").show();
        $("#htmlPage2").show();
        $("#textPage").hide();
        $("#datePage").hide();
        
        $("#htmlValue").val(dictionaryVale);
    }
    getType();
    var editDialog = window.top.window.borrowCustomModalDialog($("#creatDict"));
    editDialog.modal({show:true, backdrop:'static'});
}





/**
 * 删除提示
 * @param btnDelete
 * @returns
 */
function operationDelete(btnDelete){
    dictionaryID = $(btnDelete).attr("dictionaryID");
    window.top.window.showModalConfirm("确定要删除该参数吗？", doDelete);
}

/**
 * 执行删除店铺操作
 * @returns
 */
function doDelete() {
    if (dictionaryID == "") {
        return;
    }
    $.ajax({
        type:"POST",
        url:"/dictionary/deleteDict.action",
        dataType: "json",
        async: false,//同步
        data : {
            dictId : dictionaryID
        },
        success:function(data) {
            if (data.result == "success") {
                window.top.window.showScoMessage('ok', '删除成功');
            } else{
                window.top.window.showModalAlert(data.msg);
            }
        },
        error:function(XMLHttpRequest, textStatus) {
            if (XMLHttpRequest.status == 500) {
                var result = eval("(" + XMLHttpRequest.responseText + ")");
                window.top.window.showModalAlert(result.errorObject.errorText);
            }
        }
    });
    dictionaryID = "";
    dictTable.draw();
}




















//$(function () {
//	debugger
//	// 初始化表格控件
//	dictTable = $('#dictTable').DataTable({
//    	"processing": true,
//        "serverSide": true,
//        "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
//        "dom": '<"bottom"rtflp>',
//        "searching": false,
//        "pagingType": "full_numbers",
//        "deferRender": true,
//        "ajax": {
//            "url": "/dictionary/dictList.action",
//            "data": function ( d ) {
//                d.quickSearch = encodeURI($('#quickSearch').val());
//            }
//        },
//        "tableTools": {
//            "sRowSelect": "bootstrap"
//        },
//        "columns": [{
//                "data": "dict_id"
//            }, {
//                "data": "dict_name"
//            }, {
//                "data": "dict_code"
//            }, {
//                "data": "value"
//            }
//        ],
//        "columnDefs": [{
//	        	"orderable":false,
//	        	"targets":[0]
//        	}
//        ],
//        "order": [[ 1, "desc" ]]
//    });
//    

//    
//    // 店铺修改，保存按钮点击事件绑定
//    $("#btnShopDetailSave").click(function(){
//    	updateShop();
//    });
//    
//	// 编辑对话框关闭事件发生
//    $('#modalEdit').on('hide.bs.modal', function () {
//    	// 父窗体归还本页的编辑对话框
//    	window.top.window.returnCustomModalDialog();
//    })
//    
//    // 搜索框的回车事件
//    $('#quickSearch').keydown(function(e){
//		if(e.keyCode==13){
//			$("#btnQuickSearch").click();
//		}
//	});
//    
//    // 日期型控件
//    $('#divExpireTime').datetimepicker();
//    
//    /************ 创建店铺向导窗口 ***********/
//    $('#rootwizard-custom-circle').bootstrapWizard({
//        onTabShow: function(tab, navigation, index) {
//        	if (index == 3) {
//        		$("#btnShopWizardOK").removeClass("hidden");
//        		//$(".button-previous").removeClass("hidden");
//        		$(".button-next").addClass("hidden");
//        	} else {
//        		$("#btnShopWizardOK").addClass("hidden");
//        		//$(".button-previous").removeClass("hidden");
//        		$(".button-next").removeClass("hidden");
//        	}
//            var $total = navigation.find('li').length;
//            var $current = index+1;
//            var $percent = ($current/$total) * 100;
//            $('#rootwizard-custom-circle').find('.bar').css({width:$percent+'%'});
//        },
//        'onNext': function(tab, navigation, index) {
//            // 输入有效性验证
//        	if(!$("#formShopTypeSelect").valid()) {
//        		 return false;
//        	}
//        	if(!$("#validateForm").valid()) {
//        		$('#rootwizard-custom-circle').bootstrapWizard('show',1);
//        		return false;
//        	}
//        	
//        	// 检测店铺名称+店铺类型是否唯一
//    		if (!isShopUnique(index)) {
//            	window.top.window.showModalAlert("店铺名称 + 店铺类型 + 项目名称不唯一");
//        		return false;
//    		}
//        },
//        'onTabClick': function(tab, navigation, index) {
//            // 输入有效性验证
//        	if(!$("#formShopTypeSelect").valid()) {
//	       		return false;
//	       	}
//	       	if(!$("#validateForm").valid()) {
//	       		$('#rootwizard-custom-circle').bootstrapWizard('show',1);
//	       		return false;
//	       	}
//	       	
//        	// 检测店铺名称+店铺类型是否唯一
////    		if (!isShopUnique(index)) {
////            	window.top.window.showModalAlert("店铺名称 + 店铺类型不唯一");
////        		return false;
////    		}
//            // Add class visited to style css
//            if (tab.attr("class")=="visited"){
//                tab.removeClass("visited");
//            } else {
//                tab.addClass("visited");
//            }
//        },
//        'tabClass': 'bwizard-steps-o','nextSelector': '.button-next', 'previousSelector': '.button-previous'
//    });
//    
//    // 初始化项目列表
//    $.ajax({
//        type:"GET",
//        url:"/projectManager/getAllAvailableProjects.action",
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: true,//同步
//        success:function(data) {
//            if (data.result == "success") {
//            	$("#prjId option").remove();
//            	$("#prjId1 option").remove();
//            	$("#prjId").append("<option value=''>请选择</option>");
//            	$("#prjId1").append("<option value=''>请选择</option>");
//                $.each(data.data, function (n, value) {
//                    $("#prjId").append("<option value='" + value.prjId + "'>" + value.prjName + "</option>");
//                    $("#prjId1").append("<option value='" + value.prjId + "'>" + value.prjName + "</option>");
//                });
//            } else {
//            	window.top.window.showModalAlert(data.msg);
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//    
//    // 加载父店铺列表
//    loadParentShops();
//
//    // 店铺创建向导页面，需要分单，就禁止选择父店铺
//    $("#needSplitOrder").change(function(){
//    	if ($("#needSplitOrder").val() == 'y') {
//    		$("#parentShop").attr({"disabled":"disabled"});
//    		$("#parentShop").val("");
//    	} else {
//    		$("#parentShop").removeAttr("disabled");
//    	}
//    })
//    
//    // 店铺编辑页面，需要分单，就禁止选择父店铺
//    $("#needSplitOrder1").change(function(){
//    	if ($(this).val() == 'y') {
//    		$(this).parent().parent().parent().find("#parentShop1").attr({"disabled":"disabled"});
//    		$(this).parent().parent().parent().find("#parentShop1").val("");
//    	} else {
//    		$(this).parent().parent().parent().find("#parentShop1").removeAttr("disabled");
//    	}
//    })
//});

///**
// * 加载父店铺下拉列表
// * @returns
// */
//function loadParentShops() {
//    $.ajax({
//        type:"GET",
//        url:"/shop/parentShopList.action",
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: true,//同步
//        success:function(data) {
//            if (data.result == "success") {
//            	// 画父店铺select.option
//            	$("#parentShop option").remove();
//            	$("#parentShop1 option").remove();
//            	$("#parentShop").append("<option value=''>请选择</option>");
//            	$("#parentShop1").append("<option value=''>请选择</option>");
//                $.each(data.data, function (n, value) {
//                    $("#parentShop").append("<option value='" + value.shopId + "'>" + value.shopName + "</option>");
//                    $("#parentShop1").append("<option value='" + value.shopId + "'>" + value.shopName + "</option>");
//                });
//            } else {
//            	// window.top.window.showModalAlert(data.msg);
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//}

///**
// * 检测店铺名称+店铺类型唯一性
// * @param index
// * @returns true唯一，false不唯一
// */
//function isShopUnique(index){
//	var returnResult = false;
//	if (index != 2) {
//		return true;
//	}
//	var shopName = encodeURI(encodeURI($('#shopName').val()));
//	var shopType = encodeURI(encodeURI($('#shopType').val()));
//	var prjId = encodeURI(encodeURI($('#prjId').val()));
//    $.ajax({
//        type:"GET",
//        url:"/shop/isShopUnique.action?shopName=" + shopName + "&shopType=" + shopType + "&prjId="+prjId,
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: false,//同步
//        success:function(data) {
//            if (data) {
//            	returnResult = true;
//            } else {
//            	returnResult = false;
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//            	window.top.window.showModalAlert(result.errorObject.errorText);
//            }
//            returnResult = false;
//        }
//    });
//    return returnResult;
//}

///**
// * 弹出创建店铺向导
// * @returns
// */
//function newShopWizard() {
//	$('#rootwizard-custom-circle').bootstrapWizard('show',0);
//	$("#prjId").val("");
//	$("#shopType").val("");
//	$("#shopName").val("");
//	$("#shopAccount").val("");
//	$("#shopPassword").val("");
//	$("#formSettings")[0].reset();
//	
//}



























// 确认操作提示
//var strOperation = "";
///**
// * 启用、停用操作点击
// * @param btnEnable
// * @returns
// */
//function operationEnable(btnEnable) {
//	opShopId = $(btnEnable).attr("shopid");
//	var content = "";
//	if ($(btnEnable).text().indexOf("启用") > 0) {
//		content = "是否确认启用该店铺？";
//		strOperation = "setEnable";
//	} else {
//		content = "停用店铺将停止该店铺所有系统作业，是否确认停用？";
//		strOperation = "setDisable";
//	}
//	window.top.window.showModalConfirm(content, doEnable);
//}

///**
// * 具体执行启用、停用操作
// * @returns
// */
//function doEnable() {
//	if (opShopId == "") {
//		return;
//	}
//	
//    $.ajax({
//        type:"POST",
//        url:"/shop/" + strOperation + ".action?shopId=" + opShopId,
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: false,//同步
//        success:function(data) {
//            if (data.result == "success") {
//            	window.top.window.showScoMessage('ok', '成功');
//            } else{
//            	window.top.window.showModalAlert(data.msg);
//            }
//            shopTable.draw();
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//}

/**
 * 编辑按钮点击
 * @param btnEdit
 * @returns
 */
//function operationEdit(btnEdit) {
//	$("#dictDetailForm")[0].reset();
//	dictionaryID = $(btnEdit).attr("dictionaryID");
//
//    // 初始化项目列表
//    $.ajax({
//        type:"POST",
//        url:"/dictionary/updateDict.action",
//        dataType: "json",
//        async: false,//同步
//        data : {
//            dictId : dictionaryID
//        },
//        success:function(data) {
//            if (data.result == "success") {
//            	$("#modalEdit").attr("shopid", opShopId);
//            	if (data.data.prjId != "") {
//            		$("#prjId1").append("<option value='" + data.data.prjId + "'>" + data.data.prjName + "</option>");
//                	$("#prjId1").val(data.data.prjId);
//            	}
//            	$("#shopName1").val(data.data.shopName);
//            	$("#shopType1").val(data.data.shopType);
//            	$("#needSplitOrder1").val(data.data.needSplitOrder);
//            	$("#parentShop1").val(data.data.parentShop);
//            	$("#expireTime").val(data.data.expireTime);
//            	$("#remark").val(data.data.remark);
//            	
//            	// 没有验证的店铺可以修改，验证以后不能修改
//            	if(data.data.validate == 'n') {
//                	$("#prjId1").removeAttr("disabled");
//                	$("#shopName1").removeAttr("disabled");
//                	$("#shopType1").removeAttr("disabled");
//                	$("#needSplitOrder1").removeAttr("disabled");
//                	$("#parentShop1").removeAttr("disabled");
//            	} else {
//                	$("#prjId1").attr({"disabled":"disabled"});
//                	$("#shopName1").attr({"disabled":"disabled"});
//                	$("#shopType1").attr({"disabled":"disabled"});
//                	$("#needSplitOrder1").attr({"disabled":"disabled"});
//                	$("#parentShop1").attr({"disabled":"disabled"});
//            	}
//            	
//            	// 加载父店铺列表
//            	loadParentShops();
//            	
//            	// 父窗体借用本页的编辑对话框
//            	var editDialog = window.top.window.borrowCustomModalDialog($("#modalEdit"));
//            	editDialog.modal({show:true, backdrop:'static'});
//            } else{
//            	window.top.window.showScoMessage('ok', data.msg);
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//}

///**
// * 保存新店铺
// * @returns
// */
//function shopWizardFinish() {
//    var prjId = $('#prjId').val();
//    var shopName = $('#shopName').val();
//    var shopAccount = $('#shopAccount').val();
//    var shopPassword = $('#shopPassword').val();
//    var shopType = $('#shopType').val();
//    var enable = $('#enable').val();
//    var needSplitOrder = $("#needSplitOrder").val();
//    var parentShop = $("#parentShop").val();
//    var expireTime = $('#expireTime1').val();
//    
//    var data = {
//        "prjId":prjId,
//        "shopType": shopType,
//        "shopName": shopName,
//        "shopAccount": shopAccount,
//        "shopPassword": shopPassword,
//        "expireTime": expireTime,
//        "enable": enable,
//        "needSplitOrder": needSplitOrder,
//        "parentShop": parentShop
//    };
//    
//    $.ajax({
//        type:"POST",
//        url:"/shop/addShop.action",
//        data:JSON.stringify(data),
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: false,//同步
//        success:function(data) {
//            if (data.result == "success") {
//            	$('#newShopWizard').modal('hide');
//            	window.top.window.showScoMessage('ok', '创建店铺成功');
//            } else{
//            	window.top.window.showModalAlert(data.msg);
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//	shopTable.draw();
//}
//
///**
// * 保存店铺
// * @returns
// */
//function updateShop() {
//	// 父窗体归还本页的编辑对话框
//	window.top.window.returnCustomModalDialog();
//	
//	var shopId = $("#modalEdit").attr("shopid");
//	if (shopId == undefined || shopId == null || shopId == "") {
//		window.top.window.borrowCustomModalDialog($("#modalEdit"));
//		window.top.window.showModalAlert("未指定店铺");
//		return false;
//	}
//	
//    // 输入有效性验证
//	if(!$("#shopDetailForm").valid()) {
//    	// 父窗体借用本页的编辑对话框
//    	window.top.window.borrowCustomModalDialog($("#modalEdit"));
//		return false;
//	}
//	
//	var prjId = $("#prjId1").val();
//    var shopName = $("#shopName1").val();
//    var shopType = $("#shopType1").val();
//    var needSplitOrder = $("#needSplitOrder1").val();
//    var parentShop = $("#parentShop1").val();
//    var expireTime = $("#expireTime").val();
//    var remark = $("#remark").val();
//    
//    var data = {
//    	"shopId": shopId,
//    	"prjId": prjId,
//        "shopType": shopType,
//        "needSplitOrder": needSplitOrder,
//        "parentShop": parentShop,
//        "shopName": shopName,
//        "expireTime": expireTime,
//        "remark": remark
//    };
//    
//    $.ajax({
//        type:"POST",
//        url:"/shop/updateShop.action",
//        data:JSON.stringify(data),
//        contentType: "application/json;charset=utf-8",
//        dataType: "json",
//        async: false, // 同步
//        success:function(data) {
//            if (data.result == "success") {
//            	$('#modalEdit').modal('hide');
//            	window.top.window.showScoMessage('ok', '修改成功');
//            } else{
//            	window.top.window.showModalAlert(data.msg);
//            }
//        },
//        error:function(XMLHttpRequest, textStatus) {
//            if (XMLHttpRequest.status == 500) {
//                var result = eval("(" + XMLHttpRequest.responseText + ")");
//                alert(result.errorObject.errorText);
//            }
//        }
//    });
//	shopTable.draw();
//}

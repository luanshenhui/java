#mysql服务器路径(此路径需先建好，并权限改为777,临时存放生成的文件)
tempFile=/ebankfile/toods
#mysql服务器免密登录用户
mysqlSystemUser=mysqlinst1

#mysql连接信息
mysqlUser=mysqlbatch  
mysqlPassword=mysqldba123
mysqlIP=mysql-1.shop.cgbchina.com.cn
mysqlPort=3306
mysqlDB=cgbmall
#有环境变量的情况下mysql 没有的情况下/home/admin/local/mysql/bin/mysql
mysqlCmd=mysql

#生成文件路径
HOME_PATH=/ebankfile/toods

#### date of system ####
sysdate=`date +%Y%m%d`
systime=`date +%H%M%S`
#生产上设定 停止接受调度时间
stopTime=235959

####记录日志的目录####
logPath=${HOME_PATH}/logs
####记录日志的文件####
logFile=${logPath}/dataExport_${sysdate}.log

#判断传入参数，8位日期则导出该日的增量数据，F 则导出截至昨天23：59：59的数据，其它则导出昨日增量数据
if [[ $1 =~ ^[0-9]{8}$ ]]
then
WANTEDDAY=$1
wherePara1="where (create_time>=date($WANTEDDAY) and create_time<date($WANTEDDAY) + interval 1 day) or (modify_time>=date($WANTEDDAY) and modify_time<date($WANTEDDAY) + interval 1 day)"
wherePara2="where do_time>=date($WANTEDDAY) and do_time<date($WANTEDDAY) + interval 1 day"
wherePara3="where 1=2"
elif [[ $1 = "F" ]]
then
WANTEDDAY=`date +%Y%m%d -d -1day`
wherePara1="where create_time<date($WANTEDDAY) + interval 1 day"
wherePara2="where do_time<date($WANTEDDAY) + interval 1 day"
wherePara3="where 1=1"
else
WANTEDDAY=`date +%Y%m%d -d -1day`
wherePara1="where (create_time>=date($WANTEDDAY) and create_time<date($WANTEDDAY) + interval 1 day) or (modify_time>=date($WANTEDDAY) and modify_time<date($WANTEDDAY) + interval 1 day)"
wherePara2="where do_time>=date($WANTEDDAY) and do_time<date($WANTEDDAY) + interval 1 day"
wherePara3="where 1=2"
fi

##日期目录
DAYPath=${HOME_PATH}/$WANTEDDAY

shlog()
{
    if [ ! -z "$1" ]
    then
        LOGTIME=`date +"%Y-%m-%d %H:%M:%S"`
        echo "[$LOGTIME] $1" >> $logFile
    fi
}
#### mkdir function ####
shmkpath()
{
if [ ! -d $1 ]
    then
mkdir -p $1
fi
}
#### mkfile function ####
shmkfile()
{
if [ ! -f $1 ]
    then   
shlog "create file $1 "
touch $1
fi
}

#### update table status function 定义更新表状态函数####
updatestate()
{
TABLENAME=$1
shlog "update table ${TABLENAME} state begin..."
shlog "update A_ODS_DATA_STATUS set DATA_STATUS='1', MODIFY_DATE='${sysdate}', MODIFY_TIME='${systime}' where TBL_NAME='${TABLENAME}'"
#db2 "update A_ODS_DATA_STATUS set DATA_STATUS='1', MODIFY_DATE='${sysdate}', MODIFY_TIME='${systime}' where TBL_NAME='${TABLENAME}'" >> $logFile

${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "update A_ODS_DATA_STATUS set DATA_STATUS='1', MODIFY_time=now() where TBL_NAME='${TABLENAME}'" >> $logFile

callrst=$?

if [ $callrst -ne 0 ]
then
    shlog "update table ${TABLENAME} state error!!"
    echo -1
	exit 1
  else
    shlog "update table ${TABLENAME} state success!!"
fi
}

#### logs path 创建记录日志的目录####
shmkpath ${logPath}
#### create logs file 创建记录日志的文件####
shmkfile ${logFile}
cat /dev/null > ${logFile}

##创建日期目录
shmkpath ${DAYPath}

##进入日期目录
cd ${DAYPath}
rm -rf ${DAYPath}/*

if [ $systime -gt $stopTime ]
then
#超过时间段的话直接返回0，等待第二天跑批
shlog "over time!"
exit 0
fi

shlog "export ${WANTEDDAY} data begin..."
#先清理目录下文件以免有残留。
sftp $mysqlSystemUser@$mysqlIP<<!
   rm $tempFile/*.dat
!

${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(ordermain_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(source2_id,'\\n',' '),'\\r',' '),replace(replace(source2_nm,'\\n',' '),'\\r',' '),total_num,total_price,total_bonus,promot_discount,bonus_discount,voucher_discount,replace(replace(is_invoice,'\\n',' '),'\\r',' '),replace(replace(invoice,'\\n',' '),'\\r',' '),replace(replace(invoice_content,'\\n',' '),'\\r',' '),replace(replace(bp_cust_grp,'\\n',' '),'\\r',' '),replace(replace(csg_name,'\\n',' '),'\\r',' '),replace(replace(csg_id_type,'\\n',' '),'\\r',' '),replace(replace(csg_idcard,'\\n',' '),'\\r',' '),replace(replace(csg_postcode,'\\n',' '),'\\r',' '),replace(replace(csg_address,'\\n',' '),'\\r',' '),replace(replace(csg_phone1,'\\n',' '),'\\r',' '),replace(replace(csg_phone2,'\\n',' '),'\\r',' '),replace(replace(ordermain_desc,'\\n',' '),'\\r',' '),perm_limit,cash_limit,stages_limit,replace(replace(card_userid,'\\n',' '),'\\r',' '),replace(replace(cont_id_type,'\\n',' '),'\\r',' '),replace(replace(cont_idcard,'\\n',' '),'\\r',' '),replace(replace(cont_nm,'\\n',' '),'\\r',' '),replace(replace(cont_nm_py,'\\n',' '),'\\r',' '),replace(replace(cont_postcode,'\\n',' '),'\\r',' '),replace(replace(cont_address,'\\n',' '),'\\r',' '),replace(replace(cont_mob_phone,'\\n',' '),'\\r',' '),replace(replace(cont_hphone,'\\n',' '),'\\r',' '),replace(replace(exp_date,'\\n',' '),'\\r',' '),replace(replace(fore_accdate,'\\n',' '),'\\r',' '),replace(replace(cardtype_id,'\\n',' '),'\\r',' '),replace(replace(pdt_nbr,'\\n',' '),'\\r',' '),replace(replace(format_id,'\\n',' '),'\\r',' '),total_inc_price,replace(replace(state_code,'\\n',' '),'\\r',' '),replace(replace(state_nm,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(cust_flag,'\\n',' '),'\\r',' '),replace(replace(vip_flag,'\\n',' '),'\\r',' '),replace(replace(acct_add_flag,'\\n',' '),'\\r',' '),replace(replace(cust_sex,'\\n',' '),'\\r',' '),replace(replace(ps_flag,'\\n',' '),'\\r',' '),replace(replace(cust_email,'\\n',' '),'\\r',' '),replace(replace(cust_birthday,'\\n',' '),'\\r',' '),replace(replace(exp_date_2,'\\n',' '),'\\r',' '),version_num,replace(replace(org_code,'\\n',' '),'\\r',' '),replace(replace(org_nm,'\\n',' '),'\\r',' '),replace(replace(org_level,'\\n',' '),'\\r',' '),replace(replace(csg_province,'\\n',' '),'\\r',' '),replace(replace(csg_city,'\\n',' '),'\\r',' '),replace(replace(csg_borough,'\\n',' '),'\\r',' '),replace(replace(accepted_no,'\\n',' '),'\\r',' '),replace(replace(serial_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(ismerge,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(defraytype,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(check_status,'\\n',' '),'\\r',' '),replace(replace(pay_result_time,'\\n',' '),'\\r',' '),replace(replace(desc1,'\\n',' '),'\\r',' '),replace(replace(desc2,'\\n',' '),'\\r',' '),replace(replace(desc3,'\\n',' '),'\\r',' '),replace(replace(reference_no,'\\n',' '),'\\r',' '),del_flag,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBLORDERMAIN_BACKUP.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tblordermain_backup $wherePara3" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(ordermain_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(source2_id,'\\n',' '),'\\r',' '),replace(replace(source2_nm,'\\n',' '),'\\r',' '),total_num,total_price,total_bonus,promot_discount,bonus_discount,voucher_discount,replace(replace(is_invoice,'\\n',' '),'\\r',' '),replace(replace(invoice,'\\n',' '),'\\r',' '),replace(replace(invoice_content,'\\n',' '),'\\r',' '),replace(replace(bp_cust_grp,'\\n',' '),'\\r',' '),replace(replace(csg_name,'\\n',' '),'\\r',' '),replace(replace(csg_id_type,'\\n',' '),'\\r',' '),replace(replace(csg_idcard,'\\n',' '),'\\r',' '),replace(replace(csg_postcode,'\\n',' '),'\\r',' '),replace(replace(csg_address,'\\n',' '),'\\r',' '),replace(replace(csg_phone1,'\\n',' '),'\\r',' '),replace(replace(csg_phone2,'\\n',' '),'\\r',' '),replace(replace(ordermain_desc,'\\n',' '),'\\r',' '),perm_limit,cash_limit,stages_limit,replace(replace(card_userid,'\\n',' '),'\\r',' '),replace(replace(cont_id_type,'\\n',' '),'\\r',' '),replace(replace(cont_idcard,'\\n',' '),'\\r',' '),replace(replace(cont_nm,'\\n',' '),'\\r',' '),replace(replace(cont_nm_py,'\\n',' '),'\\r',' '),replace(replace(cont_postcode,'\\n',' '),'\\r',' '),replace(replace(cont_address,'\\n',' '),'\\r',' '),replace(replace(cont_mob_phone,'\\n',' '),'\\r',' '),replace(replace(cont_hphone,'\\n',' '),'\\r',' '),replace(replace(exp_date,'\\n',' '),'\\r',' '),replace(replace(fore_accdate,'\\n',' '),'\\r',' '),replace(replace(cardtype_id,'\\n',' '),'\\r',' '),replace(replace(pdt_nbr,'\\n',' '),'\\r',' '),replace(replace(format_id,'\\n',' '),'\\r',' '),total_inc_price,replace(replace(state_code,'\\n',' '),'\\r',' '),replace(replace(state_nm,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(cust_flag,'\\n',' '),'\\r',' '),replace(replace(vip_flag,'\\n',' '),'\\r',' '),replace(replace(acct_add_flag,'\\n',' '),'\\r',' '),replace(replace(cust_sex,'\\n',' '),'\\r',' '),replace(replace(ps_flag,'\\n',' '),'\\r',' '),replace(replace(cust_email,'\\n',' '),'\\r',' '),replace(replace(cust_birthday,'\\n',' '),'\\r',' '),replace(replace(exp_date_2,'\\n',' '),'\\r',' '),version_num,replace(replace(org_code,'\\n',' '),'\\r',' '),replace(replace(org_nm,'\\n',' '),'\\r',' '),replace(replace(org_level,'\\n',' '),'\\r',' '),replace(replace(csg_province,'\\n',' '),'\\r',' '),replace(replace(csg_city,'\\n',' '),'\\r',' '),replace(replace(csg_borough,'\\n',' '),'\\r',' '),replace(replace(accepted_no,'\\n',' '),'\\r',' '),replace(replace(serial_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(ismerge,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(defraytype,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(check_status,'\\n',' '),'\\r',' '),replace(replace(pay_result_time,'\\n',' '),'\\r',' '),replace(replace(desc1,'\\n',' '),'\\r',' '),replace(replace(desc2,'\\n',' '),'\\r',' '),replace(replace(desc3,'\\n',' '),'\\r',' '),replace(replace(reference_no,'\\n',' '),'\\r',' '),del_flag,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBLORDERMAIN_HISTORY.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tblordermain_history $wherePara3" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(order_id,'\\n',' '),'\\r',' '),replace(replace(ordermain_id,'\\n',' '),'\\r',' '),oper_seq,replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(payway_code,'\\n',' '),'\\r',' '),replace(replace(payway_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(verify_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_id,'\\n',' '),'\\r',' '),replace(replace(vendor_snm,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(ot_source_id,'\\n',' '),'\\r',' '),replace(replace(ot_source_nm,'\\n',' '),'\\r',' '),replace(replace(goods_code,'\\n',' '),'\\r',' '),replace(replace(goods_id,'\\n',' '),'\\r',' '),replace(replace(bank_nbr,'\\n',' '),'\\r',' '),bonus_totalvalue,cal_money,orig_money,total_money,replace(replace(act_type,'\\n',' '),'\\r',' '),replace(replace(voucher_id,'\\n',' '),'\\r',' '),replace(replace(voucher_nm,'\\n',' '),'\\r',' '),voucher_price,replace(replace(voucher_no,'\\n',' '),'\\r',' '),replace(replace(act_id,'\\n',' '),'\\r',' '),replace(replace(acct_no,'\\n',' '),'\\r',' '),single_price,single_bonus,replace(replace(bonus_type,'\\n',' '),'\\r',' '),replace(replace(bonus_type_nm,'\\n',' '),'\\r',' '),replace(replace(goods_type,'\\n',' '),'\\r',' '),replace(replace(goods_type_name,'\\n',' '),'\\r',' '),replace(replace(is_tiein_sale,'\\n',' '),'\\r',' '),replace(replace(balance_status,'\\n',' '),'\\r',' '),replace(replace(batch_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(order_desc,'\\n',' '),'\\r',' '),replace(replace(cardno_benefit,'\\n',' '),'\\r',' '),replace(replace(validate_code,'\\n',' '),'\\r',' '),replace(replace(goods_payway_id,'\\n',' '),'\\r',' '),goods_num,replace(replace(goods_nm,'\\n',' '),'\\r',' '),replace(replace(mach_code,'\\n',' '),'\\r',' '),replace(replace(curr_type,'\\n',' '),'\\r',' '),exchange_rate,replace(replace(type_id,'\\n',' '),'\\r',' '),replace(replace(level_nm,'\\n',' '),'\\r',' '),replace(replace(goods_brand,'\\n',' '),'\\r',' '),replace(replace(goods_model,'\\n',' '),'\\r',' '),replace(replace(goods_color,'\\n',' '),'\\r',' '),replace(replace(goods_present,'\\n',' '),'\\r',' '),replace(replace(goods_present_desc,'\\n',' '),'\\r',' '),replace(replace(spec_flag,'\\n',' '),'\\r',' '),replace(replace(spec_desc,'\\n',' '),'\\r',' '),replace(replace(goods_range,'\\n',' '),'\\r',' '),replace(replace(goods_local,'\\n',' '),'\\r',' '),replace(replace(goodssend_flag,'\\n',' '),'\\r',' '),replace(replace(goodsaskfor_flag,'\\n',' '),'\\r',' '),replace(replace(goods_bill,'\\n',' '),'\\r',' '),replace(replace(goods_desc,'\\n',' '),'\\r',' '),replace(replace(goods_resv1,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_type,'\\n',' '),'\\r',' '),replace(replace(pay_type_nm,'\\n',' '),'\\r',' '),replace(replace(inc_code,'\\n',' '),'\\r',' '),replace(replace(inc_code_nm,'\\n',' '),'\\r',' '),stages_num,replace(replace(commission_type,'\\n',' '),'\\r',' '),commission_rate,commission,replace(replace(spec_shopno,'\\n',' '),'\\r',' '),replace(replace(bonus_bank_nbr,'\\n',' '),'\\r',' '),replace(replace(bonus_spec_shopno,'\\n',' '),'\\r',' '),replace(replace(pay_code,'\\n',' '),'\\r',' '),replace(replace(prod_code,'\\n',' '),'\\r',' '),replace(replace(plan_code,'\\n',' '),'\\r',' '),replace(replace(stages_desc,'\\n',' '),'\\r',' '),replace(replace(mcc,'\\n',' '),'\\r',' '),replace(replace(inc_way,'\\n',' '),'\\r',' '),replace(replace(inc_take_way,'\\n',' '),'\\r',' '),replace(replace(inc_type,'\\n',' '),'\\r',' '),inc_rate,inc_money,replace(replace(inc_desc,'\\n',' '),'\\r',' '),replace(replace(uitopsfee,'\\n',' '),'\\r',' '),uitfeeflg,uitfeedam,replace(replace(uitopsdate,'\\n',' '),'\\r',' '),uitdrtuit,uitdrtamt,replace(replace(inc_backway,'\\n',' '),'\\r',' '),inc_back_price,inc_take_price,replace(replace(credit_flag,'\\n',' '),'\\r',' '),replace(replace(cash_auth_type,'\\n',' '),'\\r',' '),replace(replace(accredit_date,'\\n',' '),'\\r',' '),replace(replace(accredit_time,'\\n',' '),'\\r',' '),replace(replace(auth_code,'\\n',' '),'\\r',' '),replace(replace(rtn_code,'\\n',' '),'\\r',' '),replace(replace(rtn_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg1_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg2_desc,'\\n',' '),'\\r',' '),replace(replace(host_acc_code,'\\n',' '),'\\r',' '),replace(replace(host_acc_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_date,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_time,'\\n',' '),'\\r',' '),replace(replace(bonus_trace_no,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_type,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_date,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_time,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_txn_msg_desc,'\\n',' '),'\\r',' '),replace(replace(cal_way,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_oper_flag,'\\n',' '),'\\r',' '),replace(replace(msg_content,'\\n',' '),'\\r',' '),replace(replace(tmp_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(sin_status_id,'\\n',' '),'\\r',' '),replace(replace(sin_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),version_num,replace(replace(ext_1,'\\n',' '),'\\r',' '),replace(replace(ext_2,'\\n',' '),'\\r',' '),replace(replace(ext_3,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(rule_id,'\\n',' '),'\\r',' '),replace(replace(rule_nm,'\\n',' '),'\\r',' '),replace(replace(limit_code,'\\n',' '),'\\r',' '),replace(replace(cust_type,'\\n',' '),'\\r',' '),replace(replace(accredit_type,'\\n',' '),'\\r',' '),replace(replace(app_flag,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_1,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_2,'\\n',' '),'\\r',' '),replace(replace(bank_nbr_2,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_2,'\\n',' '),'\\r',' '),replace(replace(accredit_date_2,'\\n',' '),'\\r',' '),replace(replace(accredit_time_2,'\\n',' '),'\\r',' '),replace(replace(auth_code_2,'\\n',' '),'\\r',' '),replace(replace(act_category,'\\n',' '),'\\r',' '),replace(replace(act_name,'\\n',' '),'\\r',' '),replace(replace(user_assc_nbr,'\\n',' '),'\\r',' '),replace(replace(vendor_phone,'\\n',' '),'\\r',' '),replace(replace(dfacct,'\\n',' '),'\\r',' '),replace(replace(dfname,'\\n',' '),'\\r',' '),replace(replace(dfhnbr,'\\n',' '),'\\r',' '),replace(replace(dfhname,'\\n',' '),'\\r',' '),replace(replace(cvv2,'\\n',' '),'\\r',' '),replace(replace(logistics_syn_flag,'\\n',' '),'\\r',' '),replace(replace(member_level,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(cardtype,'\\n',' '),'\\r',' '),replace(replace(receiver,'\\n',' '),'\\r',' '),DATE_FORMAT(received_time,'%Y-%m-%d %H:%i:%s'),replace(replace(cust_cart_id,'\\n',' '),'\\r',' '),miaosha_action_flag,replace(replace(reference_no,'\\n',' '),'\\r',' '),replace(replace(order_id_host,'\\n',' '),'\\r',' '),installment_price,replace(replace(member_name,'\\n',' '),'\\r',' '),DATE_FORMAT(first_reminde_time,'%Y-%m-%d %H:%i:%s'),reminde_times,reminde_flag,replace(replace(o2o_voucher_code,'\\n',' '),'\\r',' '),o2o_expire_flag,replace(replace(item_small_pic,'\\n',' '),'\\r',' '),replace(replace(sale_after_status,'\\n',' '),'\\r',' '),replace(replace(tiein_sale_memo,'\\n',' '),'\\r',' '),replace(replace(sin_apply_memo,'\\n',' '),'\\r',' '),DATE_FORMAT(order_succ_time,'%Y-%m-%d %H:%i:%s'),del_flag,'','',fenefit,costby,period_id,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),is_cancel_ops,is_cancel_netbank into outfile '$tempFile/TBLORDER_BACKUP.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tblorder_backup $wherePara3" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(order_id,'\\n',' '),'\\r',' '),replace(replace(ordermain_id,'\\n',' '),'\\r',' '),oper_seq,replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(payway_code,'\\n',' '),'\\r',' '),replace(replace(payway_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(verify_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_id,'\\n',' '),'\\r',' '),replace(replace(vendor_snm,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(ot_source_id,'\\n',' '),'\\r',' '),replace(replace(ot_source_nm,'\\n',' '),'\\r',' '),replace(replace(goods_code,'\\n',' '),'\\r',' '),replace(replace(goods_id,'\\n',' '),'\\r',' '),replace(replace(bank_nbr,'\\n',' '),'\\r',' '),bonus_totalvalue,cal_money,orig_money,total_money,replace(replace(act_type,'\\n',' '),'\\r',' '),replace(replace(voucher_id,'\\n',' '),'\\r',' '),replace(replace(voucher_nm,'\\n',' '),'\\r',' '),voucher_price,replace(replace(voucher_no,'\\n',' '),'\\r',' '),replace(replace(act_id,'\\n',' '),'\\r',' '),replace(replace(acct_no,'\\n',' '),'\\r',' '),single_price,single_bonus,replace(replace(bonus_type,'\\n',' '),'\\r',' '),replace(replace(bonus_type_nm,'\\n',' '),'\\r',' '),replace(replace(goods_type,'\\n',' '),'\\r',' '),replace(replace(goods_type_name,'\\n',' '),'\\r',' '),replace(replace(is_tiein_sale,'\\n',' '),'\\r',' '),replace(replace(balance_status,'\\n',' '),'\\r',' '),replace(replace(batch_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(order_desc,'\\n',' '),'\\r',' '),replace(replace(cardno_benefit,'\\n',' '),'\\r',' '),replace(replace(validate_code,'\\n',' '),'\\r',' '),replace(replace(goods_payway_id,'\\n',' '),'\\r',' '),goods_num,replace(replace(goods_nm,'\\n',' '),'\\r',' '),replace(replace(mach_code,'\\n',' '),'\\r',' '),replace(replace(curr_type,'\\n',' '),'\\r',' '),exchange_rate,replace(replace(type_id,'\\n',' '),'\\r',' '),replace(replace(level_nm,'\\n',' '),'\\r',' '),replace(replace(goods_brand,'\\n',' '),'\\r',' '),replace(replace(goods_model,'\\n',' '),'\\r',' '),replace(replace(goods_color,'\\n',' '),'\\r',' '),replace(replace(goods_present,'\\n',' '),'\\r',' '),replace(replace(goods_present_desc,'\\n',' '),'\\r',' '),replace(replace(spec_flag,'\\n',' '),'\\r',' '),replace(replace(spec_desc,'\\n',' '),'\\r',' '),replace(replace(goods_range,'\\n',' '),'\\r',' '),replace(replace(goods_local,'\\n',' '),'\\r',' '),replace(replace(goodssend_flag,'\\n',' '),'\\r',' '),replace(replace(goodsaskfor_flag,'\\n',' '),'\\r',' '),replace(replace(goods_bill,'\\n',' '),'\\r',' '),replace(replace(goods_desc,'\\n',' '),'\\r',' '),replace(replace(goods_resv1,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_type,'\\n',' '),'\\r',' '),replace(replace(pay_type_nm,'\\n',' '),'\\r',' '),replace(replace(inc_code,'\\n',' '),'\\r',' '),replace(replace(inc_code_nm,'\\n',' '),'\\r',' '),stages_num,replace(replace(commission_type,'\\n',' '),'\\r',' '),commission_rate,commission,replace(replace(spec_shopno,'\\n',' '),'\\r',' '),replace(replace(bonus_bank_nbr,'\\n',' '),'\\r',' '),replace(replace(bonus_spec_shopno,'\\n',' '),'\\r',' '),replace(replace(pay_code,'\\n',' '),'\\r',' '),replace(replace(prod_code,'\\n',' '),'\\r',' '),replace(replace(plan_code,'\\n',' '),'\\r',' '),replace(replace(stages_desc,'\\n',' '),'\\r',' '),replace(replace(mcc,'\\n',' '),'\\r',' '),replace(replace(inc_way,'\\n',' '),'\\r',' '),replace(replace(inc_take_way,'\\n',' '),'\\r',' '),replace(replace(inc_type,'\\n',' '),'\\r',' '),inc_rate,inc_money,replace(replace(inc_desc,'\\n',' '),'\\r',' '),replace(replace(uitopsfee,'\\n',' '),'\\r',' '),uitfeeflg,uitfeedam,replace(replace(uitopsdate,'\\n',' '),'\\r',' '),uitdrtuit,uitdrtamt,replace(replace(inc_backway,'\\n',' '),'\\r',' '),inc_back_price,inc_take_price,replace(replace(credit_flag,'\\n',' '),'\\r',' '),replace(replace(cash_auth_type,'\\n',' '),'\\r',' '),replace(replace(accredit_date,'\\n',' '),'\\r',' '),replace(replace(accredit_time,'\\n',' '),'\\r',' '),replace(replace(auth_code,'\\n',' '),'\\r',' '),replace(replace(rtn_code,'\\n',' '),'\\r',' '),replace(replace(rtn_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg1_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg2_desc,'\\n',' '),'\\r',' '),replace(replace(host_acc_code,'\\n',' '),'\\r',' '),replace(replace(host_acc_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_date,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_time,'\\n',' '),'\\r',' '),replace(replace(bonus_trace_no,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_type,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_date,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_time,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_txn_msg_desc,'\\n',' '),'\\r',' '),replace(replace(cal_way,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_oper_flag,'\\n',' '),'\\r',' '),replace(replace(msg_content,'\\n',' '),'\\r',' '),replace(replace(tmp_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(sin_status_id,'\\n',' '),'\\r',' '),replace(replace(sin_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),version_num,replace(replace(ext_1,'\\n',' '),'\\r',' '),replace(replace(ext_2,'\\n',' '),'\\r',' '),replace(replace(ext_3,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(rule_id,'\\n',' '),'\\r',' '),replace(replace(rule_nm,'\\n',' '),'\\r',' '),replace(replace(limit_code,'\\n',' '),'\\r',' '),replace(replace(cust_type,'\\n',' '),'\\r',' '),replace(replace(accredit_type,'\\n',' '),'\\r',' '),replace(replace(app_flag,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_1,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_2,'\\n',' '),'\\r',' '),replace(replace(bank_nbr_2,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_2,'\\n',' '),'\\r',' '),replace(replace(accredit_date_2,'\\n',' '),'\\r',' '),replace(replace(accredit_time_2,'\\n',' '),'\\r',' '),replace(replace(auth_code_2,'\\n',' '),'\\r',' '),replace(replace(act_category,'\\n',' '),'\\r',' '),replace(replace(act_name,'\\n',' '),'\\r',' '),replace(replace(user_assc_nbr,'\\n',' '),'\\r',' '),replace(replace(vendor_phone,'\\n',' '),'\\r',' '),replace(replace(dfacct,'\\n',' '),'\\r',' '),replace(replace(dfname,'\\n',' '),'\\r',' '),replace(replace(dfhnbr,'\\n',' '),'\\r',' '),replace(replace(dfhname,'\\n',' '),'\\r',' '),replace(replace(cvv2,'\\n',' '),'\\r',' '),replace(replace(logistics_syn_flag,'\\n',' '),'\\r',' '),replace(replace(member_level,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(cardtype,'\\n',' '),'\\r',' '),replace(replace(receiver,'\\n',' '),'\\r',' '),DATE_FORMAT(received_time,'%Y-%m-%d %H:%i:%s'),replace(replace(cust_cart_id,'\\n',' '),'\\r',' '),miaosha_action_flag,replace(replace(reference_no,'\\n',' '),'\\r',' '),replace(replace(order_id_host,'\\n',' '),'\\r',' '),installment_price,replace(replace(member_name,'\\n',' '),'\\r',' '),DATE_FORMAT(first_reminde_time,'%Y-%m-%d %H:%i:%s'),reminde_times,reminde_flag,replace(replace(o2o_voucher_code,'\\n',' '),'\\r',' '),o2o_expire_flag,replace(replace(item_small_pic,'\\n',' '),'\\r',' '),replace(replace(sale_after_status,'\\n',' '),'\\r',' '),replace(replace(tiein_sale_memo,'\\n',' '),'\\r',' '),replace(replace(sin_apply_memo,'\\n',' '),'\\r',' '),DATE_FORMAT(order_succ_time,'%Y-%m-%d %H:%i:%s'),del_flag,'','',fenefit,costby,period_id,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),is_cancel_ops,is_cancel_netbank into outfile '$tempFile/TBLORDER_HISTORY.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tblorder_history $wherePara3" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(integraltype_nm,'\\n',' '),'\\r',' '),replace(replace(cur_status,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_CFG_INTEGRALTYPE.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_cfg_integraltype" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(code,'\\n',' '),'\\r',' '),replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(name,'\\n',' '),'\\r',' '),product_id,replace(replace(manufacturer,'\\n',' '),'\\r',' '),replace(replace(create_type,'\\n',' '),'\\r',' '),replace(replace(vendor_id,'\\n',' '),'\\r',' '),goods_brand_id,replace(replace(goods_brand_name,'\\n',' '),'\\r',' '),back_category1_id,replace(replace(back_category1_nm,'\\n',' '),'\\r',' '),back_category2_id,replace(replace(back_category2_nm,'\\n',' '),'\\r',' '),back_category3_id,replace(replace(channel_mall,'\\n',' '),'\\r',' '),replace(replace(channel_cc,'\\n',' '),'\\r',' '),replace(replace(channel_mall_wx,'\\n',' '),'\\r',' '),replace(replace(channel_credit_wx,'\\n',' '),'\\r',' '),replace(replace(channel_phone,'\\n',' '),'\\r',' '),replace(replace(channel_app,'\\n',' '),'\\r',' '),replace(replace(channel_sms,'\\n',' '),'\\r',' '),replace(replace(channel_points,'\\n',' '),'\\r',' '),replace(replace(channel_ivr,'\\n',' '),'\\r',' '),replace(replace(goods_type,'\\n',' '),'\\r',' '),replace(replace(is_inner,'\\n',' '),'\\r',' '),replace(replace(mail_order_code,'\\n',' '),'\\r',' '),replace(replace(promotion_title,'\\n',' '),'\\r',' '),replace(replace(ad_word,'\\n',' '),'\\r',' '),replace(replace(keyword,'\\n',' '),'\\r',' '),replace(replace(gift_desc,'\\n',' '),'\\r',' '),'',replace(replace(service_type,'\\n',' '),'\\r',' '),replace(replace(recommend_goods1_code,'\\n',' '),'\\r',' '),replace(replace(recommend_goods2_code,'\\n',' '),'\\r',' '),replace(replace(recommend_goods3_code,'\\n',' '),'\\r',' '),replace(replace(region_type,'\\n',' '),'\\r',' '),replace(replace(approve_status,'\\n',' '),'\\r',' '),limit_count,replace(replace(points_type,'\\n',' '),'\\r',' '),replace(replace(cards,'\\n',' '),'\\r',' '),replace(replace(card_level_id,'\\n',' '),'\\r',' '),DATE_FORMAT(on_shelf_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(auto_off_shelf_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_mall_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_mall_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_cc_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_cc_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_mall_wx_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_mall_wx_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_credit_wx_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_credit_wx_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_phone_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_phone_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_app_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_app_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_sms_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_sms_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_points_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_points_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(on_shelf_ivr_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(off_shelf_ivr_date,'%Y-%m-%d %H:%i:%s'),replace(replace(freight_size,'\\n',' '),'\\r',' '),replace(replace(freight_weight,'\\n',' '),'\\r',' '),'','',replace(replace(goods_base_desc,'\\n',' '),'\\r',' '),replace(replace(curr_type,'\\n',' '),'\\r',' '),replace(replace(hidden_flag,'\\n',' '),'\\r',' '),del_flag,replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),installment_number,replace(replace(main_image,'\\n',' '),'\\r',' ') into outfile '$tempFile/TBL_GOODS.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_goods" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select id,replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(goods_brand,'\\n',' '),'\\r',' '),replace(replace(brand_name,'\\n',' '),'\\r',' '),replace(replace(brand_category_id,'\\n',' '),'\\r',' '),replace(replace(brand_category_name,'\\n',' '),'\\r',' '),brand_seq,replace(replace(brand_state,'\\n',' '),'\\r',' '),replace(replace(brand_image,'\\n',' '),'\\r',' '),replace(replace(brand_desc,'\\n',' '),'\\r',' '),replace(replace(publish_status,'\\n',' '),'\\r',' '),replace(replace(initial,'\\n',' '),'\\r',' '),replace(replace(spell,'\\n',' '),'\\r',' '),replace(replace(brand_head,'\\n',' '),'\\r',' '),'',replace(replace(brand_infor_status,'\\n',' '),'\\r',' '),replace(replace(approver_id,'\\n',' '),'\\r',' '),replace(replace(approve_memo,'\\n',' '),'\\r',' '),del_flag,replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_GOODS_BRAND.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_goods_brand" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(goods_payway_id,'\\n',' '),'\\r',' '),replace(replace(goods_id,'\\n',' '),'\\r',' '),replace(replace(payway_code,'\\n',' '),'\\r',' '),replace(replace(pay_type,'\\n',' '),'\\r',' '),inc_code,stages_code,replace(replace(rule_id,'\\n',' '),'\\r',' '),replace(replace(auth_flat1,'\\n',' '),'\\r',' '),replace(replace(auth_flat2,'\\n',' '),'\\r',' '),per_stage,replace(replace(stages_flag_cash,'\\n',' '),'\\r',' '),replace(replace(stages_flag_point,'\\n',' '),'\\r',' '),replace(replace(stages_flag_inc,'\\n',' '),'\\r',' '),goods_point,replace(replace(is_action,'\\n',' '),'\\r',' '),replace(replace(is_birth,'\\n',' '),'\\r',' '),replace(replace(member_level,'\\n',' '),'\\r',' '),goods_price,cal_money,replace(replace(goods_payway_desc,'\\n',' '),'\\r',' '),replace(replace(ischeck,'\\n',' '),'\\r',' '),replace(replace(cur_status,'\\n',' '),'\\r',' '),replace(replace(category_no,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),replace(replace(reserved1,'\\n',' '),'\\r',' ') into outfile '$tempFile/TBL_GOODS_PAYWAY.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_goods_payway" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(code,'\\n',' '),'\\r',' '),replace(replace(goods_code,'\\n',' '),'\\r',' '),market_price,price,stock,replace(replace(o2o_code,'\\n',' '),'\\r',' '),replace(replace(o2o_voucher_code,'\\n',' '),'\\r',' '),replace(replace(installment_number,'\\n',' '),'\\r',' '),stock_warning,DATE_FORMAT(nostock_notify_time,'%Y-%m-%d %H:%i:%s'),replace(replace(image1,'\\n',' '),'\\r',' '),replace(replace(image2,'\\n',' '),'\\r',' '),replace(replace(image3,'\\n',' '),'\\r',' '),replace(replace(image4,'\\n',' '),'\\r',' '),replace(replace(image5,'\\n',' '),'\\r',' '),replace(replace(freight_size,'\\n',' '),'\\r',' '),replace(replace(freight_weight,'\\n',' '),'\\r',' '),replace(replace(stages_code,'\\n',' '),'\\r',' '),fix_point,replace(replace(mach_code,'\\n',' '),'\\r',' '),goods_total,stick_flag,stick_order,wx_order,del_flag,replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),'',replace(replace(mid,'\\n',' '),'\\r',' '),replace(replace(oid,'\\n',' '),'\\r',' '),replace(replace(xid,'\\n',' '),'\\r',' '),replace(replace(bid,'\\n',' '),'\\r',' '),replace(replace(wx_prop1,'\\n',' '),'\\r',' '),replace(replace(wx_prop2,'\\n',' '),'\\r',' '),replace(replace(wx_prop3,'\\n',' '),'\\r',' '),preinstall_stock,product_point_rate,display_flag,best_rate,max_point,replace(replace(card_level_id,'\\n',' '),'\\r',' '),replace(replace(prefucture_id,'\\n',' '),'\\r',' '),virtual_limit,virtual_limit_days,virtual_mileage,virtual_price,virtual_integral_limit,is_show,wx_limit_count,replace(replace(attribute_key1,'\\n',' '),'\\r',' '),replace(replace(attribute_name1,'\\n',' '),'\\r',' '),replace(replace(attribute_value1,'\\n',' '),'\\r',' '),replace(replace(attribute_key2,'\\n',' '),'\\r',' '),replace(replace(attribute_name2,'\\n',' '),'\\r',' '),replace(replace(attribute_value2,'\\n',' '),'\\r',' ') into outfile '$tempFile/TBL_ITEM.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_item" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(order_id,'\\n',' '),'\\r',' '),replace(replace(ordermain_id,'\\n',' '),'\\r',' '),oper_seq,replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(payway_code,'\\n',' '),'\\r',' '),replace(replace(payway_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(verify_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_id,'\\n',' '),'\\r',' '),replace(replace(vendor_snm,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(ot_source_id,'\\n',' '),'\\r',' '),replace(replace(ot_source_nm,'\\n',' '),'\\r',' '),replace(replace(goods_code,'\\n',' '),'\\r',' '),replace(replace(goods_id,'\\n',' '),'\\r',' '),replace(replace(bank_nbr,'\\n',' '),'\\r',' '),bonus_totalvalue,cal_money,orig_money,total_money,replace(replace(act_type,'\\n',' '),'\\r',' '),replace(replace(voucher_id,'\\n',' '),'\\r',' '),replace(replace(voucher_nm,'\\n',' '),'\\r',' '),voucher_price,replace(replace(voucher_no,'\\n',' '),'\\r',' '),replace(replace(act_id,'\\n',' '),'\\r',' '),replace(replace(acct_no,'\\n',' '),'\\r',' '),single_price,single_bonus,replace(replace(bonus_type,'\\n',' '),'\\r',' '),replace(replace(bonus_type_nm,'\\n',' '),'\\r',' '),replace(replace(goods_type,'\\n',' '),'\\r',' '),replace(replace(goods_type_name,'\\n',' '),'\\r',' '),replace(replace(is_tiein_sale,'\\n',' '),'\\r',' '),replace(replace(balance_status,'\\n',' '),'\\r',' '),replace(replace(batch_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(order_desc,'\\n',' '),'\\r',' '),replace(replace(cardno_benefit,'\\n',' '),'\\r',' '),replace(replace(validate_code,'\\n',' '),'\\r',' '),replace(replace(goods_payway_id,'\\n',' '),'\\r',' '),goods_num,replace(replace(goods_nm,'\\n',' '),'\\r',' '),replace(replace(mach_code,'\\n',' '),'\\r',' '),replace(replace(curr_type,'\\n',' '),'\\r',' '),exchange_rate,replace(replace(type_id,'\\n',' '),'\\r',' '),replace(replace(level_nm,'\\n',' '),'\\r',' '),replace(replace(goods_brand,'\\n',' '),'\\r',' '),replace(replace(goods_model,'\\n',' '),'\\r',' '),replace(replace(goods_color,'\\n',' '),'\\r',' '),replace(replace(goods_present,'\\n',' '),'\\r',' '),replace(replace(goods_present_desc,'\\n',' '),'\\r',' '),replace(replace(spec_flag,'\\n',' '),'\\r',' '),replace(replace(spec_desc,'\\n',' '),'\\r',' '),replace(replace(goods_range,'\\n',' '),'\\r',' '),replace(replace(goods_local,'\\n',' '),'\\r',' '),replace(replace(goodssend_flag,'\\n',' '),'\\r',' '),replace(replace(goodsaskfor_flag,'\\n',' '),'\\r',' '),replace(replace(goods_bill,'\\n',' '),'\\r',' '),replace(replace(goods_desc,'\\n',' '),'\\r',' '),replace(replace(goods_resv1,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_type,'\\n',' '),'\\r',' '),replace(replace(pay_type_nm,'\\n',' '),'\\r',' '),replace(replace(inc_code,'\\n',' '),'\\r',' '),replace(replace(inc_code_nm,'\\n',' '),'\\r',' '),stages_num,replace(replace(commission_type,'\\n',' '),'\\r',' '),commission_rate,commission,replace(replace(spec_shopno,'\\n',' '),'\\r',' '),replace(replace(bonus_bank_nbr,'\\n',' '),'\\r',' '),replace(replace(bonus_spec_shopno,'\\n',' '),'\\r',' '),replace(replace(pay_code,'\\n',' '),'\\r',' '),replace(replace(prod_code,'\\n',' '),'\\r',' '),replace(replace(plan_code,'\\n',' '),'\\r',' '),replace(replace(stages_desc,'\\n',' '),'\\r',' '),replace(replace(mcc,'\\n',' '),'\\r',' '),replace(replace(inc_way,'\\n',' '),'\\r',' '),replace(replace(inc_take_way,'\\n',' '),'\\r',' '),replace(replace(inc_type,'\\n',' '),'\\r',' '),inc_rate,inc_money,replace(replace(inc_desc,'\\n',' '),'\\r',' '),replace(replace(uitopsfee,'\\n',' '),'\\r',' '),uitfeeflg,uitfeedam,replace(replace(uitopsdate,'\\n',' '),'\\r',' '),uitdrtuit,uitdrtamt,replace(replace(inc_backway,'\\n',' '),'\\r',' '),inc_back_price,inc_take_price,replace(replace(credit_flag,'\\n',' '),'\\r',' '),replace(replace(cash_auth_type,'\\n',' '),'\\r',' '),replace(replace(accredit_date,'\\n',' '),'\\r',' '),replace(replace(accredit_time,'\\n',' '),'\\r',' '),replace(replace(auth_code,'\\n',' '),'\\r',' '),replace(replace(rtn_code,'\\n',' '),'\\r',' '),replace(replace(rtn_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg1_desc,'\\n',' '),'\\r',' '),replace(replace(txn_msg2_desc,'\\n',' '),'\\r',' '),replace(replace(host_acc_code,'\\n',' '),'\\r',' '),replace(replace(host_acc_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_date,'\\n',' '),'\\r',' '),replace(replace(bonus_trn_time,'\\n',' '),'\\r',' '),replace(replace(bonus_trace_no,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_type,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_date,'\\n',' '),'\\r',' '),replace(replace(bonus_accredit_time,'\\n',' '),'\\r',' '),replace(replace(bonus_auth_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_code,'\\n',' '),'\\r',' '),replace(replace(bonus_rtn_desc,'\\n',' '),'\\r',' '),replace(replace(bonus_txn_msg_desc,'\\n',' '),'\\r',' '),replace(replace(cal_way,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(vendor_oper_flag,'\\n',' '),'\\r',' '),replace(replace(msg_content,'\\n',' '),'\\r',' '),replace(replace(tmp_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(sin_status_id,'\\n',' '),'\\r',' '),replace(replace(sin_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),version_num,replace(replace(ext_1,'\\n',' '),'\\r',' '),replace(replace(ext_2,'\\n',' '),'\\r',' '),replace(replace(ext_3,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(rule_id,'\\n',' '),'\\r',' '),replace(replace(rule_nm,'\\n',' '),'\\r',' '),replace(replace(limit_code,'\\n',' '),'\\r',' '),replace(replace(cust_type,'\\n',' '),'\\r',' '),replace(replace(accredit_type,'\\n',' '),'\\r',' '),replace(replace(app_flag,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_1,'\\n',' '),'\\r',' '),replace(replace(cash_trace_no_2,'\\n',' '),'\\r',' '),replace(replace(bank_nbr_2,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_2,'\\n',' '),'\\r',' '),replace(replace(accredit_date_2,'\\n',' '),'\\r',' '),replace(replace(accredit_time_2,'\\n',' '),'\\r',' '),replace(replace(auth_code_2,'\\n',' '),'\\r',' '),replace(replace(act_category,'\\n',' '),'\\r',' '),replace(replace(act_name,'\\n',' '),'\\r',' '),replace(replace(user_assc_nbr,'\\n',' '),'\\r',' '),replace(replace(vendor_phone,'\\n',' '),'\\r',' '),replace(replace(dfacct,'\\n',' '),'\\r',' '),replace(replace(dfname,'\\n',' '),'\\r',' '),replace(replace(dfhnbr,'\\n',' '),'\\r',' '),replace(replace(dfhname,'\\n',' '),'\\r',' '),replace(replace(cvv2,'\\n',' '),'\\r',' '),replace(replace(logistics_syn_flag,'\\n',' '),'\\r',' '),replace(replace(member_level,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(cardtype,'\\n',' '),'\\r',' '),replace(replace(receiver,'\\n',' '),'\\r',' '),DATE_FORMAT(received_time,'%Y-%m-%d %H:%i:%s'),replace(replace(cust_cart_id,'\\n',' '),'\\r',' '),miaosha_action_flag,replace(replace(reference_no,'\\n',' '),'\\r',' '),replace(replace(order_id_host,'\\n',' '),'\\r',' '),installment_price,replace(replace(member_name,'\\n',' '),'\\r',' '),DATE_FORMAT(first_reminde_time,'%Y-%m-%d %H:%i:%s'),reminde_times,reminde_flag,replace(replace(o2o_voucher_code,'\\n',' '),'\\r',' '),o2o_expire_flag,replace(replace(item_small_pic,'\\n',' '),'\\r',' '),replace(replace(sale_after_status,'\\n',' '),'\\r',' '),replace(replace(tiein_sale_memo,'\\n',' '),'\\r',' '),replace(replace(sin_apply_memo,'\\n',' '),'\\r',' '),DATE_FORMAT(order_succ_time,'%Y-%m-%d %H:%i:%s'),del_flag,'','',fenefit,costby,is_cancel_ops,is_cancel_netbank,period_id,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_ORDER.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_order $wherePara1" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select id,replace(replace(order_id,'\\n',' '),'\\r',' '),DATE_FORMAT(do_time,'%Y-%m-%d %H:%i:%s'),replace(replace(do_userid,'\\n',' '),'\\r',' '),replace(replace(user_type,'\\n',' '),'\\r',' '),replace(replace(status_id,'\\n',' '),'\\r',' '),replace(replace(status_nm,'\\n',' '),'\\r',' '),replace(replace(msg_content,'\\n',' '),'\\r',' '),replace(replace(do_desc,'\\n',' '),'\\r',' '),replace(replace(rule_id,'\\n',' '),'\\r',' '),replace(replace(rule_nm,'\\n',' '),'\\r',' '),del_flag,replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_ORDER_DODETAIL.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_order_dodetail $wherePara2" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select order_extend1_id,replace(replace(order_id,'\\n',' '),'\\r',' '),replace(replace(errorcode,'\\n',' '),'\\r',' '),replace(replace(approveresult,'\\n',' '),'\\r',' '),replace(replace(followdir,'\\n',' '),'\\r',' '),replace(replace(caseid,'\\n',' '),'\\r',' '),replace(replace(specialcust,'\\n',' '),'\\r',' '),replace(replace(releasetype,'\\n',' '),'\\r',' '),replace(replace(rejectcode,'\\n',' '),'\\r',' '),replace(replace(aprtcode,'\\n',' '),'\\r',' '),replace(replace(ordernbr,'\\n',' '),'\\r',' '),replace(replace(processstatus,'\\n',' '),'\\r',' '),replace(replace(processresult,'\\n',' '),'\\r',' '),replace(replace(creator,'\\n',' '),'\\r',' '),replace(replace(regulator,'\\n',' '),'\\r',' '),replace(replace(michelleid,'\\n',' '),'\\r',' '),replace(replace(incomingtel,'\\n',' '),'\\r',' '),replace(replace(extend1,'\\n',' '),'\\r',' '),replace(replace(extend2,'\\n',' '),'\\r',' '),replace(replace(extend3,'\\n',' '),'\\r',' ') into outfile '$tempFile/TBL_ORDER_EXTEND1.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_order_extend1 " >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(ordermain_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(ordertype_nm,'\\n',' '),'\\r',' '),replace(replace(cardno,'\\n',' '),'\\r',' '),replace(replace(source_id,'\\n',' '),'\\r',' '),replace(replace(source_nm,'\\n',' '),'\\r',' '),replace(replace(source2_id,'\\n',' '),'\\r',' '),replace(replace(source2_nm,'\\n',' '),'\\r',' '),total_num,total_price,total_bonus,promot_discount,bonus_discount,voucher_discount,replace(replace(is_invoice,'\\n',' '),'\\r',' '),replace(replace(invoice,'\\n',' '),'\\r',' '),replace(replace(invoice_content,'\\n',' '),'\\r',' '),replace(replace(bp_cust_grp,'\\n',' '),'\\r',' '),replace(replace(csg_name,'\\n',' '),'\\r',' '),replace(replace(csg_id_type,'\\n',' '),'\\r',' '),replace(replace(csg_idcard,'\\n',' '),'\\r',' '),replace(replace(csg_postcode,'\\n',' '),'\\r',' '),replace(replace(csg_address,'\\n',' '),'\\r',' '),replace(replace(csg_phone1,'\\n',' '),'\\r',' '),replace(replace(csg_phone2,'\\n',' '),'\\r',' '),replace(replace(ordermain_desc,'\\n',' '),'\\r',' '),perm_limit,cash_limit,stages_limit,replace(replace(card_userid,'\\n',' '),'\\r',' '),replace(replace(cont_id_type,'\\n',' '),'\\r',' '),replace(replace(cont_idcard,'\\n',' '),'\\r',' '),replace(replace(cont_nm,'\\n',' '),'\\r',' '),replace(replace(cont_nm_py,'\\n',' '),'\\r',' '),replace(replace(cont_postcode,'\\n',' '),'\\r',' '),replace(replace(cont_address,'\\n',' '),'\\r',' '),replace(replace(cont_mob_phone,'\\n',' '),'\\r',' '),replace(replace(cont_hphone,'\\n',' '),'\\r',' '),replace(replace(exp_date,'\\n',' '),'\\r',' '),replace(replace(fore_accdate,'\\n',' '),'\\r',' '),replace(replace(cardtype_id,'\\n',' '),'\\r',' '),replace(replace(pdt_nbr,'\\n',' '),'\\r',' '),replace(replace(format_id,'\\n',' '),'\\r',' '),total_inc_price,replace(replace(state_code,'\\n',' '),'\\r',' '),replace(replace(state_nm,'\\n',' '),'\\r',' '),replace(replace(locked_flag,'\\n',' '),'\\r',' '),replace(replace(cur_status_id,'\\n',' '),'\\r',' '),replace(replace(cur_status_nm,'\\n',' '),'\\r',' '),replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),replace(replace(comm_date,'\\n',' '),'\\r',' '),replace(replace(comm_time,'\\n',' '),'\\r',' '),replace(replace(reserved1,'\\n',' '),'\\r',' '),replace(replace(cust_flag,'\\n',' '),'\\r',' '),replace(replace(vip_flag,'\\n',' '),'\\r',' '),replace(replace(acct_add_flag,'\\n',' '),'\\r',' '),replace(replace(cust_sex,'\\n',' '),'\\r',' '),replace(replace(ps_flag,'\\n',' '),'\\r',' '),replace(replace(cust_email,'\\n',' '),'\\r',' '),replace(replace(cust_birthday,'\\n',' '),'\\r',' '),replace(replace(exp_date_2,'\\n',' '),'\\r',' '),version_num,replace(replace(org_code,'\\n',' '),'\\r',' '),replace(replace(org_nm,'\\n',' '),'\\r',' '),replace(replace(org_level,'\\n',' '),'\\r',' '),replace(replace(csg_province,'\\n',' '),'\\r',' '),replace(replace(csg_city,'\\n',' '),'\\r',' '),replace(replace(csg_borough,'\\n',' '),'\\r',' '),replace(replace(accepted_no,'\\n',' '),'\\r',' '),replace(replace(serial_no,'\\n',' '),'\\r',' '),replace(replace(e_update_status,'\\n',' '),'\\r',' '),replace(replace(ismerge,'\\n',' '),'\\r',' '),replace(replace(integraltype_id,'\\n',' '),'\\r',' '),replace(replace(defraytype,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(error_code,'\\n',' '),'\\r',' '),replace(replace(check_status,'\\n',' '),'\\r',' '),replace(replace(pay_result_time,'\\n',' '),'\\r',' '),replace(replace(desc1,'\\n',' '),'\\r',' '),replace(replace(desc2,'\\n',' '),'\\r',' '),replace(replace(desc3,'\\n',' '),'\\r',' '),replace(replace(reference_no,'\\n',' '),'\\r',' '),del_flag,DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_ORDER_MAIN.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_order_main $wherePara1" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select id,replace(replace(ordertype_id,'\\n',' '),'\\r',' '),replace(replace(prom_code,'\\n',' '),'\\r',' '),replace(replace(name,'\\n',' '),'\\r',' '),replace(replace(short_name,'\\n',' '),'\\r',' '),prom_type,is_signup,DATE_FORMAT(begin_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(end_date,'%Y-%m-%d %H:%i:%s'),replace(replace(loopType,'\\n',' '),'\\r',' '),replace(replace(loopData,'\\n',' '),'\\r',' '),DATE_FORMAT(loopBeginTime1,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(loopEndTime1,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(loopBeginTime2,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(loopEndTime2,'%Y-%m-%d %H:%i:%s'),ruleDiscountRate,ruleLimitBuyCount,ruleLimitBuyType,ruleFrequency,ruleLimitTicket,ruleGroupCount,ruleMinPay1,ruleMinPay2,ruleMinPay3,ruleMinPay4,ruleMinPay5,ruleMinPay6,ruleMinPay7,ruleMinPay8,ruleMinPay9,ruleMinPay10,ruleFee1,ruleFee2,ruleFee3,ruleFee4,ruleFee5,ruleFee6,ruleFee7,ruleFee8,ruleFee9,ruleFee10,replace(replace(source_id,'\\n',' '),'\\r',' '),'',replace(replace(fee_rule,'\\n',' '),'\\r',' '),check_status,DATE_FORMAT(begin_entry_date,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(end_entry_date,'%Y-%m-%d %H:%i:%s'),range_count,audit_range_count,create_oper_type,modify_oper_type,replace(replace(audit_log,'\\n',' '),'\\r',' '),replace(replace(audit_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(audit_date,'%Y-%m-%d %H:%i:%s'),is_valid,replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s') into outfile '$tempFile/TBL_PROMOTION.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_promotion" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select id,promotion_id,replace(replace(vendor_id,'\\n',' '),'\\r',' '),range_type,replace(replace(select_id,'\\n',' '),'\\r',' '),replace(replace(select_code,'\\n',' '),'\\r',' '),replace(replace(select_name,'\\n',' '),'\\r',' '),replace(replace(goods_code,'\\n',' '),'\\r',' '),back_category1_id,back_category2_id,back_category3_id,replace(replace(check_status,'\\n',' '),'\\r',' '),is_valid,seq,price,stock,costBy,couponEnable,levelMinCount,levelPrice,startPrice,minPrice,feeRange,create_oper_type,modify_oper_type,replace(replace(audit_log,'\\n',' '),'\\r',' '),replace(replace(audit_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(audit_date,'%Y-%m-%d %H:%i:%s'),replace(replace(create_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),saleCount,perStock into outfile '$tempFile/TBL_PROMOTION_RANGE.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_promotion_range" >> $logFile
${mysqlCmd} -u${mysqlUser} -p${mysqlPassword} -h${mysqlIP} -P${mysqlPort} -vv ${mysqlDB} -e "select replace(replace(vendor_id,'\\n',' '),'\\r',' '),replace(replace(mer_id,'\\n',' '),'\\r',' '),replace(replace(full_name,'\\n',' '),'\\r',' '),replace(replace(simple_name,'\\n',' '),'\\r',' '),replace(replace(tax_code,'\\n',' '),'\\r',' '),replace(replace(business_type_id,'\\n',' '),'\\r',' '),replace(replace(pay_condition,'\\n',' '),'\\r',' '),replace(replace(pay_group,'\\n',' '),'\\r',' '),commision,replace(replace(pay_way,'\\n',' '),'\\r',' '),replace(replace(pay_currency,'\\n',' '),'\\r',' '),replace(replace(freight_tip,'\\n',' '),'\\r',' '),replace(replace(fee_type,'\\n',' '),'\\r',' '),replace(replace(province_id,'\\n',' '),'\\r',' '),replace(replace(province,'\\n',' '),'\\r',' '),replace(replace(city_id,'\\n',' '),'\\r',' '),replace(replace(city,'\\n',' '),'\\r',' '),replace(replace(area_id,'\\n',' '),'\\r',' '),replace(replace(area,'\\n',' '),'\\r',' '),replace(replace(cooper_address,'\\n',' '),'\\r',' '),replace(replace(enterprise_address,'\\n',' '),'\\r',' '),replace(replace(post_code,'\\n',' '),'\\r',' '),replace(replace(pay_address,'\\n',' '),'\\r',' '),replace(replace(buy_address,'\\n',' '),'\\r',' '),replace(replace(pay_condition_address,'\\n',' '),'\\r',' '),replace(replace(pay_group_address,'\\n',' '),'\\r',' '),replace(replace(address,'\\n',' '),'\\r',' '),replace(replace(debt_account,'\\n',' '),'\\r',' '),replace(replace(prepay_account,'\\n',' '),'\\r',' '),replace(replace(debt_man,'\\n',' '),'\\r',' '),replace(replace(contact,'\\n',' '),'\\r',' '),replace(replace(phone,'\\n',' '),'\\r',' '),replace(replace(contact_tax,'\\n',' '),'\\r',' '),replace(replace(email,'\\n',' '),'\\r',' '),replace(replace(invoice,'\\n',' '),'\\r',' '),replace(replace(acc_bank,'\\n',' '),'\\r',' '),replace(replace(acc_no,'\\n',' '),'\\r',' '),replace(replace(status,'\\n',' '),'\\r',' '),replace(replace(vendor_role,'\\n',' '),'\\r',' '),replace(replace(union_pay_no,'\\n',' '),'\\r',' '),replace(replace(service_time,'\\n',' '),'\\r',' '),replace(replace(spec_shopno,'\\n',' '),'\\r',' '),replace(replace(spec_shopno_type,'\\n',' '),'\\r',' '),replace(replace(bank_no,'\\n',' '),'\\r',' '),replace(replace(pay_code,'\\n',' '),'\\r',' '),replace(replace(prod_code,'\\n',' '),'\\r',' '),replace(replace(plan_code,'\\n',' '),'\\r',' '),replace(replace(stages_desc,'\\n',' '),'\\r',' '),replace(replace(mcc,'\\n',' '),'\\r',' '),fix_fee,replace(replace(net_status,'\\n',' '),'\\r',' '),replace(replace(right_code,'\\n',' '),'\\r',' '),replace(replace(vendor_desc,'\\n',' '),'\\r',' '),replace(replace(vendor_type,'\\n',' '),'\\r',' '),replace(replace(epos_vendor_id,'\\n',' '),'\\r',' '),maximum_amt,replace(replace(vendor_no,'\\n',' '),'\\r',' '),replace(replace(action_flag,'\\n',' '),'\\r',' '),out_system_id,replace(replace(is_sec_kill,'\\n',' '),'\\r',' '),replace(replace(virtual_vendor_id,'\\n',' '),'\\r',' '),replace(replace(vendor_time,'\\n',' '),'\\r',' '),replace(replace(order_stage_code,'\\n',' '),'\\r',' '),'',del_flag,replace(replace(create_oper,'\\n',' '),'\\r',' '),replace(replace(modify_oper,'\\n',' '),'\\r',' '),DATE_FORMAT(create_time,'%Y-%m-%d %H:%i:%s'),DATE_FORMAT(modify_time,'%Y-%m-%d %H:%i:%s'),replace(replace(reserved1,'\\n',' '),'\\r',' ') into outfile '$tempFile/TBL_VENDOR_INF.dat' character set gbk FIELDS TERMINATED BY 0x1b LINES TERMINATED BY '\\n' from cgbmall.tbl_vendor_inf" >> $logFile

callrst=$?
if [ $callrst -ne 0 ]
then
    shlog "export data error!!"
    echo -1
	exit 1
  elif [ `grep -o 'ERROR' $logFile | wc -l` -ne 0 ]
	then
    shlog "export data error!!"
	echo -1
	exit 1
	else 
	shlog "export data success!!"
fi

shlog "get data begin..."
sftp $mysqlSystemUser@$mysqlIP<<!
   get $tempFile/*.dat $DAYPath/
   rm $tempFile/*.dat
!
shlog "get ${WANTEDDAY} data end "

callrst=$?
if [ $callrst -ne 0 ]
then
    shlog "export data error!!"
    echo -1
	exit 1
else 
	shlog "sftp data success!!"
fi
	
	
sed -i 's/\\N//g' $DAYPath/*.dat
if [ $callrst -ne 0 ]
	then
	shlog "sed data error!!"
	echo -1
	exit 1
fi
	
	shmkfile TBL_CFG_INTEGRALTYPE.ok
	shmkfile TBL_GOODS.ok
	shmkfile TBL_GOODS_BRAND.ok
	shmkfile TBL_GOODS_PAYWAY.ok
	shmkfile TBL_ITEM.ok
	shmkfile TBL_ORDER.ok
	shmkfile TBL_ORDER_DODETAIL.ok
	shmkfile TBL_ORDER_MAIN.ok
	shmkfile TBL_VENDOR_INF.ok
	shmkfile TBL_PROMOTION_RANGE.ok
	shmkfile TBLORDERMAIN_BACKUP.ok
	shmkfile TBLORDERMAIN_HISTORY.ok
	shmkfile TBLORDER_BACKUP.ok
	shmkfile TBLORDER_HISTORY.ok
	shmkfile TBL_ORDER_EXTEND1.ok
	shmkfile TBL_PROMOTION.ok
	shmkfile $WANTEDDAY.ok
	
	updatestate tbl_cfg_integraltype
	updatestate tbl_goods
	updatestate tbl_goods_brand
	updatestate tbl_goods_payway
	updatestate tbl_item
	updatestate tbl_order
	updatestate tbl_order_dodetail
	updatestate tbl_order_main
	updatestate tbl_vendor_inf
	updatestate tbl_promotion_range
	updatestate tblordermain_backup
	updatestate tblordermain_history
	updatestate tblorder_backup
	updatestate tblorder_history
	updatestate tbl_order_extend1
	updatestate tbl_promotion

shlog "export ${WANTEDDAY} data end "

####cleanup Data####
#保留最近30天的数据
cd ${HOME_PATH}/
ls -t | tail -n +31 | xargs rm -rf
echo 0











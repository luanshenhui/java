<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Goods">
    <resultMap id="GoodsMap" type="GoodsModel">
        <result property="code" column="code"/>
        <result property="ordertypeId" column="ordertype_id"/>
        <result property="name" column="name"/>
        <result property="productId" column="product_id"/>
        <result property="createType" column="create_type"/>
        <result property="vendorId" column="vendor_id"/>
        <result property="manufacturer" column="manufacturer"/>
        <result property="goodsBrandId" column="goods_brand_id"/>
        <result property="goodsBrandName" column="goods_brand_name"/>
        <result property="channelMall" column="channel_mall"/>
        <result property="channelCc" column="channel_cc"/>
        <result property="channelMallWx" column="channel_mall_wx"/>
        <result property="channelCreditWx" column="channel_credit_wx"/>
        <result property="channelPhone" column="channel_phone"/>
        <result property="channelApp" column="channel_app"/>
        <result property="channelSms" column="channel_sms"/>
        <result property="channelPoints" column="channel_points"/>
        <result property="channelIvr" column="channel_ivr"/>
        <result property="goodsType" column="goods_type"/>
        <result property="isInner" column="is_inner"/>
        <result property="mailOrderCode" column="mail_order_code"/>
        <result property="promotionTitle" column="promotion_title"/>
        <result property="adWord" column="ad_word"/>
        <result property="keyword" column="keyword"/>
        <result property="giftDesc" column="gift_desc"/>
        <result property="introduction" column="introduction"/>
        <result property="serviceType" column="service_type"/>
        <result property="recommendGoods1Code" column="recommend_goods1_code"/>
        <result property="recommendGoods2Code" column="recommend_goods2_code"/>
        <result property="recommendGoods3Code" column="recommend_goods3_code"/>
        <result property="regionType" column="region_type"/>
        <result property="approveStatus" column="approve_status"/>
        <result property="limitCount" column="limit_count"/>
        <result property="pointsType" column="points_type"/>
        <result property="cards" column="cards"/>
        <result property="cardLevelId" column="card_level_id"/>
        <result property="onShelfMallDate" column="on_shelf_mall_date"/>
        <result property="offShelfMallDate" column="off_shelf_mall_date"/>
        <result property="onShelfCcDate" column="on_shelf_cc_date"/>
        <result property="offShelfCcDate" column="off_shelf_cc_date"/>
        <result property="onShelfMallWxDate" column="on_shelf_mall_wx_date"/>
        <result property="offShelfMallWxDate" column="off_shelf_mall_wx_date"/>
        <result property="onShelfCreditWxDate" column="on_shelf_credit_wx_date"/>
        <result property="offShelfCreditWxDate" column="off_shelf_credit_wx_date"/>
        <result property="onShelfPhoneDate" column="on_shelf_phone_date"/>
        <result property="offShelfPhoneDate" column="off_shelf_phone_date"/>
        <result property="onShelfAppDate" column="on_shelf_app_date"/>
        <result property="offShelfAppDate" column="off_shelf_app_date"/>
        <result property="onShelfSmsDate" column="on_shelf_sms_date"/>
        <result property="offShelfSmsDate" column="off_shelf_sms_date"/>
        <result property="freightSize" column="freight_size"/>
        <result property="freightWeight" column="freight_weight"/>
        <result property="approveDifferent" column="approve_different"/>
        <result property="currType" column="curr_type"/>
        <result property="delFlag" column="del_flag"/>
        <result property="createOper" column="create_oper"/>
        <result property="createTime" column="create_time"/>
        <result property="modifyOper" column="modify_oper"/>
        <result property="modifyTime" column="modify_time"/>
        <result property="onShelfTime" column="on_shelf_time"/>
        <result property="autoOffShelfTime" column="auto_off_shelf_time"/>
        <result property="offShelfPointsDate" column="off_shelf_points_date"/>
        <result property="onShelfPointsDate" column="on_shelf_points_date"/>
        <result property="onShelfIvrDate" column="on_shelf_ivr_date"/>
        <result property="offShelfIvrDate" column="off_shelf_ivr_date"/>
    </resultMap>
    <sql id="columns">
        code,ordertype_id,name,product_id,create_type,vendor_id,manufacturer,goods_brand_id,goods_brand_name,channel_mall,channel_cc,channel_mall_wx,channel_credit_wx,channel_phone,channel_app,channel_sms,channel_points,channel_ivr,goods_type,is_inner,mail_order_code,promotion_title,ad_word,keyword,gift_desc,introduction,service_type,recommend_goods1_code,recommend_goods2_code,recommend_goods3_code,region_type,approve_status,limit_count,points_type,cards,card_level_id,on_shelf_mall_date,off_shelf_mall_date,on_shelf_cc_date,off_shelf_cc_date,on_shelf_mall_wx_date,off_shelf_mall_wx_date,on_shelf_credit_wx_date,off_shelf_credit_wx_date,on_shelf_phone_date,off_shelf_phone_date,on_shelf_app_date,off_shelf_app_date,on_shelf_sms_date,off_shelf_sms_date,freight_size,freight_weight,approve_different,curr_type,del_flag,create_oper,create_time,modify_oper,modify_time,on_shelf_time,auto_off_shelf_time,on_shelf_points_date,off_shelf_points_date,on_shelf_ivr_date,off_shelf_ivr_date,channel_points
    </sql>

    <insert id="insert" parameterType="GoodsModel" useGeneratedKeys="true"
            keyProperty="code" keyColumn="code">
        insert into tbl_goods
        (code,
        ordertype_id
        ,name
        ,product_id
        ,create_type
        ,vendor_id
        ,manufacturer
        ,goods_brand_id
        ,goods_brand_name
        ,channel_mall
        ,channel_cc
        ,channel_mall_wx
        ,channel_credit_wx
        ,channel_phone
        ,channel_app
        ,channel_sms
        ,channel_points
        ,channel_ivr
        ,goods_type
        ,is_inner
        ,mail_order_code
        ,promotion_title
        ,ad_word
        ,keyword
        ,gift_desc
        ,introduction
        ,service_type
        ,recommend_goods1_code
        ,recommend_goods2_code
        ,recommend_goods3_code
        ,region_type
        ,approve_status
        ,limit_count
        ,points_type
        ,cards
        ,card_level_id
        ,on_shelf_mall_date
        ,off_shelf_mall_date
        ,on_shelf_cc_date
        ,off_shelf_cc_date
        ,on_shelf_mall_wx_date
        ,off_shelf_mall_wx_date
        ,on_shelf_credit_wx_date
        ,off_shelf_credit_wx_date
        ,on_shelf_phone_date
        ,off_shelf_phone_date
        ,on_shelf_app_date
        ,off_shelf_app_date
        ,on_shelf_sms_date
        ,off_shelf_sms_date
        ,freight_size
        ,freight_weight
        ,approve_different
        ,curr_type
        ,del_flag
        ,create_oper
        ,create_time
        ,modify_oper
        ,modify_time
        ,on_shelf_time
        ,auto_off_shelf_time)
        values(
        #{code}
        ,#{ordertypeId}
        ,#{name}
        ,#{productId}
        ,#{createType}
        ,#{vendorId}
        ,#{manufacturer}
        ,#{goodsBrandId}
        ,#{goodsBrandName}
        ,#{channelMall}
        ,#{channelCc}
        ,#{channelMallWx}
        ,#{channelCreditWx}
        ,#{channelPhone}
        ,#{channelApp}
        ,#{channelSms}
        ,#{channelPoints}
        ,#{channelIvr}
        ,#{goodsType}
        ,#{isInner}
        ,#{mailOrderCode}
        ,#{promotionTitle}
        ,#{adWord}
        ,#{keyword}
        ,#{giftDesc}
        ,#{introduction}
        ,#{serviceType}
        ,#{recommendGoods1Code}
        ,#{recommendGoods2Code}
        ,#{recommendGoods3Code}
        ,#{regionType}
        ,#{approveStatus}
        ,#{limitCount}
        ,#{pointsType}
        ,#{cards}
        ,#{cardLevelId}
        ,#{onShelfMallDate}
        ,#{offShelfMallDate}
        ,#{onShelfCcDate}
        ,#{offShelfCcDate}
        ,#{onShelfMallWxDate}
        ,#{offShelfMallWxDate}
        ,#{onShelfCreditWxDate}
        ,#{offShelfCreditWxDate}
        ,#{onShelfPhoneDate}
        ,#{offShelfPhoneDate}
        ,#{onShelfAppDate}
        ,#{offShelfAppDate}
        ,#{onShelfSmsDate}
        ,#{offShelfSmsDate}
        ,#{freightSize}
        ,#{freightWeight}
        ,#{approveDifferent}
        ,#{currType}
        ,0
        ,#{createOper}
        ,now()
        ,#{modifyOper}
         ,now()
        ,#{onShelfTime}
        ,#{autoOffShelfTime})
    </insert>
     <update id="clearApproveDiff" parameterType="String">
         UPDATE   tbl_goods SET approve_different =NULL WHERE code=#{_para}
     </update>
    <update id="update" parameterType="GoodsModel">
        update tbl_goods set
        modify_time=now()
        <if test="ordertypeId !=null">,ordertype_id = #{ordertypeId}</if>
        <if test="name !=null">,name = #{name}</if>
        <if test="productId !=null">,product_id = #{productId}</if>
        <if test="createType !=null">,create_type = #{createType}</if>
        <if test="vendorId !=null">,vendor_id = #{vendorId}</if>
        <if test="manufacturer !=null">,manufacturer = #{manufacturer}</if>
        <if test="goodsBrandId !=null">,goods_brand_id = #{goodsBrandId}</if>
        <if test="goodsBrandName !=null">,goods_brand_name = #{goodsBrandName}</if>
        <if test="channelMall !=null">,channel_mall = #{channelMall}</if>
        <if test="channelCc !=null">,channel_cc = #{channelCc}</if>
        <if test="channelMallWx !=null">,channel_mall_wx = #{channelMallWx}</if>
        <if test="channelCreditWx !=null">,channel_credit_wx = #{channelCreditWx}</if>
        <if test="channelPhone !=null">,channel_phone = #{channelPhone}</if>
        <if test="channelApp !=null">,channel_app = #{channelApp}</if>
        <if test="channelSms !=null">,channel_sms = #{channelSms}</if>
        <if test="channelIvr !=null">,channel_ivr = #{channelIvr}</if>
        <if test="channelPoints !=null">,channel_points = #{channelPoints}</if>
        <if test="goodsType !=null">,goods_type = #{goodsType}</if>
        <if test="isInner !=null">,is_inner = #{isInner}</if>
        <if test="mailOrderCode !=null">,mail_order_code = #{mailOrderCode}</if>
        <if test="promotionTitle !=null">,promotion_title = #{promotionTitle}</if>
        <if test="adWord !=null">,ad_word = #{adWord}</if>
        <if test="keyword !=null">,keyword = #{keyword}</if>
        <if test="giftDesc !=null">,gift_desc = #{giftDesc}</if>
        <if test="introduction !=null">,introduction = #{introduction}</if>
        <if test="serviceType !=null">,service_type = #{serviceType}</if>
        <if test="recommendGoods1Code !=null">,recommend_goods1_code = #{recommendGoods1Code}</if>
        <if test="recommendGoods2Code !=null">,recommend_goods2_code = #{recommendGoods2Code}</if>
        <if test="recommendGoods3Code !=null">,recommend_goods3_code = #{recommendGoods3Code}</if>
        <if test="regionType !=null">,region_type = #{regionType}</if>
        <if test="approveStatus !=null">,approve_status = #{approveStatus}</if>
        <if test="limitCount !=null">,limit_count = #{limitCount}</if>
        <if test="pointsType !=null">,points_type = #{pointsType}</if>
        <if test="cards !=null">,cards = #{cards}</if>

        <if test="onShelfMallDate !=null">,on_shelf_mall_date = #{onShelfMallDate}</if>
        <if test="offShelfMallDate !=null">,off_shelf_mall_date = #{offShelfMallDate}</if>
        <if test="onShelfMallWxDate !=null">,on_shelf_mall_wx_date = #{onShelfMallWxDate}</if>
        <if test="offShelfMallWxDate !=null">,off_shelf_mall_wx_date = #{offShelfMallWxDate}</if>
        <if test="onShelfCreditWxDate !=null">,on_shelf_credit_wx_date = #{onShelfCreditWxDate}</if>
        <if test="offShelfCreditWxDate !=null">,off_shelf_credit_wx_date = #{offShelfCreditWxDate}</if>
        <if test="onShelfAppDate !=null">,on_shelf_app_date = #{onShelfAppDate}</if>
        <if test="offShelfAppDate !=null">,off_shelf_app_date = #{offShelfAppDate}</if>

        <if test="onShelfPhoneDate !=null">,on_shelf_phone_date = #{onShelfPhoneDate}</if>
        <if test="offShelfPhoneDate !=null">,off_shelf_phone_date = #{offShelfPhoneDate}</if>
        <if test="onShelfSmsDate !=null">,on_shelf_sms_date = #{onShelfSmsDate}</if>
        <if test="offShelfSmsDate !=null">,off_shelf_sms_date = #{offShelfSmsDate}</if>
        <if test="onShelfCcDate !=null">,on_shelf_cc_date = #{onShelfCcDate}</if>
        <if test="offShelfCcDate !=null">,off_shelf_cc_date = #{offShelfCcDate}</if>

        <if test="onShelfPointsDate !=null">,on_shelf_points_date = #{onShelfPointsDate}</if>
        <if test="offShelfPointsDate !=null">,off_shelf_points_date = #{offShelfPointsDate}</if>
        <if test="onShelfIvrDate !=null">,on_shelf_ivr_date =#{onShelfIvrDate}</if>
        <if test="offShelfIvrDate !=null">,off_shelf_ivr_date = #{offShelfIvrDate}</if>

        <if test="freightSize !=null">,freight_size = #{freightSize}</if>
        <if test="freightWeight !=null">,freight_weight = #{freightWeight}</if>
        <if test="approveDifferent !=null">,approve_different = #{approveDifferent}</if>
        <if test="currType !=null">,curr_type = #{currType}</if>
        <if test="delFlag !=null">,del_flag = #{delFlag}</if>
        <if test="createOper !=null">,create_oper = #{createOper}</if>
        <if test="createTime !=null">,create_time = now()</if>
        <if test="modifyOper !=null">,modify_oper = #{modifyOper}</if>
        <if test="modifyTime !=null">,modify_time = now()</if>
        <if test="onShelfTime !=null">,on_shelf_time = #{onShelfTime}</if>
        <if test="autoOffShelfTime !=null">,auto_off_shelf_time = #{autoOffShelfTime}</if>
        where code = #{code}
    </update>

    <sql id="conditions">
        <where>
            <if test="code !=null">and code = #{code}</if>
            <if test="ordertypeId !=null">and ordertype_id = #{ordertypeId}</if>
            <if test="name !=null">and name = #{name}</if>
            <if test="nameLike !=null">and name LIKE concat(concat('%',#{nameLike}),'%')</if>
            <if test="productId !=null">and product_id = #{productId}</if>
            <if test="createType !=null">and create_type = #{createType}</if>
            <if test="vendorId !=null">and vendor_id = #{vendorId}</if>
            <if test="manufacturer !=null">and manufacturer = #{manufacturer}</if>
            <if test="goodsBrandId !=null">and goods_brand_id = #{goodsBrandId}</if>
            <if test="goodsBrandName !=null">and goods_brand_name = #{goodsBrandName}</if>
            <if test="channelMall !=null">and channel_mall = #{channelMall}</if>
            <if test="channelCc !=null">and channel_cc = #{channelCc}</if>
            <if test="channelMallWx !=null">and channel_mall_wx = #{channelMallWx}</if>
            <if test="channelCreditWx !=null">and channel_credit_wx = #{channelCreditWx}</if>
            <if test="channelPhone !=null">and channel_phone = #{channelPhone}</if>
            <if test="channelApp !=null">and channel_app = #{channelApp}</if>
            <if test="channelSms !=null">and channel_sms = #{channelSms}</if>
            <if test="channelPoints !=null">,channel_points = #{channelPoints}</if>
            <if test="channelIvr !=null">,channel_ivr = #{channelIvr}</if>
            <if test="goodsType !=null">and goods_type = #{goodsType}</if>
            <if test="isInner !=null">and is_inner = #{isInner}</if>
            <if test="mailOrderCode !=null">and mail_order_code = #{mailOrderCode}</if>
            <if test="promotionTitle !=null">and promotion_title = #{promotionTitle}</if>
            <if test="adWord !=null">and ad_word = #{adWord}</if>
            <if test="keyword !=null">and keyword = #{keyword}</if>
            <if test="giftDesc !=null">and gift_desc = #{giftDesc}</if>
            <if test="introduction !=null">and introduction = #{introduction}</if>
            <if test="serviceType !=null">and service_type = #{serviceType}</if>
            <if test="recommendGoods1Code !=null">and recommend_goods1_code = #{recommendGoods1Code}</if>
            <if test="recommendGoods2Code !=null">and recommend_goods2_code = #{recommendGoods2Code}</if>
            <if test="recommendGoods3Code !=null">and recommend_goods3_code = #{recommendGoods3Code}</if>
            <if test="regionType !=null">and region_type = #{regionType}</if>
            <if test="approveStatus !=null">and approve_status = #{approveStatus}</if>
            <if test="limitCount !=null">and limit_count = #{limitCount}</if>
            <if test="pointsType !=null">and points_type = #{pointsType}</if>
            <if test="cards !=null">and cards = #{cards}</if>
            <if test="onShelfMallDate !=null">and on_shelf_mall_date = #{onShelfMallDate}</if>
            <if test="offShelfMallDate !=null">and off_shelf_mall_date = #{offShelfMallDate}</if>
            <if test="onShelfCcDate !=null">and on_shelf_cc_date = #{onShelfCcDate}</if>
            <if test="offShelfCcDate !=null">and off_shelf_cc_date = #{offShelfCcDate}</if>
            <if test="onShelfMallWxDate !=null">and on_shelf_mall_wx_date = #{onShelfMallWxDate}</if>
            <if test="offShelfMallWxDate !=null">and off_shelf_mall_wx_date = #{offShelfMallWxDate}</if>
            <if test="onShelfCreditWxDate !=null">and on_shelf_credit_wx_date = #{onShelfCreditWxDate}</if>
            <if test="offShelfCreditWxDate !=null">and off_shelf_credit_wx_date = #{offShelfCreditWxDate}</if>
            <if test="onShelfPhoneDate !=null">and on_shelf_phone_date = #{onShelfPhoneDate}</if>
            <if test="offShelfPhoneDate !=null">and off_shelf_phone_date = #{offShelfPhoneDate}</if>
            <if test="onShelfAppDate !=null">and on_shelf_app_date = #{onShelfAppDate}</if>
            <if test="offShelfAppDate !=null">and off_shelf_app_date = #{offShelfAppDate}</if>
            <if test="onShelfSmsDate !=null">and on_shelf_sms_date = #{onShelfSmsDate}</if>
            <if test="offShelfSmsDate !=null">and off_shelf_sms_date = #{offShelfSmsDate}</if>
            <if test="freightSize !=null">and freight_size = #{freightSize}</if>
            <if test="freightWeight !=null">and freight_weight = #{freightWeight}</if>
            <if test="approveDifferent !=null">and approve_different = #{approveDifferent}</if>
            <if test="currType !=null">and curr_type = #{currType}</if>
            <if test="delFlag !=null">and del_flag = #{delFlag}</if>
            <if test="createOper !=null">and create_oper = #{createOper}</if>
            <if test="createTime !=null">and create_time = #{createTime}</if>
            <if test="modifyOper !=null">and modify_oper = #{modifyOper}</if>
            <if test="modifyTime !=null">and modify_time = #{modifyTime}</if>
            <if test="onShelfTime !=null">and on_shelf_time = #{onShelfTime}</if>
            <if test="autoOffShelfTime !=null">and auto_off_shelf_time = #{autoOffShelfTime}</if>
        </where>
    </sql>

    <!--by yuxinxin-->
    <sql id="conditionsLike">
        <where>
            <if test="searchKey !=null and searchKey!=''">(code like concat(concat('%',#{searchKey}),'%') or name like concat(concat('%',#{searchKey}),'%'))</if>
            <if test="code !=null">and code = #{code}</if>
            <if test="ordertypeId !=null">and ordertype_id = #{ordertypeId}</if>
            <if test="name !=null">and name = #{name}</if>
            <if test="nameLike !=null">and name LIKE concat(concat('%',#{nameLike}),'%')</if>
            <if test="productId !=null">and product_id = #{productId}</if>
            <if test="createType !=null">and create_type = #{createType}</if>
            <if test="vendorId !=null">and vendor_id = #{vendorId}</if>
            <if test="manufacturer !=null">and manufacturer = #{manufacturer}</if>
            <if test="goodsBrandId !=null">and goods_brand_id = #{goodsBrandId}</if>
            <if test="channelMall !=null">and channel_mall = #{channelMall}</if>
            <if test="channelCc !=null">and channel_cc = #{channelCc}</if>
            <if test="channelIvr !=null">and channel_ivr = #{channelIvr}</if>
            <if test="channelMallWx !=null">and channel_mall_wx = #{channelMallWx}</if>
            <if test="channelCreditWx !=null">and channel_credit_wx = #{channelCreditWx}</if>
            <if test="channelPhone !=null">and channel_phone = #{channelPhone}</if>
            <if test="channelApp !=null">and channel_app = #{channelApp}</if>
            <if test="channelSms !=null">and channel_sms = #{channelSms}</if>
            <if test="goodsType !=null">and goods_type = #{goodsType}</if>
            <if test="isInner !=null">and is_inner = #{isInner}</if>
            <if test="mailOrderCode !=null">and mail_order_code = #{mailOrderCode}</if>
            <if test="promotionTitle !=null">and promotion_title = #{promotionTitle}</if>
            <if test="adWord !=null">and ad_word = #{adWord}</if>
            <if test="keyword !=null">and keyword = #{keyword}</if>
            <if test="giftDesc !=null">and gift_desc = #{giftDesc}</if>
            <if test="introduction !=null">and introduction = #{introduction}</if>
            <if test="serviceType !=null">and service_type = #{serviceType}</if>
            <if test="recommendGoods1Code !=null">and recommend_goods1_code = #{recommendGoods1Code}</if>
            <if test="recommendGoods2Code !=null">and recommend_goods2_code = #{recommendGoods2Code}</if>
            <if test="recommendGoods3Code !=null">and recommend_goods3_code = #{recommendGoods3Code}</if>
            <if test="regionType !=null">and region_type = #{regionType}</if>
            <if test="approveStatus !=null">and approve_status = #{approveStatus}</if>
            <if test="limitCount !=null">and limit_count = #{limitCount}</if>
            <if test="pointsType !=null">and points_type = #{pointsType}</if>
            <if test="cards !=null">and cards = #{cards}</if>
            <if test="onShelfMallDate !=null">and on_shelf_mall_date = #{onShelfMallDate}</if>
            <if test="offShelfMallDate !=null">and off_shelf_mall_date = #{offShelfMallDate}</if>
            <if test="onShelfCcDate !=null">and on_shelf_cc_date = #{onShelfCcDate}</if>
            <if test="offShelfCcDate !=null">and off_shelf_cc_date = #{offShelfCcDate}</if>
            <if test="onShelfMallWxDate !=null">and on_shelf_mall_wx_date = #{onShelfMallWxDate}</if>
            <if test="offShelfMallWxDate !=null">and off_shelf_mall_wx_date = #{offShelfMallWxDate}</if>
            <if test="onShelfCreditWxDate !=null">and on_shelf_credit_wx_date = #{onShelfCreditWxDate}</if>
            <if test="offShelfCreditWxDate !=null">and off_shelf_credit_wx_date = #{offShelfCreditWxDate}</if>
            <if test="onShelfPhoneDate !=null">and on_shelf_phone_date = #{onShelfPhoneDate}</if>
            <if test="offShelfPhoneDate !=null">and off_shelf_phone_date = #{offShelfPhoneDate}</if>
            <if test="onShelfAppDate !=null">and on_shelf_app_date = #{onShelfAppDate}</if>
            <if test="offShelfAppDate !=null">and off_shelf_app_date = #{offShelfAppDate}</if>
            <if test="onShelfSmsDate !=null">and on_shelf_sms_date = #{onShelfSmsDate}</if>
            <if test="offShelfSmsDate !=null">and off_shelf_sms_date = #{offShelfSmsDate}</if>
            <if test="freightSize !=null">and freight_size = #{freightSize}</if>
            <if test="freightWeight !=null">and freight_weight = #{freightWeight}</if>
            <if test="approveDifferent !=null">and approve_different = #{approveDifferent}</if>
            <if test="currType !=null">and curr_type = #{currType}</if>
            <if test="delFlag !=null">and del_flag = #{delFlag}</if>
            <if test="createOper !=null">and create_oper = #{createOper}</if>
            <if test="createTime !=null">and create_time = #{createTime}</if>
            <if test="modifyOper !=null">and modify_oper = #{modifyOper}</if>
            <if test="modifyTime !=null">and modify_time = #{modifyTime}</if>
            <if test="onShelfTime !=null">and on_shelf_time = #{onShelfTime}</if>
        </where>
    </sql>

    <select id="findById" parameterType="Map" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        from tbl_goods
        where code=#{code}
    </select>

    <select id="findAll" parameterType="Map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        <include refid="conditionsLike"/>
         limit 100
    </select>

	<select id="findAllByCC" parameterType="Map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        <include refid="conditionsLike"/>
    </select>
    
    <!--商品列表查询条件 add by chenle-->
    <sql id="pageCondition">
        <where>
            del_flag = 0
            <if test="type !=null and type== 1">
                AND approve_status in (00,01,02,03,04,05,06,07,08,70,71,72,73,74,75)
            </if>
            <if test="type !=null and type== 2">
                AND approve_status in(00,70,71)
            </if>
            <if test="type !=null and type== 3">
                AND approve_status = 01
            </if>
            <if test="type !=null and type== 4">
                AND approve_status = 02
            </if>
            <if test="type !=null and type== 5">
                AND (channel_mall = 01 OR channel_cc = 01 OR channel_mall_wx = 01 OR channel_credit_wx = 01 OR
                channel_phone = 01
                OR channel_app = 01 OR channel_sms = 01 OR channel_points = 01 OR channel_ivr = 01)
            </if>
            <if test="type !=null and type== 6">
                AND (channel_mall = 02 OR channel_cc = 02 OR channel_mall_wx = 02 OR channel_credit_wx = 02 OR
                channel_phone = 02
                OR channel_app = 02 OR channel_sms = 02 OR channel_points = 02 OR channel_ivr = 02)
            </if>
            <if test="type !=null and type== 7">
                AND approve_status = 05
            </if>
            <if test="type !=null and type== 8">
                AND approve_status in (03,04)
            </if>
            <if test="type !=null and type== 9">
                AND approve_status in (01,02,03,05,07,08)
            </if>
            <if test="type !=null and type== 10">
                AND approve_status in (70,71,72,73,74,75)
            </if>
            <if test="type !=null and type== 11">
                AND approve_status = 07
            </if>
            <if test="type !=null and type== 12">
                AND approve_status = 08
            </if>
            <if test="code !=null">
                AND code = #{code}
            </if>
            <if test="name !=null">
                AND name LIKE concat(concat('%',#{name}),'%')
            </if>
            <if test="channelMall !=null">
                AND channel_mall = #{channelMall}
            </if>
            <if test="channelCc !=null ">
                AND channel_cc = #{channelCc}
            </if>
            <if test="channelMallWx !=null">
                AND channel_mall_wx = #{channelMallWx}
            </if>
            <if test="channelState !=null">
                AND (channel_mall_wx ='02' OR channel_credit_wx ='02')
            </if>
            <if test="channelCreditWx !=null">
                AND channel_credit_wx = #{channelCreditWx}
            </if>
            <if test="channelPhone !=null">
                AND channel_phone = #{channelPhone}
            </if>
            <if test="channelApp !=null">
                AND channel_app = #{channelApp}
            </if>
            <if test="channelSms !=null">
                AND channel_sms = #{channelSms}
            </if>
            <if test="channelPoints !=null ">
                AND channel_points = #{channelPoints}
            </if>
            <if test="channelIVR !=null ">
                AND channel_IVR = #{channelIVR}
            </if>
            <if test="approveStatus !=null">
                AND approve_status = #{approveStatus}
            </if>
            <if test="ordertypeId !=null">
                AND ordertype_id = #{ordertypeId}
            </if>
            <if test="brandId !=null">
                and goods_brand_id = #{brandId}
            </if>
            <if test="vendorId !=null">
                and vendor_id = #{vendorId}
            </if>
            <if test="brandName !=null">
                AND goods_brand_name LIKE concat(concat('%',#{brandName}),'%')
            </if>
            <!--<if test="brandIds !=null">-->
                <!--and goods_brand_id in-->
                <!--<foreach collection="brandIds" item="item" index="index" open="(" separator="," close=")">-->
                    <!--#{item}-->
                <!--</foreach>-->
            <!--</if>-->
            <if test="vendorIds !=null">
                and vendor_id in
                <foreach collection="vendorIds" item="item" index="index" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>
            <if test="regionType !=null">
                and region_type = #{regionType}
            </if>
            <if test="autoStartShelfTime !=null">
                and <![CDATA[ auto_off_shelf_time >= #{autoStartShelfTime} ]]>
            </if>
            <if test="autoEndShelfTime !=null">
                and <![CDATA[ auto_off_shelf_time <= #{autoEndShelfTime} ]]>
            </if>
            <if test="codes !=null"><!--根据 codes 查询 商品 -->
                and code in
                <foreach collection="codes" item="item" index="index" open="(" separator="," close=")">
                  #{item}
                </foreach>
            </if>
            <if test="productIds !=null"><!--根据 productIds 查询 商品 -->
                AND product_id IN
                <foreach collection="productIds" item="item" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>
            <if test="goodsType !=null">
                and goods_type in ('00','02')
            </if>
        </where>
    </sql>

    <!--分页时用的总数-->
    <select id="pageCount" resultType="Long">
        select count(1)
        from tbl_goods
        <include refid="pageCondition"/>
    </select>

    <select id="pager" parameterType="Map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        <include refid="pageCondition"/>
        <![CDATA[ order by modify_time desc limit #{offset}, #{limit} ]]>
    </select>

    <delete id="delete" parameterType="GoodsModel">
        delete from tbl_goods where id = code
    </delete>

    <!--总数count-->
    <select id="count" resultType="Long">
        select count(1)
        from tbl_goods
        WHERE
        <include refid="conditions"/>
    </select>

    <select id="findGoodsCount" parameterType="Map" resultMap="GoodsMap">
        select count(1) as eachCount,approve_status
        from tbl_goods
        where del_flag=0
        <if test="vendorId != null and vendorId != ''">
            and vendor_id = #{vendorId}
        </if>
        <if test="ordertypeId != null and ordertypeId != ''">
            and ordertype_id = #{ordertypeId}
        </if>
        GROUP BY approve_status
    </select>

    <!--查找上架商品数量-->
    <select id="findUpShelfGoodsCount" parameterType="Map" resultType="Integer">
        SELECT count(1) FROM tbl_goods
        WHERE del_flag = 0
        AND (channel_mall = 02 OR channel_cc = 02 OR channel_mall_wx = 02 OR channel_credit_wx = 02 OR
        channel_phone = 02
        OR channel_app = 02 OR channel_sms = 02 or channel_points= 02 or channel_ivr = 02)
        <if test="vendorId != null and vendorId != ''">
            and vendor_id = #{vendorId}
        </if>
        <if test="ordertypeId != null and ordertypeId != ''">
            and ordertype_id = #{ordertypeId}
        </if>
    </select>

    <!--查找下架商品数量-->
    <select id="findDownShelfGoodsCount" parameterType="Map" resultType="Integer">
        SELECT count(1) FROM tbl_goods
        WHERE del_flag = 0
        AND (channel_mall = 01 OR channel_cc = 01 OR channel_mall_wx = 01 OR channel_credit_wx = 01 OR
        channel_phone = 01
        OR channel_app = 01 OR channel_sms = 01 OR channel_points= 01 or channel_ivr = 01)
        <if test="vendorId != null and vendorId != ''">
            and vendor_id = #{vendorId}
        </if>
        <if test="ordertypeId != null and ordertypeId != ''">
            and ordertype_id = #{ordertypeId}
        </if>
    </select>



    <!-- 根据code模糊查询 -->
    <select id="findGoodsByGoodsName" parameterType="String" resultType="String">
        SELECT code
        FROM tbl_goods
        WHERE name LIKE concat(concat('%',#{goodsName}),'%')
        AND del_flag=0
        AND ordertype_id = 'YG'
    </select>

    <!--<select id="getGoodsNameByItemId" parameterType="java.util.List" resultMap="GoodsMap">-->
        <!--select-->
        <!--<include refid="columns"/>-->
        <!--from tbl_goods-->
        <!--where code IN-->
        <!--<foreach collection="list" item="item" index="index" open="(" separator="," close=")">-->
            <!--#{item.goodsCode}-->
        <!--</foreach>-->
    <!--</select>-->

    <!--批量更新商品状态 add by chenle-->
    <update id="updateAllGoodsStatus" parameterType="java.util.List">
        <foreach collection="list" item="item" index="index">
            update tbl_goods set
            modify_time=now()
            <!--modify_oper = #{item.modifyOper}-->
            <!--<if test="item.approveStatus == '01'">-->
            <!--,approve_status = '02'-->
            <!--</if>-->
            where `code` = #{item.code};
        </foreach>
    </update>

    <select id="findByCodes" parameterType="java.util.List" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where code IN
        <foreach collection="list" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
        ORDER BY code
    </select>

    <!-- 获取当前供应商下可用商品codeList -->
    <select id="findGoodsInVendor" parameterType="Map" resultType="String">
        SELECT code
        FROM tbl_goods
        WHERE
        del_flag = 0
        and vendor_id = #{vendorId}
        and channel_mall = #{channelMall}
        and goods_type IN ('00','02')
        <if test="name !=null">and name like concat(concat('%',#{name}),'%')</if>
    </select>

    <!-- 根据类目，商品名称模糊查询商品  edit by zhoupeng-->
    <select id="findGoodsInfoByNameAndSpuIds" parameterType="Map" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        FROM tbl_goods
        WHERE
        del_flag=0
        <if test="name !=null">AND name LIKE concat(concat('%',#{name}),'%')</if>
        <if test="productIds !=null">
            AND product_id IN
            <foreach collection="productIds" item="item" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        <if test="ordertypeId !=null">AND ordertype_id=#{ordertypeId}</if>
        <if test="isInner !=null">AND is_inner=#{isInner}</if>
        <if test="channelApp !=null or channelPhone !=null or channelMallWx !=null or channelMall !=null ">
            AND (
                channel_mall='02'
                <if test="channelApp !=null">OR channel_app=#{channelApp}</if>
                <if test="channelPhone !=null">OR channel_phone=#{channelPhone}</if>
                <if test="channelMallWx !=null">OR channel_mall_wx=#{channelMallWx}</if>
            )
        </if>
        limit 100
    </select>

    <!-- 根据产品id查询商品（产品用） add by tanliang-->
    <select id="findGoodsByProductId" parameterType="Long" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        FROM tbl_goods
        WHERE product_id = #{productId}
        AND del_flag=0
    </select>

    <!-- 根据类目，商品名称模糊查询商品  add by liuhan-->
    <select id="findGoodsListByGoodsNameLikeForProm" parameterType="Map" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        FROM tbl_goods
        WHERE del_flag=0 and channel_mall='02'
        and approve_status in('06','72','73','74')
        <if test="name !=null">and name LIKE concat(concat('%',#{name}),'%')</if>
        <if test="productId !=null">and product_id IN ( #{productId} )</if>
        <if test="brandIds !=null">and goods_brand_id IN ( #{brandIds} )</if>
        <if test="vendorIds !=null">and vendor_id IN ( #{vendorIds} )</if>
        <if test="ordertypeId !=null">and ordertype_id IN ( #{ordertypeId} )</if>
        <if test="count !=null"><![CDATA[ ORDER BY modify_time DESC limit 0, #{count} ]]></if>
    </select>
    <select id="findGiftByCodes" parameterType="java.util.List" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where code IN
        <foreach collection="list" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
        AND channel_points='02'
    </select>

    <select id="findGoodsByGoodsCode" parameterType="String" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where
        ordertype_id = 'YG'
        and
        channel_cc ='02'    
        and
        del_flag!=1
        and
        code=#{goodsCode}
    </select>

    <select id="findOnSaleGoodsByCode" parameterType="java.util.List" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where code IN
        <foreach collection="list" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
        AND channel_ivr='02'
        <![CDATA[ AND on_shelf_ivr_date <= now() and auto_off_shelf_time >=now()]]>
    </select>

    <select id="findOnSaleSPGoodsByBrand" parameterType="map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where ordertype_id='YG'
        and del_flag=0
        <if test="channelApp != null">and channel_app=#{channelApp}</if>
        <if test="channelPhone != null">and channel_phone=#{channelPhone}</if>
        <if test="channelMallWX != null">and channel_mall_wx=#{channelMallWX}</if>
        <if test="channelCreditWX != null">and channel_credit_wx=#{channelCreditWX}</if>
        <if test="goodsBrandId != null">and goods_brand_id=#{goodsBrandId}</if>
    </select>

    <select id="findOnSaleSPGoodsByIds" parameterType="map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where ordertype_id='YG'
        and del_flag=0
        and code IN
        <foreach collection="goodsCodes" item="goodsCode" open="(" separator="," close=")">
            #{goodsCode}
        </foreach>
        <if test="channelApp != null">and channel_app=#{channelApp}</if>
        <if test="channelPhone != null">and channel_phone=#{channelPhone}</if>
        <if test="channelMallWX != null">and channel_mall_wx=#{channelMallWX}</if>
        <if test="channelCreditWX != null">and channel_credit_wx=#{channelCreditWX}</if>
    </select>

    <!--判断分区下是否有礼品 add by tongxueying-->
    <select id="checkUsedPartition" parameterType="String" resultType="Long">
        select count(1)
        from tbl_goods
        where region_type= #{code}
    </select>

    <!--<select id="findGoodsListByConditions" parameterType="Map" resultMap="GoodsMap">-->
        <!--select-->
        <!--<include refid="columns"/>-->
        <!--from tbl_goods-->
        <!--<include refid="pageCondition"/>-->
    <!--</select>-->


    <!--&lt;!&ndash;礼品管理查询&ndash;&gt;-->
    <!--<select id="presentCount" resultType="Long">-->
        <!--select count(*)-->
        <!--from tbl_goods-->
        <!--<include refid="presentCondition"/>-->
    <!--</select>-->

    <!--<select id="presentPager" parameterType="Map" resultMap="GoodsMap">-->
        <!--select-->
        <!--<include refid="columns"/>-->
        <!--from tbl_goods-->
        <!--<include refid="presentCondition"/>-->
        <!--<![CDATA[ order by modify_time desc limit #{offset}, #{limit} ]]>-->
    <!--</select>-->

    <!--<sql id="presentCondition">-->
        <!--<where>-->
            <!--del_flag = 0-->
            <!--and ordertype_id = "JF"-->
            <!--&lt;!&ndash;所有礼品&ndash;&gt;-->
            <!--<if test="type !=null and type== 1">-->
                <!--AND approve_status in (00,01,02,03,04,05,06,07,08,70,71,72,73,74,75)-->
            <!--</if>-->
            <!--&lt;!&ndash;编辑中&ndash;&gt;-->
            <!--<if test="type !=null and type== 2">-->
                <!--AND approve_status = 00-->
            <!--</if>-->
            <!--&lt;!&ndash;待初审&ndash;&gt;-->
            <!--<if test="type !=null and type== 3">-->
                <!--AND approve_status = 01-->
            <!--</if>-->
            <!--&lt;!&ndash;待复审&ndash;&gt;-->
            <!--<if test="type !=null and type== 4">-->
                <!--AND approve_status = 02-->
            <!--</if>-->
            <!--&lt;!&ndash;上架&ndash;&gt;-->
            <!--<if test="type !=null and type== 5">-->
                <!--AND (channel_phone = 01 OR channel_cc = 01 OR channel_points = 01 OR channel_ivr = 01 OR channel_sms =-->
                <!--01)-->
            <!--</if>-->
            <!--&lt;!&ndash;在售信息&ndash;&gt;-->
            <!--<if test="type !=null and type== 6">-->
                <!--AND (channel_phone = 02 OR channel_cc = 02 OR channel_points = 02 OR channel_ivr = 02 OR channel_sms =-->
                <!--02)-->
            <!--</if>-->
            <!--&lt;!&ndash;下架审核&ndash;&gt;-->
            <!--<if test="type !=null and type== 7">-->
                <!--AND approve_status = 05-->
            <!--</if>-->
            <!--&lt;!&ndash;变更审核&ndash;&gt;-->
            <!--<if test="type !=null and type== 8">-->
                <!--AND approve_status in (03,04)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 9">-->
                <!--AND approve_status = 07-->
            <!--</if>-->
            <!--<if test="type !=null and type== 10">-->
                <!--AND approve_status = 08-->
            <!--</if>-->
            <!--&lt;!&ndash;礼品编码&ndash;&gt;-->
            <!--<if test="code !=null">-->
                <!--AND code = #{code}-->
            <!--</if>-->
            <!--&lt;!&ndash;供应商名称&ndash;&gt;-->
            <!--<if test="vendorIds !=null">-->
                <!--and vendor_id in-->
                <!--<foreach collection="vendorIds" item="item" index="index" open="(" separator="," close=")">-->
                    <!--#{item}-->
                <!--</foreach>-->
            <!--</if>-->
            <!--&lt;!&ndash;礼品名称&ndash;&gt;-->
            <!--<if test="name !=null">-->
                <!--AND name LIKE concat(concat('%',#{name}),'%')-->
            <!--</if>-->
            <!--&lt;!&ndash;品牌&ndash;&gt;-->
            <!--<if test="brandIds !=null">-->
                <!--and goods_brand_id in-->
                <!--<foreach collection="brandIds" item="item" index="index" open="(" separator="," close=")">-->
                    <!--#{item}-->
                <!--</foreach>-->
            <!--</if>-->
            <!--&lt;!&ndash;后台类目&ndash;&gt;-->
            <!--<if test="backCategoryId1 !=null">-->
                <!--and back_category1_id = #{backCategoryId1}-->
            <!--</if>-->
            <!--<if test="backCategoryId2 !=null">-->
                <!--and back_category2_id = #{backCategoryId2}-->
            <!--</if>-->
            <!--<if test="backCategoryId3 !=null">-->
                <!--and back_category3_id = #{backCategoryId3}-->
            <!--</if>-->
            <!--&lt;!&ndash;审核状态&ndash;&gt;-->
            <!--<if test="approveStatus !=null">-->
                <!--AND approve_status = #{approveStatus}-->
            <!--</if>-->
            <!--&lt;!&ndash;积分商城&ndash;&gt;-->
            <!--<if test="channelPoints !=null ">-->
                <!--AND channel_points = #{channelPoints}-->
            <!--</if>-->
            <!--&lt;!&ndash;CC状态&ndash;&gt;-->
            <!--<if test="channelCc !=null ">-->
                <!--AND channel_cc = #{channelCc}-->
            <!--</if>-->
            <!--&lt;!&ndash;手机商城状态&ndash;&gt;-->
            <!--<if test="channelPhone !=null">-->
                <!--AND channel_phone = #{channelPhone}-->
            <!--</if>-->
            <!--&lt;!&ndash;IVR&ndash;&gt;-->
            <!--<if test="channelIVR !=null ">-->
                <!--AND channel_IVR = #{channelIVR}-->
            <!--</if>-->
            <!--&lt;!&ndash; 短信状态&ndash;&gt;-->
            <!--<if test="channelSms !=null">-->
                <!--AND channel_sms = #{channelSms}-->
            <!--</if>-->
            <!--&lt;!&ndash;供应商&ndash;&gt;-->
            <!--<if test="vendorId !=null">-->
                <!--and vendor_id = #{vendorId}-->
            <!--</if>-->
        <!--</where>-->
    <!--</sql>-->


    <!--<insert id="insertPresent" useGeneratedKeys="true" keyProperty="code" keyColumn="code">-->
        <!--insert into tbl_goods-->
        <!--(code-->
        <!--,ordertype_id-->
        <!--,name-->
        <!--,product_id-->
        <!--,create_type-->
        <!--,vendor_id-->
        <!--,manufacturer-->
        <!--,goods_brand_id-->
        <!--,goods_brand_name-->
        <!--,channel_points-->
        <!--,channel_cc-->
        <!--,channel_phone-->
        <!--,channel_sms-->
        <!--,channel_ivr-->
        <!--,goods_type-->
        <!--,is_inner-->
        <!--,mail_order_code-->
        <!--,promotion_title-->
        <!--,ad_word-->
        <!--,keyword-->
        <!--,gift_desc-->
        <!--,introduction-->
        <!--,service_type-->
        <!--,recommend_goods1_code-->
        <!--,recommend_goods2_code-->
        <!--,recommend_goods3_code-->
        <!--,region_type-->
        <!--,approve_status-->
        <!--,limit_count-->
        <!--,points_type-->
        <!--,cards-->
        <!--,card_level_id-->
        <!--,approve_different-->
        <!--,del_flag-->
        <!--,create_oper-->
        <!--,create_time-->
        <!--,modify_oper-->
        <!--,modify_time-->
        <!--,auto_off_shelf_time)-->
        <!--values(-->
        <!--#{goodsCode}-->
        <!--,#{orderTypeId}-->
        <!--,#{presentName}-->
        <!--,#{productId}-->
        <!--,#{createType}-->
        <!--,#{vendorId}-->
        <!--,#{manufacturer}-->
        <!--,#{goodsBrandId}-->
        <!--,#{goodsBrandName}-->
        <!--,#{channelPoints}-->
        <!--,#{channelCc}-->
        <!--,#{channelPhone}-->
        <!--,#{channelSms}-->
        <!--,#{channelIvr}-->
        <!--,#{localOrder}-->
        <!--,#{isInner}-->
        <!--,#{mailOrderCode}-->
        <!--,#{promotionTitle}-->
        <!--,#{adWord}-->
        <!--,#{keyword}-->
        <!--,#{giftDesc}-->
        <!--,#{editorValue}-->
        <!--,#{serviceType}-->
        <!--,#{recommendGoods1Code}-->
        <!--,#{recommendGoods2Code}-->
        <!--,#{recommendGoods3Code}-->
        <!--,#{areaId}-->
        <!--,#{approveStatus}-->
        <!--,#{monthLimited}-->
        <!--,#{pointsType}-->
        <!--,#{cards}-->
        <!--,#{cardsLevel}-->
        <!--,#{approveDifferent}-->
        <!--,0-->
        <!--,#{createOper}-->
        <!--,now()-->
        <!--,#{modifyOper}-->
        <!--,now()-->
        <!--,#{autoOffShelfTime})-->
    <!--</insert>-->

    <select id="findAllWxGoods" parameterType="Map" resultMap="GoodsMap">
        select
        code,name,vendor_id,channel_mall_wx,channel_credit_wx
        from tbl_goods
        <include refid="pageCondition"/>
    </select>
    <!--通过品牌ID取出最新上架的十条商品code-->
    <select id="findGoodsCodeByBrandId" parameterType="String" resultType="String">
        SELECT
        code
        FROM tbl_goods
        where goods_brand_id =#{brandId}
        AND del_flag = 0
        ORDER BY on_shelf_mall_date
        DESC LIMIT 10
    </select>

    <!--&lt;!&ndash;=================================礼品区=================================&ndash;&gt;-->
    <!--&lt;!&ndash;礼品列表查询条件 add by zhoupeng&ndash;&gt;-->
    <!--<sql id="pageConditionByPointsPresent">-->
        <!--<where>-->
            <!--del_flag = 0-->
            <!--AND ordertype_id = 'JF'-->
            <!--&lt;!&ndash; 00编辑中 01待初审 02待复审-->
                 <!--03商品变更审核 04价格变更审核-->
                 <!--05下架申请审核 06审核通过 07待定价-->
                 <!--08定价审核 70初审拒绝 71复审拒绝-->
                 <!--72商品变更审核拒绝 73 价格变更审核拒绝-->
                 <!--74下架申请审核拒绝 75定价审核拒绝 &ndash;&gt;-->
            <!--<if test="type !=null and type== 1">&lt;!&ndash;所有礼品&ndash;&gt;-->
                <!--AND approve_status in (00,01,02,03,04,05,06,07,08,70,71,72,73,74,75)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 2">&lt;!&ndash;编辑中&ndash;&gt;-->
                <!--AND approve_status = 00-->
            <!--</if>-->
            <!--<if test="type !=null and type== 3">&lt;!&ndash;待初审&ndash;&gt;-->
                <!--AND approve_status = 01-->
            <!--</if>-->
            <!--<if test="type !=null and type== 4">&lt;!&ndash;待复审&ndash;&gt;-->
                <!--AND approve_status = 02-->
            <!--</if>-->
            <!--<if test="type !=null and type== 5">&lt;!&ndash;未上架&ndash;&gt;-->
                <!--AND (-->
                <!--channel_mall = 01 OR channel_cc = 01 OR channel_mall_wx = 01 OR channel_credit_wx = 01 OR-->
                <!--channel_phone = 01 OR channel_app = 01 OR channel_sms = 01 OR channel_points = 01 OR channel_ivr = 01-->
                <!--)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 6">&lt;!&ndash;在售商品&ndash;&gt;-->
                <!--AND (-->
                <!--channel_mall = 02 OR channel_cc = 02 OR channel_mall_wx = 02 OR channel_credit_wx = 02 OR-->
                <!--channel_phone = 02 OR channel_app = 02 OR channel_sms = 02 OR channel_points = 02 OR channel_ivr = 02-->
                <!--)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 7">&lt;!&ndash;下架审核&ndash;&gt;-->
                <!--AND approve_status = 05-->
            <!--</if>-->
            <!--<if test="type !=null and type== 8">&lt;!&ndash;变更审核&ndash;&gt;-->
                <!--AND approve_status in (03,04)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 9">&lt;!&ndash;待定价&ndash;&gt;-->
                <!--AND approve_status = 07-->
            <!--</if>-->
            <!--<if test="type !=null and type== 10">&lt;!&ndash;待定价审核&ndash;&gt;-->
                <!--AND approve_status = 08-->
            <!--</if>-->
            <!--<if test="type !=null and type==11">&lt;!&ndash;供应商平台所有礼品&ndash;&gt;-->
                <!--AND approve_status in-->
                <!--(00,01,02,03,04,05,06,07,08,70,71,72,73,74,75)-->
            <!--</if>-->
            <!--<if test="type !=null and type== 12">&lt;!&ndash;供应商平台在售的礼品&ndash;&gt;-->
                <!--AND (-->
                <!--channel_cc = 02 OR channel_phone = 02 OR channel_sms = 02 OR-->
                <!--channel_points = 02 OR channel_ivr = 02-->
                <!--)-->
            <!--</if>-->
            <!--<if test="type !=null and type==13">&lt;!&ndash;供应商平台审核中&ndash;&gt;-->
                <!--AND approve_status in (01,02,03,04,05,07,08)-->
            <!--</if>-->
            <!--<if test="type !=null and type==14">&lt;!&ndash;供应商平台待上架&ndash;&gt;-->
                <!--AND (-->
                <!--channel_cc = 01 OR channel_phone = 01 OR channel_sms = 01 OR-->
                <!--channel_points = 01 OR channel_ivr = 01-->
                <!--)-->
            <!--</if>-->
            <!--<if test="type !=null and type==15">&lt;!&ndash;供应商平台编辑中&ndash;&gt;-->
                <!--AND approve_status = 00-->
            <!--</if>-->
            <!--<if test="type !=null and type==16">&lt;!&ndash;供应商平台审核拒绝&ndash;&gt;-->
                <!--AND approve_status in (70,71,72,73,74,75)-->
            <!--</if>-->
            <!--<if test="code !=null">-->
                <!--AND code = #{code}-->
            <!--</if>-->
            <!--<if test="name !=null">&lt;!&ndash;礼品名称&ndash;&gt;-->
                <!--AND name LIKE concat(concat('%',#{name}),'%')-->
            <!--</if>-->
            <!--<if test="channelMall !=null">-->
                <!--AND channel_mall = #{channelMall}-->
            <!--</if>-->
            <!--<if test="channelCc !=null ">-->
                <!--AND channel_cc = #{channelCc}-->
            <!--</if>-->
            <!--<if test="channelMallWx !=null">-->
                <!--AND channel_mall_wx = #{channelMallWx}-->
            <!--</if>-->
            <!--&lt;!&ndash;<if test="channelState !=null ">&ndash;&gt;-->
            <!--&lt;!&ndash;AND (channel_mall_wx =02 OR channel_credit_wx =02)&ndash;&gt;-->
            <!--&lt;!&ndash;</if>&ndash;&gt;-->
            <!--&lt;!&ndash;<if test="channelCreditWx !=null">&ndash;&gt;-->
            <!--&lt;!&ndash;AND channel_credit_wx = #{channelCreditWx}&ndash;&gt;-->
            <!--&lt;!&ndash;</if>&ndash;&gt;-->
            <!--<if test="channelPoints !=null"> &lt;!&ndash;积分商城渠道&ndash;&gt;-->
                <!--AND channel_points = #{channelPoints}-->
            <!--</if>-->
            <!--<if test="channelCc !=null"> &lt;!&ndash;CC商城渠道&ndash;&gt;-->
                <!--AND channel_cc = #{channelCc}-->
            <!--</if>-->
            <!--<if test="channelPhone !=null"> &lt;!&ndash;手机商城渠道&ndash;&gt;-->
                <!--AND channel_phone = #{channelPhone}-->
            <!--</if>-->
            <!--<if test="channelIvr !=null"> &lt;!&ndash;IVR商城渠道&ndash;&gt;-->
                <!--AND channel_ivr = #{channelIvr}-->
            <!--</if>-->
            <!--<if test="channelSms !=null"> &lt;!&ndash;短信渠道&ndash;&gt;-->
                <!--AND channel_sms = #{channelSms}-->
            <!--</if>-->
            <!--<if test="approveStatus !=null"> &lt;!&ndash;审核状态&ndash;&gt;-->
                <!--AND approve_status = #{approveStatus}-->
            <!--</if>-->
            <!--<if test="brandIds !=null"> &lt;!&ndash;品牌&ndash;&gt;-->
                <!--and goods_brand_id in-->
                <!--<foreach collection="brandIds" item="item" index="index" open="(" separator="," close=")">-->
                    <!--#{item}-->
                <!--</foreach>-->
            <!--</if>-->
            <!--<if test="vendorIds !=null"> &lt;!&ndash;供应商&ndash;&gt;-->
                <!--and vendor_id in-->
                <!--<foreach collection="vendorIds" item="item" index="index" open="(" separator="," close=")">-->
                    <!--#{item}-->
                <!--</foreach>-->
            <!--</if>-->
            <!--<if test="backCategoryId1 !=null"> &lt;!&ndash;后台类目&ndash;&gt;-->
                <!--and back_category1_id = #{backCategoryId1}-->
            <!--</if>-->
            <!--<if test="backCategoryId2 !=null">-->
                <!--and back_category2_id = #{backCategoryId2}-->
            <!--</if>-->
            <!--<if test="backCategoryId3 !=null">-->
                <!--and back_category3_id = #{backCategoryId3}-->
            <!--</if>-->
            <!--<if test="vendorId !=null">-->
                <!--and vendor_id = #{vendorId}-->
            <!--</if>-->
            <!--&lt;!&ndash;自动下架时间&ndash;&gt;-->
            <!--<if test="autoStartShelfTime !=null">-->
                <!--and date_format(auto_off_shelf_time,'%Y-%m-%d') &gt;= date_format(#{autoStartShelfTime},'%Y-%m-%d')-->
            <!--</if>-->
            <!--<if test="autoEndShelfTime !=null">-->
                <!--and date_format(auto_off_shelf_time,'%Y-%m-%d') &lt;= date_format(#{autoEndShelfTime},'%Y-%m-%d')-->
            <!--</if>-->
            <!--<if test="regionType !=null">&lt;!&ndash;礼品分区&ndash;&gt;-->
                <!--and region_type = #{regionType}-->
            <!--</if>-->
        <!--</where>-->
    <!--</sql>-->
    <!--&lt;!&ndash;分页时用的总数&ndash;&gt;-->
    <!--<select id="pageCountByPointsPresent" resultType="Long">-->
        <!--select count(1)-->
        <!--from tbl_goods-->
        <!--<include refid="pageConditionByPointsPresent"/>-->
    <!--</select>-->

    <!--<select id="pagerByPointsPresent" parameterType="Map" resultMap="GoodsMap">-->
        <!--select-->
        <!--<include refid="columns"/>-->
        <!--from tbl_goods-->
        <!--<include refid="pageConditionByPointsPresent"/>-->
        <!--<![CDATA[ order by modify_time desc limit #{offset}, #{limit} ]]>-->
    <!--</select>-->
    <!--根据itemIdList查询商品List add by huangfuchangyu-->
    <select id="findGoodsListByItemCodeList" parameterType="java.util.List" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        FROM tbl_goods
        <where>
            ordertype_id ='JF'
            <if test="list !=null">
                and code IN
                <foreach collection="list" item="item" index="index" open="(" separator="," close=")">
                    #{item}
                </foreach>
            </if>
        </where>
    </select>
    <select id="findGoodsCountByVendorId" parameterType="Map" resultType="Integer">
        SELECT COUNT(1) FROM  tbl_goods
        WHERE vendor_id=#{vendorId} AND ordertype_id=#{ordertypeId} and del_flag=0
    </select>

    <!--<update id="updatePresent">-->
        <!--update tbl_goods set-->
        <!--modify_time=now()-->
        <!--<if test="presentName !=null">,name = #{presentName}</if>-->
        <!--<if test="manufacturer !=null">,manufacturer = #{manufacturer}</if>-->
        <!--<if test="areaId !=null">,region_type = #{areaId}</if>-->
        <!--<if test="monthLimited !=null">,limit_count = #{monthLimited}</if>-->
        <!--<if test="pointsType !=null">,points_type = #{pointsType}</if>-->
        <!--<if test="cards !=null">,cards = #{cards}</if>-->
        <!--<if test="cardsLevel !=null">,card_level_id = #{cardsLevel}</if>-->
        <!--<if test="adWord !=null">,ad_word = #{adWord}</if>-->
        <!--<if test="giftDesc !=null">,gift_desc = #{giftDesc}</if>-->
        <!--<if test="editorValue !=null">,introduction = #{editorValue}</if>-->
        <!--<if test="isInner !=null">,is_inner = #{isInner}</if>-->
        <!--<if test="autoOffShelfTime !=null">,auto_off_shelf_time = #{autoOffShelfTime}</if>-->
        <!--<if test="serviceType !=null">,service_type = #{serviceType}</if>-->
        <!--<if test="recommendGoods1Code !=null">,recommend_goods1_code = #{recommendGoods1Code}</if>-->
        <!--<if test="recommendGoods2Code !=null">,recommend_goods2_code = #{recommendGoods2Code}</if>-->
        <!--<if test="recommendGoods3Code !=null">,recommend_goods3_code = #{recommendGoods3Code}</if>-->
        <!--<if test="approveStatus !=null">,approve_status = #{approveStatus}</if>-->
        <!--<if test="approveDifferent !=null">,approve_different = #{approveDifferent}</if>-->
        <!--<if test="modifyOper !=null">,modify_oper = #{modifyOper}</if>-->
        <!--where code = #{goodsCode}-->
    <!--</update>-->

    <!--查询使用该品牌的数量-->
    <select id="findBrandCountByBrandId" parameterType="String"  resultType="Long">
        select count(1)
        from tbl_goods
        where del_flag = 0 and goods_brand_id = #{brandsId}
    </select>
    <!--根据业务类型Id取得符合条件的商品编码 edit by zhoupeng 检索 上架的商品-->
    <select id="findGoodsCodeByOrderTypeId" parameterType="Map" resultType="String">
        SELECT code
        FROM  tbl_goods
        where del_flag = 0
        and (
              channel_mall = 02 OR channel_cc = 02 OR channel_mall_wx = 02 OR channel_credit_wx = 02 OR
              channel_phone = 02  OR channel_app = 02 OR channel_sms = 02 or channel_points= 02 or channel_ivr = 02
        )
        and code IN
        <foreach collection="goodsCodeList" item="item" index="index" open="(" separator="," close=")">
            #{item}
        </foreach>
        AND ordertype_id = #{orderTypeId}
    </select>
    <!-- 根据code模糊查询 edit by zhoupeng 检索 上架的商品-->
    <select id="findGoodsByGoodsNameAndOrderType" parameterType="Map" resultType="String">
        SELECT code
        FROM tbl_goods
        WHERE name LIKE concat(concat('%',#{goodsName}),'%')
        AND (
              channel_mall = 02 OR channel_cc = 02 OR channel_mall_wx = 02 OR channel_credit_wx = 02 OR
              channel_phone = 02  OR channel_app = 02 OR channel_sms = 02 OR channel_points= 02 OR channel_ivr = 02
        )
        AND del_flag=0
        AND ordertype_id = #{orderTypeId}
    </select>

    <!--根据goodsCodes，查找信息-->
    <select id="findGoodsByIds" parameterType="Map" resultMap="GoodsMap">
        select
        <include refid="columns"/>
        from tbl_goods
        where del_flag=0
        <if test="isInner !=null">and is_inner=#{isInner}</if>
        <if test="ordertypeId != null">and ordertype_id=#{ordertypeId}</if>
        <if test="channelMallWX != null">and channel_mall_wx=#{channelMallWX}</if>
        <if test="channelCreditWX != null">and channel_credit_wx=#{channelCreditWX}</if>
        <if test="goodsName != null">and name LIKE concat(concat('%',#{goodsName}),'%')</if>
        <if test="list != null">
            and code in
            <foreach collection="list" item="item" open="(" separator="," close=")">
                #{item.goodsCode}
            </foreach>
        </if>
        <!--<if test="channelApp !=null or channelPhone !=null or channelMall !=null ">-->
            <!--AND (-->
            <!--channel_mall='02'-->
            <!--<if test="channelApp !=null">OR channel_app=#{channelApp}</if>-->
            <!--<if test="channelPhone !=null">OR channel_phone=#{channelPhone}</if>-->
            <!--)-->
        <!--</if>-->
    </select>
    <select id="findGoodsBySpu" parameterType="Long" resultType="Long">
        select count(1)
        from tbl_goods
        where del_flag = 0 and product_id = #{spuId}
    </select>

    <update id="updateWithoutNull" parameterType="GoodsModel">
        update tbl_goods set
        modify_time=now()
        ,name = #{name}
        ,manufacturer = #{manufacturer}
        ,is_inner = #{isInner}
        ,mail_order_code = #{mailOrderCode}
        ,ad_word = #{adWord}
        ,gift_desc = #{giftDesc}
        ,introduction = #{introduction}
        ,service_type = #{serviceType}
        ,recommend_goods1_code = #{recommendGoods1Code}
        ,recommend_goods2_code = #{recommendGoods2Code}
        ,recommend_goods3_code = #{recommendGoods3Code}
        ,limit_count = #{limitCount}
        ,cards = #{cards}
        ,card_level_id = #{cardLevelId}
        ,approve_different = #{approveDifferent}
        <if test="approveStatus !=null">,approve_status = #{approveStatus}</if>
        <if test="modifyOper !=null">,modify_oper = #{modifyOper}</if>
        ,auto_off_shelf_time = #{autoOffShelfTime}
        where code = #{code}
    </update>

    <update id="updateChannelYgByVendorId" parameterType="String">
        UPDATE tbl_goods SET
        channel_mall = '01',
        channel_cc = '01',
        channel_mall_wx = '01',
        channel_credit_wx = '01',
        channel_phone = '01',
        channel_app = '01',
        channel_sms = '01'
        WHERE
        vendor_id = #{vendorId} and del_flag=0
        AND approve_status in (03,04,05,06,72,73,74)
    </update>

    <update id="updateChannelJfByVendorId" parameterType="String">
        UPDATE tbl_goods SET
        channel_points = '01',
        channel_cc = '01',
        channel_phone = '01',
        channel_ivr = '01',
        channel_sms = '01'
        WHERE
        vendor_id = #{vendorId} and del_flag=0
        AND approve_status in (03,04,05,06,72,73,74,75)
    </update>
    
    <!-- 根据类目，商品名称模糊查询商品  add by huangcy-->
    <select id="findGoodsListByGoodsNameLikeForDecoration" parameterType="Map" resultMap="GoodsMap">
        SELECT
        <include refid="columns"/>
        FROM tbl_goods
        WHERE del_flag=0 and (channel_mall='02' or channel_points='02')
        and approve_status in('06','72','73','74')
        <if test="name !=null">and name LIKE concat(concat('%',#{name}),'%')</if>
        <if test="productId !=null">and product_id IN ( #{productId} )</if>
        <if test="ordertypeId !=null">and ordertype_id IN ( #{ordertypeId} )</if>
        <if test="count !=null"><![CDATA[ ORDER BY modify_time DESC limit 0, #{count} ]]></if>
    </select>
</mapper>

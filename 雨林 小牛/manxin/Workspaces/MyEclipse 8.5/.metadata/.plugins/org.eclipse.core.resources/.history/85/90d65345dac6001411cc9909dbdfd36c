<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yulin.orderMapping">
	<!-- 点击下一步 保存订单 -->
	<insert id="insertOrder" parameterType="com.yulin.dangdang.bean.Order">
		insert into d_order values(#{id},#{user_id},#{status},#{order_time},#{order_desc},#{total_price},
		#{receive_name},#{full_address},#{postal_code},#{mobile},#{phone});
		<selectKey></selectKey>
	</insert>
	
	<!-- 取出Order中的id -->
	<select id="findOrderId" parameterType="map" resultMap="Order">
		select id  from d_order;
	</select>
	<resultMap type="com.yulin.dangdang.bean.Order" id="Order">
		<id property="id" column="id"/>
		<association property="user" javaType="com.yulin.dangdang.bean.User">
			<id property="id" column="id"/>
		</association>
	</resultMap>
	
	<!-- 修改Item中的Order_id属性 -->
	<update id="updateItem" parameterType="com.yulin.dangdang.bean.Item" >
		update d_item set order_id = #{order_id} where id = #{id}
	</update>
	
	<!-- 保存Item -->
	<insert id="insertItem" parameterType="com.yulin.dangdang.bean.Item">
		insert into d_item values(#{id},#{order_id},#{product_id},#{product_name},#{dang_price},#{product_num},
		#{amount})
	</insert>
	
	<!-- 地址保存  -->
	<insert id="insertAddress" parameterType="com.yulin.dangdang.bean.Address">
		insert into d_receive_address values(#{id},#{user_id},#{receive_name},#{full_address},#{postal_code},
		#{mobile},#{phone})
	</insert>
	
	
	
	
	
	
	
	
	
	
	
</mapper>
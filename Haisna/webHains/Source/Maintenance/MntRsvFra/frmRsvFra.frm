VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Begin VB.Form frmRsvFra 
   BorderStyle     =   3  'å≈íË¿ﬁ≤±€∏ﬁ
   Caption         =   "ó\ñÒògÉeÅ[ÉuÉãÉÅÉìÉeÉiÉìÉX"
   ClientHeight    =   7620
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   6720
   BeginProperty Font 
      Name            =   "MS UI Gothic"
      Size            =   9
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmRsvFra.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   7620
   ScaleWidth      =   6720
   ShowInTaskbar   =   0   'False
   StartUpPosition =   1  'µ∞≈∞ Ã´∞—ÇÃíÜâõ
   Begin TabDlg.SSTab tabMain 
      Height          =   6975
      Left            =   120
      TabIndex        =   41
      Top             =   120
      Width           =   6495
      _ExtentX        =   11456
      _ExtentY        =   12303
      _Version        =   393216
      Style           =   1
      Tabs            =   2
      TabHeight       =   520
      TabCaption(0)   =   "äÓñ{èÓïÒ"
      TabPicture(0)   =   "frmRsvFra.frx":000C
      Tab(0).ControlEnabled=   -1  'True
      Tab(0).Control(0)=   "Image1(0)"
      Tab(0).Control(0).Enabled=   0   'False
      Tab(0).Control(1)=   "LabelCourseGuide"
      Tab(0).Control(1).Enabled=   0   'False
      Tab(0).Control(2)=   "Frame1"
      Tab(0).Control(2).Enabled=   0   'False
      Tab(0).Control(3)=   "Frame3(0)"
      Tab(0).Control(3).Enabled=   0   'False
      Tab(0).Control(4)=   "Frame3(1)"
      Tab(0).Control(4).Enabled=   0   'False
      Tab(0).ControlCount=   5
      TabCaption(1)   =   "ògä«óùÇ∑ÇÈçÄñ⁄"
      TabPicture(1)   =   "frmRsvFra.frx":0028
      Tab(1).ControlEnabled=   0   'False
      Tab(1).Control(0)=   "fraItemMain"
      Tab(1).ControlCount=   1
      Begin VB.Frame Frame3 
         Caption         =   "ògê›íËéûÇÃÉfÉtÉHÉãÉgêlêî"
         Height          =   2355
         Index           =   1
         Left            =   300
         TabIndex        =   13
         Top             =   4320
         Visible         =   0   'False
         Width           =   6015
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   9
            Left            =   3540
            MaxLength       =   3
            TabIndex        =   33
            Text            =   "Text1"
            Top             =   1800
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   8
            Left            =   3540
            MaxLength       =   3
            TabIndex        =   29
            Text            =   "Text1"
            Top             =   1440
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   7
            Left            =   3540
            MaxLength       =   3
            TabIndex        =   25
            Text            =   "Text1"
            Top             =   1080
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   6
            Left            =   3540
            MaxLength       =   3
            TabIndex        =   21
            Text            =   "Text1"
            Top             =   720
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   5
            Left            =   3540
            MaxLength       =   3
            TabIndex        =   17
            Text            =   "@@@"
            Top             =   360
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   4
            Left            =   1500
            MaxLength       =   3
            TabIndex        =   31
            Text            =   "Text1"
            Top             =   1800
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   3
            Left            =   1500
            MaxLength       =   3
            TabIndex        =   27
            Text            =   "Text1"
            Top             =   1440
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   2
            Left            =   1500
            MaxLength       =   3
            TabIndex        =   23
            Text            =   "Text1"
            Top             =   1080
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   1
            Left            =   1500
            MaxLength       =   3
            TabIndex        =   19
            Text            =   "Text1"
            Top             =   720
            Width           =   555
         End
         Begin VB.TextBox txtDefCnt 
            Height          =   285
            Index           =   0
            Left            =   1500
            MaxLength       =   3
            TabIndex        =   15
            Text            =   "@@@"
            Top             =   360
            Width           =   555
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   9
            Left            =   2340
            TabIndex        =   32
            Top             =   1860
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   8
            Left            =   2340
            TabIndex        =   28
            Top             =   1500
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   7
            Left            =   2340
            TabIndex        =   24
            Top             =   1140
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   6
            Left            =   2340
            TabIndex        =   20
            Top             =   780
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   5
            Left            =   2340
            TabIndex        =   16
            Top             =   420
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   4
            Left            =   300
            TabIndex        =   30
            Top             =   1860
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   3
            Left            =   300
            TabIndex        =   26
            Top             =   1500
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   2
            Left            =   300
            TabIndex        =   22
            Top             =   1140
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   1
            Left            =   300
            TabIndex        =   18
            Top             =   780
            Width           =   1395
         End
         Begin VB.Label lblDefCnt 
            Caption         =   "éûä‘ë—ògÇP(&1):"
            Height          =   195
            Index           =   0
            Left            =   300
            TabIndex        =   14
            Top             =   420
            Width           =   1395
         End
      End
      Begin VB.Frame Frame3 
         Caption         =   "ògêlêîÇÃÉIÅ[ÉoÅ[ìoò^"
         Height          =   1095
         Index           =   0
         Left            =   300
         TabIndex        =   10
         Top             =   3120
         Visible         =   0   'False
         Width           =   6015
         Begin VB.OptionButton optOverRsv 
            Caption         =   "ògêlêîÇâzÇ¶ÇΩó\ñÒÇãñÇ∑(&T)"
            Height          =   255
            Index           =   1
            Left            =   300
            TabIndex        =   12
            Top             =   660
            Width           =   4095
         End
         Begin VB.OptionButton optOverRsv 
            Caption         =   "ògêlêîÇâzÇ¶ÇΩó\ñÒÇÕãñÇ≥Ç»Ç¢(&F)"
            Height          =   255
            Index           =   0
            Left            =   300
            TabIndex        =   11
            Top             =   360
            Value           =   -1  'True
            Width           =   4095
         End
      End
      Begin VB.Frame fraItemMain 
         Caption         =   "åüç∏çÄñ⁄(&I)"
         Height          =   4395
         Left            =   -74820
         TabIndex        =   34
         Top             =   480
         Width           =   6075
         Begin VB.CommandButton cmdDeleteItem 
            Caption         =   "çÌèú(&R)"
            Height          =   315
            Left            =   4620
            TabIndex        =   37
            Top             =   3900
            Width           =   1275
         End
         Begin VB.CommandButton cmdAddItem 
            Caption         =   "í«â¡(&A)..."
            Height          =   315
            Left            =   3240
            TabIndex        =   36
            Top             =   3900
            Width           =   1275
         End
         Begin MSComctlLib.ListView lsvItem 
            Height          =   3480
            Left            =   180
            TabIndex        =   35
            Top             =   300
            Width           =   5715
            _ExtentX        =   10081
            _ExtentY        =   6138
            LabelEdit       =   1
            MultiSelect     =   -1  'True
            LabelWrap       =   -1  'True
            HideSelection   =   0   'False
            FullRowSelect   =   -1  'True
            _Version        =   393217
            ForeColor       =   -2147483640
            BackColor       =   -2147483643
            BorderStyle     =   1
            Appearance      =   1
            NumItems        =   0
         End
      End
      Begin VB.Frame Frame1 
         Caption         =   "äÓñ{èÓïÒ(&B)"
         Height          =   1935
         Left            =   300
         TabIndex        =   0
         Top             =   1080
         Width           =   6015
         Begin VB.CheckBox chkIncOpenGrp 
            Caption         =   "ÉIÅ[ÉvÉìògó\ñÒåQë∂ç›éûÇÕåüçıÇ…ä‹ÇﬂÇÈ(&E)"
            Height          =   180
            Left            =   1680
            TabIndex        =   9
            Top             =   1500
            Width           =   3495
         End
         Begin VB.OptionButton optFraType 
            Caption         =   "åüç∏çÄñ⁄ó\ñÒòg(&R)"
            Height          =   255
            Index           =   1
            Left            =   3420
            TabIndex        =   7
            Top             =   1080
            Value           =   -1  'True
            Visible         =   0   'False
            Width           =   2055
         End
         Begin VB.OptionButton optFraType 
            Caption         =   "ÉRÅ[ÉXó\ñÒòg(&R)"
            Height          =   255
            Index           =   0
            Left            =   1680
            TabIndex        =   6
            Top             =   1080
            Width           =   1575
         End
         Begin VB.TextBox txtRsvFraName 
            Height          =   318
            IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
            Left            =   1680
            MaxLength       =   10
            TabIndex        =   4
            Text            =   "ãπïîÉåÉìÉgÉQÉì"
            Top             =   660
            Width           =   2055
         End
         Begin VB.TextBox txtRsvFraCd 
            Height          =   315
            IMEMode         =   3  'µÃå≈íË
            Left            =   1680
            MaxLength       =   3
            TabIndex        =   2
            Text            =   "@@@"
            Top             =   300
            Width           =   495
         End
         Begin VB.Label Label8 
            Caption         =   "ÉIÅ[ÉvÉìòg(&O):"
            Height          =   195
            Index           =   1
            Left            =   240
            TabIndex        =   8
            Top             =   1500
            Width           =   1395
         End
         Begin VB.Label Label2 
            Caption         =   "ó\ñÒògñº(&N):"
            Height          =   195
            Left            =   240
            TabIndex        =   3
            Top             =   720
            Width           =   1095
         End
         Begin VB.Label Label1 
            Caption         =   "ó\ñÒògÉRÅ[Éh(&C):"
            Height          =   195
            Index           =   2
            Left            =   240
            TabIndex        =   1
            Top             =   360
            Width           =   1275
         End
         Begin VB.Label Label8 
            Caption         =   "ó\ñÒògÇÃéÌóﬁ(&K):"
            Height          =   195
            Index           =   0
            Left            =   240
            TabIndex        =   5
            Top             =   1125
            Width           =   1395
         End
      End
      Begin VB.Label LabelCourseGuide 
         Caption         =   "ó\ñÒì‡óeÇÃéÌóﬁÇ…ÇÊÇ¡Çƒêlêîêßå¿Ç∑ÇÈì‡óeÇê›íËÇµÇ‹Ç∑ÅB"
         Height          =   255
         Left            =   960
         TabIndex        =   42
         Top             =   600
         Width           =   5055
      End
      Begin VB.Image Image1 
         Height          =   480
         Index           =   0
         Left            =   300
         Picture         =   "frmRsvFra.frx":0044
         Top             =   480
         Width           =   480
      End
   End
   Begin VB.CommandButton cmdCancel 
      Cancel          =   -1  'True
      Caption         =   "ÉLÉÉÉìÉZÉã"
      Height          =   315
      Left            =   3960
      TabIndex        =   39
      Top             =   7200
      Width           =   1275
   End
   Begin VB.CommandButton cmdOk 
      Caption         =   "OK"
      Default         =   -1  'True
      Height          =   315
      Left            =   2580
      TabIndex        =   38
      Top             =   7200
      Width           =   1275
   End
   Begin VB.CommandButton cmdApply 
      Caption         =   "ìKóp(A)"
      Height          =   315
      Left            =   5340
      TabIndex        =   40
      Top             =   7200
      Width           =   1275
   End
End
Attribute VB_Name = "frmRsvFra"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'----------------------------
'èCê≥óöó
'----------------------------
'ä«óùî‘çÜÅFSL-SN-Y0101-612
'èCê≥ì˙Å@ÅF2013.2.25
'íSìñé“  ÅFT.Takagi@RD
'èCê≥ì‡óeÅFÉIÅ[ÉvÉìògó\ñÒåQÇí«â¡

Option Explicit

'ÉvÉçÉpÉeÉBópóÃàÊ
Private mstrRsvFraCd    As String   'ó\ñÒògÉRÅ[Éh
Private mintFraType     As Integer  'ògä«óùÉ^ÉCÉv
Private mblnUpdated     As Boolean  'TRUE:çXêVÇ†ÇËÅAFALSE:çXêVÇ»Çµ
Private mblnShowOnly    As Boolean  'TRUE:ÉfÅ[É^ÇÃçXêVÇÇµÇ»Ç¢ÅiéQè∆ÇÃÇ›Åj
Private mblnInitialize  As Boolean  'TRUE:ê≥èÌÇ…èâä˙âªÅAFALSE:èâä˙âªé∏îs

'ÉÇÉWÉÖÅ[Éãå≈óLóÃàÊóÃàÊ
Private mcolGotFocusCollection  As Collection   'GotFocuséûÇÃï∂éöëIëópÉRÉåÉNÉVÉáÉì

Private mstrClassCd()   As String   'åüç∏ï™óﬁÉRÅ[ÉhÅiîzóÒÇÕÅAÉRÉìÉ{É{ÉbÉNÉXÇ∆ëŒâûÅj

Const mstrListViewKey   As String = "K"

Friend Property Get Initialize() As Variant

    Initialize = mblnInitialize

End Property

Friend Property Get Updated() As Variant

    Updated = mblnUpdated

End Property


' @(e)
'
' ã@î\Å@Å@ : ÅuçÄñ⁄í«â¡ÅvClick
'
' ã@î\ê‡ñæ : á@ÉRÅ[ÉXÇÃèÍçáÅ`ä«óùÇ∑ÇÈÉRÅ[ÉXÇí«â¡Ç∑ÇÈ
' Å@Å@Å@Å@ : áAåüç∏çÄñ⁄ÇÃèÍçáÅ`ä«óùÇ∑ÇÈçÄñ⁄Çí«â¡Ç∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Sub cmdAddItem_Click()
    
    Dim objItemGuide    As mntItemGuide.ItemGuide   'çÄñ⁄ÉKÉCÉhï\é¶óp
    Dim objItem         As ListItem                 'ÉäÉXÉgÉAÉCÉeÉÄÉIÉuÉWÉFÉNÉg
    
    Dim i               As Long     'ÉCÉìÉfÉbÉNÉX
    Dim strKey          As String   'èdï°É`ÉFÉbÉNópÇÃÉLÅ[
    Dim strItemString   As String
    Dim strItemKey      As String   'ÉäÉXÉgÉrÉÖÅ[ópÉAÉCÉeÉÄÉLÅ[
    Dim strItemCdString As String   'ï\é¶ópÉLÅ[ï“èWóÃàÊ
    
    Dim lngItemCount    As Long     'ëIëçÄñ⁄êî
    Dim vntItemCd       As Variant  'ëIëÇ≥ÇÍÇΩçÄñ⁄ÉRÅ[Éh
    Dim vntItemName     As Variant  'ëIëÇ≥ÇÍÇΩçÄñ⁄ñº
    
    If mintFraType = 0 Then
        
        'ògä«óùÉ^ÉCÉvÇ™ÉRÅ[ÉXÇ»ÇÁÅAÉäÉXÉgÉrÉÖÅ[è„ÇÃä«óùÅAîÒä«óùÇïœçXÇ∑ÇÈ
        Call ChangeItemMode(True)
    
    Else
        'ògä«óùÉ^ÉCÉvÇ™åüç∏çÄñ⁄Ç»ÇÁÅAÉKÉCÉhÇï\é¶Ç∑ÇÈ
        
        'ÉIÉuÉWÉFÉNÉgÇÃÉCÉìÉXÉ^ÉìÉXçÏê¨
        Set objItemGuide = New mntItemGuide.ItemGuide
        
        With objItemGuide
            .Mode = MODE_REQUEST
            .Group = GROUP_OFF
            .Item = ITEM_SHOW
            .Question = QUESTION_SHOW
        
            'åüç∏çÄñ⁄ÉKÉCÉhÇäJÇ≠
            .Show vbModal
            
            'ñﬂÇËílÇ∆ÇµÇƒÇÃÉvÉçÉpÉeÉBéÊìæ
            lngItemCount = .ItemCount
            vntItemCd = .ItemCd
            vntItemName = .ItemName
        
        End With
    
        Screen.MousePointer = vbHourglass
        Me.Refresh
            
        'ëIëåèêîÇ™0åèà»è„Ç»ÇÁ
        If lngItemCount > 0 Then
        
            'ÉäÉXÉgÇÃï“èW
            For i = 0 To lngItemCount - 1
                
                'àÀóäçÄñ⁄ÇÃèÍçá
                strItemCdString = vntItemCd(i)
                strItemKey = mstrListViewKey & strItemCdString
                
                'ÉäÉXÉgè„Ç…ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉNÇ∑ÇÈ
                If CheckExistsItemCd(lsvItem, strItemKey) = False Then
                
                    'Ç»ÇØÇÍÇŒí«â¡Ç∑ÇÈ
                    Set objItem = lsvItem.ListItems.Add(, strItemKey, strItemCdString)
                    objItem.SubItems(1) = vntItemName(i)
                
                End If
            Next i
        
        End If
    
        Set objItemGuide = Nothing
    
    End If
    Screen.MousePointer = vbDefault

End Sub

' @(e)
'
' ã@î\Å@Å@ : ÅuìKópÅvÉNÉäÉbÉN
'
' à¯êîÅ@Å@ : Ç»Çµ
'
' ã@î\ê‡ñæ : ì¸óÕì‡óeÇìKópÇ∑ÇÈÅBâÊñ ÇÕï¬Ç∂Ç»Ç¢
'
' îıçlÅ@Å@ :
'
Private Sub cmdApply_Click()
    
    'ÉfÅ[É^ìKópèàóùÇçsÇ§
    Call ApplyData

End Sub


Private Sub cmdCancel_Click()

    Unload Me
    
End Sub

' @(e)
'
' ã@î\Å@Å@ : ÉtÉHÅ[ÉÄÉRÉìÉgÉçÅ[ÉãÇÃèâä˙âª
'
' ã@î\ê‡ñæ : ÉRÉìÉgÉçÅ[ÉãÇèâä˙èÛë‘Ç…ïœçXÇ∑ÇÈÅB
'
' îıçlÅ@Å@ :
'
Private Sub InitializeForm()

    Dim Ctrl        As Object
    Dim i           As Integer
    Dim objHeader   As ColumnHeaders        'ÉJÉâÉÄÉwÉbÉ_ÉIÉuÉWÉFÉNÉg
    
        
'ÅöÇ»ÇÒÇ≈ÅIîzóÒÇ™Ç†ÇÈÉeÉLÉXÉgÉ{ÉbÉNÉXÇ≈ëŒâûÇ≈Ç´Ç»Ç¢ÅI
'    Call InitFormControls(Me, mcolGotFocusCollection)      'égópÉRÉìÉgÉçÅ[Éãèâä˙âª
        
    ''äeÉRÉìÉgÉçÅ[ÉãÇÃê›íËílÇÉNÉäÉAÇ∑ÇÈ
    For Each Ctrl In Me
        
        '''ÉeÉLÉXÉgÉ{ÉbÉNÉX
        If TypeOf Ctrl Is TextBox Then
            Ctrl.Text = Empty
            Ctrl.ToolTipText = Empty
            Ctrl.BackColor = vbWindowBackground
        
        End If
    
    Next Ctrl
    
    'ì«Ç›çûÇ›ì‡óeÇÃï“èW
    For i = 0 To 9
        lblDefCnt(i).Visible = False
        txtDefCnt(i).Visible = False
    Next i
    
    tabMain.Tab = 0
    optFraType(0).Value = True
    
End Sub

' @(e)
'
' ã@î\Å@Å@ : äÓñ{ó\ñÒògèÓïÒâÊñ ï\é¶
'
' ñﬂÇËílÅ@ : TRUE:ê≥èÌèIóπÅAFALSE:àŸèÌèIóπ
'
' ã@î\ê‡ñæ : ó\ñÒògÇÃäÓñ{èÓïÒÇâÊñ Ç…ï\é¶Ç∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function EditTimeFra() As Boolean

    Dim objCommon           As Object     'ó\ñÒògèÓïÒÉAÉNÉZÉXóp
    
    Dim vntArrTimeFra       As Variant
    Dim vntArrTimeFraName   As Variant

    Dim lngRet          As Long
    Dim i               As Integer
    
    EditTimeFra = False
    
    On Error GoTo ErrorHandle
    
    'ÉIÉuÉWÉFÉNÉgÇÃÉCÉìÉXÉ^ÉìÉXçÏê¨
    Set objCommon = CreateObject("HainsCommon.Common")
    
    Do
        
        'éûä‘ògèÓïÒì«Ç›çûÇ›
        lngRet = objCommon.SelectTimeFraList(vntArrTimeFra, vntArrTimeFraName)

        'ì«Ç›çûÇ›ì‡óeÇÃï“èW
        For i = 0 To lngRet - 1
            lblDefCnt(i).Caption = CStr(vntArrTimeFraName(i))
            lblDefCnt(i).Visible = True
            txtDefCnt(i).Visible = True
        Next i
        
        Exit Do
    Loop
    
    'ñﬂÇËílÇÃê›íË
    EditTimeFra = True
    
    Exit Function

ErrorHandle:

    EditTimeFra = False
    MsgBox Err.Description, vbCritical
    
End Function


' @(e)
'
' ã@î\Å@Å@ : äÓñ{ó\ñÒògèÓïÒâÊñ ï\é¶
'
' ñﬂÇËílÅ@ : TRUE:ê≥èÌèIóπÅAFALSE:àŸèÌèIóπ
'
' ã@î\ê‡ñæ : ó\ñÒògÇÃäÓñ{èÓïÒÇâÊñ Ç…ï\é¶Ç∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function EditRsvFra_p() As Boolean

    Dim objRsvFra       As Object     'ó\ñÒògèÓïÒÉAÉNÉZÉXóp
    
    Dim vntRsvFraName   As Variant
    Dim vntOverRsv      As Variant
    Dim vntFraType      As Variant
    Dim vntDefCnt(9)    As Variant
'#### 2013.2.25 SL-SN-Y0101-612 ADD START ####
    Dim vntIncOpenGrp   As Variant  'ÉIÅ[ÉvÉìògó\ñÒåQåüçı
'#### 2013.2.25 SL-SN-Y0101-612 ADD END   ####

    Dim Ret             As Boolean              'ñﬂÇËíl
    Dim i               As Integer
    
    EditRsvFra_p = False
    
    On Error GoTo ErrorHandle
    
    'ÉIÉuÉWÉFÉNÉgÇÃÉCÉìÉXÉ^ÉìÉXçÏê¨
    Set objRsvFra = CreateObject("HainsSchedule.Schedule")
    
    Do
        'åüçıèåèÇ™éwíËÇ≥ÇÍÇƒÇ¢Ç»Ç¢èÍçáÇÕâΩÇ‡ÇµÇ»Ç¢
        If mstrRsvFraCd = "" Then
            Ret = True
            Exit Do
        End If
        
        'ÉRÅ[ÉXÉeÅ[ÉuÉãÉåÉRÅ[Éhì«Ç›çûÇ›
'#### 2013.2.25 SL-SN-Y0101-612 UPD START ####
'        If objRsvFra.SelectRsvFra(mstrRsvFraCd, _
'                                  vntRsvFraName, _
'                                  vntOverRsv, _
'                                  vntFraType, _
'                                  vntDefCnt(0), _
'                                  vntDefCnt(1), _
'                                  vntDefCnt(2), _
'                                  vntDefCnt(3), _
'                                  vntDefCnt(4), _
'                                  vntDefCnt(5), _
'                                  vntDefCnt(6), _
'                                  vntDefCnt(7), _
'                                  vntDefCnt(8), _
'                                  vntDefCnt(9)) = False Then
        If objRsvFra.SelectRsvFra(mstrRsvFraCd, _
                                  vntRsvFraName, _
                                  vntOverRsv, _
                                  vntFraType, _
                                  vntDefCnt(0), _
                                  vntDefCnt(1), _
                                  vntDefCnt(2), _
                                  vntDefCnt(3), _
                                  vntDefCnt(4), _
                                  vntDefCnt(5), _
                                  vntDefCnt(6), _
                                  vntDefCnt(7), _
                                  vntDefCnt(8), _
                                  vntDefCnt(9), _
                                  vntIncOpenGrp) = False Then
'#### 2013.2.25 SL-SN-Y0101-612 UPD END   ####
            MsgBox "èåèÇñûÇΩÇ∑ÉåÉRÅ[ÉhÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", vbCritical, App.Title
            Exit Do
        End If

        'ì«Ç›çûÇ›ì‡óeÇÃï“èWÅiÉRÅ[ÉXäÓñ{èÓïÒÅj
        txtRsvFraCd.Text = mstrRsvFraCd
        txtRsvFraName.Text = vntRsvFraName
        mintFraType = CInt(vntFraType)
        optFraType(CInt(vntFraType)).Value = True
        optOverRsv(CInt(vntOverRsv)).Value = True
    
        For i = 0 To 9
            txtDefCnt(i).Text = CStr(vntDefCnt(i))
        Next i
        
'#### 2013.2.25 SL-SN-Y0101-612 ADD START ####
        chkIncOpenGrp.Value = IIf(vntIncOpenGrp > 0, vbChecked, vbUnchecked)
'#### 2013.2.25 SL-SN-Y0101-612 ADD END   ####
        
        Ret = True
        Exit Do
    Loop
    
    'ñﬂÇËílÇÃê›íË
    EditRsvFra_p = Ret
    
    Exit Function

ErrorHandle:

    EditRsvFra_p = False
    MsgBox Err.Description, vbCritical
    
End Function

' @(e)
'
' ã@î\Å@Å@ : ó\ñÒògä«óùçÄñ⁄ï\é¶
'
' ã@î\ê‡ñæ : åªç›ê›íËÇ≥ÇÍÇƒÇ¢ÇÈó\ñÒògì‡ä«óùçÄñ⁄ÅiÉRÅ[ÉXoråüç∏çÄñ⁄ÅjÇï\é¶Ç∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function EditRsvFraItem() As Boolean
    
On Error GoTo ErrorHandle

    Dim objRsvFra       As Object               'ó\ñÒògÉAÉNÉZÉXóp
    Dim objHeader       As ColumnHeaders        'ÉJÉâÉÄÉwÉbÉ_ÉIÉuÉWÉFÉNÉg
    Dim objItem         As ListItem             'ÉäÉXÉgÉAÉCÉeÉÄÉIÉuÉWÉFÉNÉg

    Dim vntClassName    As Variant              'åüç∏ï™óﬁñºèÃ
    Dim vntItemCode     As Variant              'ÉRÅ[Éh
    Dim vntItemName     As Variant              'ñºèÃ
    Dim vntCsCd         As Variant              'ÉRÅ[ÉXÉRÅ[Éh
    Dim lngCount        As Long                 'ÉåÉRÅ[Éhêî
    Dim strItemKey      As String               'ÉäÉXÉgÉrÉÖÅ[ópÉAÉCÉeÉÄÉLÅ[
    Dim strItemCodeString As String             'ï\é¶ópÉLÅ[ï“èWóÃàÊ
    
    Dim i               As Long                 'ÉCÉìÉfÉbÉNÉX

    EditRsvFraItem = False

    'ÉäÉXÉgÉAÉCÉeÉÄÉNÉäÉA
    lsvItem.ListItems.Clear
    lsvItem.View = lvwList
    
    'ÉIÉuÉWÉFÉNÉgÇÃÉCÉìÉXÉ^ÉìÉXçÏê¨
    Set objRsvFra = CreateObject("HainsSchedule.Schedule")
    
    lngCount = objRsvFra.SelectRsvFraItemList(mstrRsvFraCd, _
                                              mintFraType, _
                                              vntItemCode, _
                                              vntItemName, _
                                              vntCsCd)

    'ÉwÉbÉ_ÇÃï“èW
    Set objHeader = lsvItem.ColumnHeaders
    With objHeader
        .Clear
        .Add , , "ÉRÅ[Éh", 1000, lvwColumnLeft
        If mintFraType = 0 Then
            .Add , , "ÉRÅ[ÉXñºèÃ", 2000, lvwColumnLeft
            .Add , , "ä«óùëŒè€", 2000, lvwColumnLeft
        Else
            .Add , , "åüç∏çÄñ⁄ñºèÃ", 2000, lvwColumnLeft
        End If
    End With
        
    lsvItem.View = lvwReport
    
    'ÉäÉXÉgÇÃï“èW
    For i = 0 To lngCount - 1
        Set objItem = lsvItem.ListItems.Add(, mstrListViewKey & vntItemCode(i), vntItemCode(i))
        objItem.SubItems(1) = vntItemName(i)
        If (mintFraType = 0) And (vntCsCd(i) <> "") Then
            objItem.SubItems(2) = "ògä«óùëŒè€"
        End If
    Next i
    
    'çÄñ⁄Ç™ÇPçsà»è„ë∂ç›ÇµÇΩèÍçáÅAñ≥èåèÇ…êÊì™Ç™ëIëÇ≥ÇÍÇÈÇΩÇﬂâèúÇ∑ÇÈÅB
    If lsvItem.ListItems.Count > 0 Then
        lsvItem.ListItems(1).Selected = False
    End If
    
    'ògä«óùÉ^ÉCÉvÇ…ÇÊÇ¡ÇƒÉ{É^ÉìñºèÃÇïœçX
    If mintFraType = 0 Then
        fraItemMain.Caption = "ä«óùÇ∑ÇÈÉRÅ[ÉX"
        cmdAddItem.Caption = "ä«óùÇ∑ÇÈ(&A)"
        cmdDeleteItem.Caption = "ä«óùÇµÇ»Ç¢(&R)"
    Else
        fraItemMain.Caption = "ä«óùÇ∑ÇÈåüç∏çÄñ⁄"
        cmdAddItem.Caption = "í«â¡(&A)..."
        cmdDeleteItem.Caption = "çÌèú(&R)"
    End If
    
    EditRsvFraItem = True
    
    Exit Function
    
ErrorHandle:

    MsgBox Err.Description, vbCritical

End Function

' @(e)
'
' ã@î\Å@Å@ : ÅuçÄñ⁄çÌèúÅvClick
'
' ã@î\ê‡ñæ : ëIëÇ≥ÇÍÇΩçÄñ⁄ÇÉäÉXÉgÇ©ÇÁçÌèúÇ∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Sub cmdDeleteItem_Click()

    Dim i As Integer
    
    If mintFraType = 0 Then
        
        'ògä«óùÉ^ÉCÉvÇ™ÉRÅ[ÉXÇ»ÇÁÅAÉäÉXÉgÉrÉÖÅ[è„ÇÃä«óùÅAîÒä«óùÇïœçXÇ∑ÇÈ
        Call ChangeItemMode(False)
        
    Else
        
        'ògä«óùÉ^ÉCÉvÇ™åüç∏çÄñ⁄Ç»ÇÁÅAÉAÉCÉeÉÄçÌèúÇçsÇ§
        
        'ÉäÉXÉgÉrÉÖÅ[ÇÇ≠ÇÈÇ≠ÇÈâÒÇµÇƒëIëçÄñ⁄îzóÒçÏê¨
        For i = 1 To lsvItem.ListItems.Count
            
            'ÉCÉìÉfÉbÉNÉXÇ™ÉäÉXÉgçÄñ⁄ÇâzÇ¶ÇΩÇÁèIóπ
            If i > lsvItem.ListItems.Count Then Exit For
            
            'ëIëÇ≥ÇÍÇƒÇ¢ÇÈçÄñ⁄Ç»ÇÁçÌèú
            If lsvItem.ListItems(i).Selected = True Then
                lsvItem.ListItems.Remove (lsvItem.ListItems(i).Key)
                'ÉAÉCÉeÉÄêîÇ™ïœÇÌÇÈÇÃÇ≈-1ÇµÇƒçƒåüç∏
                i = i - 1
            End If
        
        Next i

    End If
    
End Sub

' @(e)
'
' ã@î\Å@Å@ : ÅuÇnÇjÅvÉNÉäÉbÉN
'
' à¯êîÅ@Å@ : Ç»Çµ
'
' ã@î\ê‡ñæ : ì¸óÕì‡óeÇìKópÇµÅAâÊñ Çï¬Ç∂ÇÈ
'
' îıçlÅ@Å@ :
'
Private Sub CMDok_Click()
    
    'ÉfÅ[É^ìKópèàóùÇçsÇ§ÅiÉGÉâÅ[éûÇÕâÊñ Çï¬Ç∂Ç»Ç¢Åj
    If ApplyData() = False Then
        Exit Sub
    End If

    'âÊñ Çï¬Ç∂ÇÈ
    Unload Me
    
End Sub


' @(e)
'
' ã@î\Å@Å@ : ÉfÅ[É^ÇÃï€ë∂
'
' ñﬂÇËílÅ@ : TRUE:ê≥èÌèIóπÅAFALSE:àŸèÌèIóπ
'
' ã@î\ê‡ñæ : ïœçXÇ≥ÇÍÇΩÉfÅ[É^ÇÉeÅ[ÉuÉãÇ…ï€ë∂Ç∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function ApplyData() As Boolean

    ApplyData = False
    
    'èàóùíÜÇÃèÍçáÇÕâΩÇ‡ÇµÇ»Ç¢
    If Screen.MousePointer = vbHourglass Then Exit Function
    
    'èàóùíÜÇÃï\é¶
    Screen.MousePointer = vbHourglass
    
    Do
        'ì¸óÕÉ`ÉFÉbÉN
        If CheckValue() = False Then Exit Do
        
        'ó\ñÒògÉeÅ[ÉuÉãÇÃìoò^
        If RegistRsvFra() = False Then Exit Do
        
        'çXêVçœÇ›Ç…Ç∑ÇÈ
        mblnUpdated = True
        
        ApplyData = True
        Exit Do
    Loop
    
    'èàóùíÜÇÃâèú
    Screen.MousePointer = vbDefault
    

End Function


' @(e)
'
' ã@î\Å@Å@ : ìoò^ÉfÅ[É^ÇÃÉ`ÉFÉbÉN
'
' ñﬂÇËílÅ@ : TRUE:ê≥èÌèIóπÅAFALSE:àŸèÌèIóπ
'
' ã@î\ê‡ñæ : ì¸óÕì‡óeÇÃë√ìñê´ÇÉ`ÉFÉbÉNÇ∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function CheckValue() As Boolean

    Dim Ret             As Boolean  'ä÷êîñﬂÇËíl
    Dim i               As Integer
    
    'èâä˙èàóù
    Ret = False
    
    Do
        
        If Trim(txtRsvFraCd.Text) = "" Then
            MsgBox "ó\ñÒògÉRÅ[ÉhÇ™ì¸óÕÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", vbExclamation, App.Title
            txtRsvFraCd.SetFocus
            Exit Do
        End If

        If Trim(txtRsvFraName.Text) = "" Then
            MsgBox "ó\ñÒògñºÇ™ì¸óÕÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", vbExclamation, App.Title
            txtRsvFraName.SetFocus
            Exit Do
        End If

        For i = 0 To 9
            
            'ÉfÉtÉHÉãÉgílÇ™ãÛîíÇ»ÇÁÇOÉZÉbÉg
            If Trim(txtDefCnt(i).Text) = "" Then
                txtDefCnt(i).Text = 0
            End If
            
            'êîílÉ`ÉFÉbÉN
            If IsNumeric(txtDefCnt(i).Text) = False Then
                MsgBox "ÉfÉtÉHÉãÉgêlêîÇ…ÇÕêîílÇÉZÉbÉgÇµÇƒÇ≠ÇæÇ≥Ç¢", vbExclamation, App.Title
                txtDefCnt(i).SetFocus
                Exit Do
            End If
                    
        Next i

        'ä«óùçÄñ⁄êîÇÃÉ`ÉFÉbÉN
        If CheckItemSelect = False Then
            MsgBox "ä«óùÇ∑ÇÈçÄñ⁄Ç™ÇPÇ¬Ç‡ìoò^Ç≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", vbExclamation, App.Title
            tabMain.Tab = 1
            Exit Do
        End If
        
        Ret = True
        Exit Do
    Loop
    
    'ñﬂÇËílÇÃê›íË
    CheckValue = Ret
    
End Function

' @(e)
'
' ã@î\Å@Å@ : ó\ñÒògäÓñ{èÓïÒÇÃï€ë∂
'
' ñﬂÇËílÅ@ : TRUE:ê≥èÌèIóπÅAFALSE:àŸèÌèIóπ
'
' ã@î\ê‡ñæ : ì¸óÕì‡óeÇó\ñÒògÉeÅ[ÉuÉãÇ…ï€ë∂Ç∑ÇÈÅB
'
' îıçlÅ@Å@ :
'
Private Function RegistRsvFra() As Boolean

On Error GoTo ErrorHandle

    Dim objRsvFra       As Object     'ó\ñÒògÉAÉNÉZÉXóp
    Dim lngRet          As Long
    Dim intOverRsv      As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim intItemCount    As Integer
    Dim vntItemCode()   As Variant
    
    RegistRsvFra = False
    intItemCount = 0
    Erase vntItemCode
    j = 0

    'ògêlêîÉIÅ[Éoìoò^ÇÃê›íË
    intOverRsv = 0
    If optOverRsv(1).Value = True Then intOverRsv = 1

    'ÉäÉXÉgÉrÉÖÅ[ÇÇ≠ÇÈÇ≠ÇÈâÒÇµÇƒëIëçÄñ⁄îzóÒçÏê¨
    For i = 1 To lsvItem.ListItems.Count
        
        If mintFraType = 0 Then
            
            'ÉRÅ[ÉXÇÃèÍçáÅAä«óùëŒè€ÇÃÇ‡ÇÃÇÃÇ›ÉZÉbÉg
            If Trim(lsvItem.ListItems(i).SubItems(2)) <> "" Then
                ReDim Preserve vntItemCode(j)
                vntItemCode(j) = lsvItem.ListItems(i).Text
                j = j + 1
                intItemCount = intItemCount + 1
            End If
        
        Else
            'åüç∏çÄñ⁄ÇÃèÍçáÅAÉRÅ[ÉhÇÇªÇÃÇ‹Ç‹ÉZÉbÉg
            ReDim Preserve vntItemCode(j)
            vntItemCode(j) = lsvItem.ListItems(i).Text
            j = j + 1
            intItemCount = intItemCount + 1
        End If
    
    Next i

    'ÉIÉuÉWÉFÉNÉgÇÃÉCÉìÉXÉ^ÉìÉXçÏê¨
    Set objRsvFra = CreateObject("HainsSchedule.Schedule")

    'ó\ñÒògÉeÅ[ÉuÉãÉåÉRÅ[ÉhÇÃìoò^
'#### 2013.2.25 SL-SN-Y0101-612 UPD START ####
'    lngRet = objRsvFra.RegistRsvFra_All(IIf(txtRsvFraCd.Enabled, "INS", "UPD"), _
'                                        Trim(txtRsvFraCd.Text), _
'                                        Trim(txtRsvFraName.Text), _
'                                        intOverRsv, _
'                                        mintFraType, _
'                                        Trim(txtDefCnt(0).Text), _
'                                        Trim(txtDefCnt(1).Text), _
'                                        Trim(txtDefCnt(2).Text), _
'                                        Trim(txtDefCnt(3).Text), _
'                                        Trim(txtDefCnt(4).Text), _
'                                        Trim(txtDefCnt(5).Text), _
'                                        Trim(txtDefCnt(6).Text), _
'                                        Trim(txtDefCnt(7).Text), _
'                                        Trim(txtDefCnt(8).Text), _
'                                        Trim(txtDefCnt(9).Text), _
'                                        intItemCount, _
'                                        vntItemCode)
    lngRet = objRsvFra.RegistRsvFra_All( _
        IIf(txtRsvFraCd.Enabled, "INS", "UPD"), _
        Trim(txtRsvFraCd.Text), _
        Trim(txtRsvFraName.Text), _
        intOverRsv, _
        mintFraType, _
        Trim(txtDefCnt(0).Text), _
        Trim(txtDefCnt(1).Text), _
        Trim(txtDefCnt(2).Text), _
        Trim(txtDefCnt(3).Text), _
        Trim(txtDefCnt(4).Text), _
        Trim(txtDefCnt(5).Text), _
        Trim(txtDefCnt(6).Text), _
        Trim(txtDefCnt(7).Text), _
        Trim(txtDefCnt(8).Text), _
        Trim(txtDefCnt(9).Text), _
        intItemCount, _
        vntItemCode, _
        IIf(chkIncOpenGrp.Value = vbUnchecked, 0, 1) _
    )
'#### 2013.2.25 SL-SN-Y0101-612 UPD END   ####
    
    If lngRet = INSERT_DUPLICATE Then
        MsgBox "ì¸óÕÇ≥ÇÍÇΩäÓèÄílä«óùÉRÅ[ÉhÇÕä˘Ç…ë∂ç›ÇµÇ‹Ç∑ÅB", vbExclamation
        RegistRsvFra = False
        Exit Function
    End If
    
    If lngRet = INSERT_ERROR Then
        MsgBox "ÉeÅ[ÉuÉãçXêVéûÇ…ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB", vbCritical
        RegistRsvFra = False
        Exit Function
    End If
    
    mstrRsvFraCd = Trim(txtRsvFraCd.Text)
    txtRsvFraCd.Enabled = (txtRsvFraCd.Text = "")
    
    RegistRsvFra = True
    
    Exit Function
    
ErrorHandle:

    RegistRsvFra = False
    
    MsgBox Err.Description, vbCritical
    
End Function

' @(e)
'
' ã@î\Å@Å@ : ÅuÉtÉHÅ[ÉÄÅvLoad
'
' ã@î\ê‡ñæ : ÉtÉHÅ[ÉÄÇÃèâä˙ï\é¶ÇçsÇ§
'
' îıçlÅ@Å@ :
'
Private Sub Form_Load()

    Dim Ret As Boolean  'ñﬂÇËíl
    
    'èàóùíÜÇÃï\é¶
    Screen.MousePointer = vbHourglass
    
    'èâä˙èàóù
    Ret = False
    mblnUpdated = False
    
    'âÊñ èâä˙âª
    Call InitializeForm

    Do
        
        'éûä‘ògèÓïÒÇÃï\é¶ï“èW
        If EditTimeFra() = False Then
            Exit Do
        End If
        
        'ó\ñÒògèÓïÒÇÃï\é¶ï“èW
        If EditRsvFra_p() = False Then
            Exit Do
        End If
    
        'ó\ñÒògì‡çÄñ⁄ÇÃï“èW
        If EditRsvFraItem() = False Then
            Exit Do
        End If
        
        'ÉCÉlÅ[ÉuÉãê›íË
        txtRsvFraCd.Enabled = (txtRsvFraCd.Text = "")
'        cboRsvFraDiv.Enabled = txtRsvFraCd.Enabled
        
        Ret = True
        Exit Do
    
    Loop
    
    'éQè∆êÍópÇÃèÍçáÅAìoò^ånÉRÉìÉgÉçÅ[ÉãÇé~ÇﬂÇÈ
    If mblnShowOnly = True Then
        LabelCourseGuide.Caption = txtRsvFraName.Text & "ÇÃÉvÉçÉpÉeÉB"
        
        txtRsvFraCd.Enabled = False
        txtRsvFraName.Enabled = False
        
        cmdOk.Enabled = False
        cmdApply.Enabled = False
        cmdAddItem.Enabled = False
        cmdDeleteItem.Enabled = False
    End If
    
    'ñﬂÇËílÇÃê›íË
    mblnInitialize = Ret
    
    'èàóùíÜÇÃâèú
    Screen.MousePointer = vbDefault
    
End Sub
Friend Property Get RsvFraCd() As Variant

    RsvFraCd = mstrRsvFraCd
    
End Property

Friend Property Let RsvFraCd(ByVal vNewValue As Variant)
    
    mstrRsvFraCd = vNewValue

End Property

Friend Property Let ShowOnly(ByVal vNewValue As Variant)
    
    mblnShowOnly = vNewValue

End Property

' @(e)
'
' ã@î\Å@Å@ : éÛêfçÄñ⁄àÍóóÉJÉâÉÄÉNÉäÉbÉN
'
' ã@î\ê‡ñæ : ÉNÉäÉbÉNÇ≥ÇÍÇΩÉJÉâÉÄçÄñ⁄Ç≈SortÇçsÇ§
'
' îıçlÅ@Å@ :
'
Private Sub lsvItem_ColumnClick(ByVal ColumnHeader As MSComctlLib.ColumnHeader)
    
    'É}ÉEÉXÉ|ÉCÉìÉ^Ç™çªéûåvÇÃÇ∆Ç´ÇÕì¸óÕñ≥éã
    If Screen.MousePointer = vbHourglass Then
        Exit Sub
    End If
    
    'ó\ñÒògãÊï™Ç™åüç∏çÄñ⁄ÇÃèÍçáÅAèàóùÇµÇ»Ç¢Åièáî‘Ç™ÇﬂÇøÇ·Ç≠ÇøÇ·Ç…Ç»ÇÈÇ©ÇÁÅj
    If mintFraType = MODE_ITEM Then Exit Sub
    
    With lsvItem
        .SortKey = ColumnHeader.Index - 1
        .Sorted = True
        .SortOrder = IIf(.SortOrder = lvwAscending, lvwDescending, lvwAscending)
    End With

End Sub

Private Sub lsvItem_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Dim i As Long

    'CTRL+AÇâüâ∫Ç≥ÇÍÇΩèÍçáÅAçÄñ⁄ÇëSÇƒëIëÇ∑ÇÈ
    If (KeyCode = vbKeyA) And (Shift = vbCtrlMask) Then
        For i = 1 To lsvItem.ListItems.Count
            lsvItem.ListItems(i).Selected = True
        Next i
    End If

End Sub

' @(e)
'
' ã@î\Å@Å@ : ògä«óùÉIÉvÉVÉáÉìÉ{É^ÉìÉNÉäÉbÉN
'
' ã@î\ê‡ñæ : ògä«óùèÛë‘Ç™ïœçXÇ≥ÇÍÇΩèÍçáÇÃëŒèàÇçsÇ§
'
' îıçlÅ@Å@ :
'
Private Sub optFraType_Click(Index As Integer)

    Dim strMsg      As String
    Dim intRet      As Integer
    
    'ÉNÉäÉbÉNÇ≥ÇÍÇΩÉ^ÉCÉvÇ™åªç›ÇÃÇ‡ÇÃÇ∆àŸÇ»ÇÈÅAÇ©Ç¬çÄñ⁄Ç™ëIëçœÇ›Ç»ÇÁÉÅÉbÉZÅ[ÉW
    If (mintFraType <> Index) And (CheckItemSelect = True) Then
        strMsg = "åªç›ï\é¶ÇµÇƒÇ¢ÇÈògä«óùÉ^ÉCÉvÇ∆àŸÇ»ÇÈÇ‡ÇÃÇ™ëIëÇ≥ÇÍÇ‹ÇµÇΩÅB" & vbLf & _
                 "åªç›ëIëÇ≥ÇÍÇƒÇ¢ÇÈçÄñ⁄ÇÕëSÇƒÉNÉäÉAÇ≥ÇÍÇ‹Ç∑ÅB" & vbLf & _
                 "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH"
        intRet = MsgBox(strMsg, vbYesNo + vbDefaultButton2 + vbExclamation)
        If intRet = vbNo Then Exit Sub
    End If

    'åªç›ÇÃògä«óùÉ^ÉCÉvÇïœçX
    mintFraType = Index
    
    'ó\ñÒògì‡çÄñ⁄ÇÃï“èW
    If EditRsvFraItem() = False Then
        Exit Sub
    End If

End Sub

' @(e)
'
' ã@î\Å@Å@ : ÉRÅ[ÉXä«óùèÛë‘ÇÃïœçX
'
' à¯êîÅ@ Å@: TRUE:ä«óùÇ∑ÇÈÅAFALSE:ä«óùÇ©ÇÁÇÕÇ∏Ç∑
'
' ã@î\ê‡ñæ : ó\ñÒògì‡ÉRÅ[ÉXçÄñ⁄ÇÃä«óùèÛë‘ÇïœçXÇ∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Sub ChangeItemMode(blnMode As Boolean)

    Dim i As Integer
    
    'ÉäÉXÉgÉrÉÖÅ[ÇÇ≠ÇÈÇ≠ÇÈâÒÇµÇƒëIëçÄñ⁄îzóÒçÏê¨
    For i = 1 To lsvItem.ListItems.Count
        
        'ÉCÉìÉfÉbÉNÉXÇ™ÉäÉXÉgçÄñ⁄ÇâzÇ¶ÇΩÇÁèIóπ
        If i > lsvItem.ListItems.Count Then Exit For
        
        'ëIëÇ≥ÇÍÇƒÇ¢ÇÈçÄñ⁄Ç»ÇÁèàóù
        If lsvItem.ListItems(i).Selected = True Then
            If blnMode = True Then
                lsvItem.ListItems(i).SubItems(2) = "ògä«óùëŒè€"
            Else
                lsvItem.ListItems(i).SubItems(2) = ""
            End If
        End If
    
    Next i

End Sub

' @(e)
'
' ã@î\Å@Å@ : ä«óùçÄñ⁄óLñ≥É`ÉFÉbÉN
'
' ñﬂÇËílÅ@ : TRUE:Ç†ÇËÅAFALSE:Ç»Çµ
'
' ã@î\ê‡ñæ : ó\ñÒògì‡ÇÃä«óùçÄñ⁄ÇÉÜÅ[ÉUÇ™ìoò^çœÇ›Ç©Ç«Ç§Ç©É`ÉFÉbÉNÇ∑ÇÈ
'
' îıçlÅ@Å@ :
'
Private Function CheckItemSelect() As Boolean

    Dim i As Integer

    CheckItemSelect = False

    If mintFraType = FRA_TYPE_ITEM Then
        
        'åªç›ÇÃÉÇÅ[ÉhÇ™åüç∏çÄñ⁄ògÇ»ÇÁÉäÉXÉgÉrÉÖÅ[ÇÃçÄñ⁄êîÇÉ`ÉFÉbÉN
        If lsvItem.ListItems.Count > 0 Then CheckItemSelect = True
    
    Else
        
        'åªç›ÇÃÉÇÅ[ÉhÇ™ÉRÅ[ÉXògÇÃèÍçáÅAÉäÉXÉgÉrÉÖÅ[ÇÃä«óùèÛë‘ÇÉ`ÉFÉbÉN
    
        'ÉäÉXÉgÉrÉÖÅ[ÇÇ≠ÇÈÇ≠ÇÈâÒÇ∑
        For i = 1 To lsvItem.ListItems.Count
            
            'ÉCÉìÉfÉbÉNÉXÇ™ÉäÉXÉgçÄñ⁄ÇâzÇ¶ÇΩÇÁèIóπ
            If i > lsvItem.ListItems.Count Then Exit For
            
            'ëIëÇ≥ÇÍÇƒÇ¢ÇÈçÄñ⁄Ç»ÇÁèàóù
            If lsvItem.ListItems(i).SubItems(2) <> "" Then
                CheckItemSelect = True
                Exit For
            End If
        Next i
    End If
    
End Function

